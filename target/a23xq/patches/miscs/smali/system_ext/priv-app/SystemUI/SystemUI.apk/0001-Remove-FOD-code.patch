From 7ac3059c9b71c781caea2dade8faa68a1223397e Mon Sep 17 00:00:00 2001
From: BlackMesa123 <giangrecosalvo9@gmail.com>
Date: Fri, 8 Dec 2023 12:52:24 +0100
Subject: [PATCH] Remove FOD code

---
 .../DualDarInnerLockScreenController.smali    |    6 +-
 .../KeyguardArrowViewController.smali         |   87 +-
 .../KeyguardPasswordViewController.smali      |   60 +-
 ...KeyguardSecAbsKeyInputViewController.smali |  274 +--
 .../KeyguardSecPatternViewController.smali    |  280 ++-
 ...rdSecSecurityContainer$ArrowViewMode.smali |  151 +-
 ...ntroller$OnApplyWindowInsetsListener.smali |   58 +-
 ...yguardSecSecurityContainerController.smali |  135 +-
 .../keyguard/KeyguardSecUpdateMonitor.smali   |   18 +-
 ...nitorImpl$$ExternalSyntheticLambda13.smali |   17 +-
 ...nitorImpl$$ExternalSyntheticLambda14.smali |   17 +-
 ...onitorImpl$$ExternalSyntheticLambda7.smali |   61 +-
 .../KeyguardSecUpdateMonitorImpl.smali        | 1643 +++++------------
 .../keyguard/KeyguardTextBuilder.smali        |  108 +-
 .../SecLockIconViewController$3.smali         |    4 +-
 .../com/android/keyguard/SecurityUtils.smali  |   33 +-
 .../android/keyguard/StrongAuthPopup.smali    |  419 ++---
 .../KeyguardBiometricViewController.smali     |  563 +++---
 ...opup$keyguardUpdateMonitorCallback$1.smali |   58 +-
 ...idesOptionalSidefpsControllerFactory.smali |   16 +-
 smali/com/android/systemui/LsRune.smali       |   12 +-
 ...mponent$CentralSurfacesComponentImpl.smali |    4 +-
 .../plugin/PluginFaceWidgetManager.smali      |   19 +-
 .../features/GlobalActionFeatures.smali       |   31 +-
 .../keyguard/KeyguardViewMediator.smali       |    2 +-
 .../keyguard/animator/ActionDownHandler.smali |    4 +-
 .../animator/FullScreenViewController.smali   |  103 +-
 .../animator/KeyguardTouchAnimator$2.smali    |  113 +-
 .../animator/KeyguardTouchAnimator.smali      |   32 +-
 .../KeyguardTouchSecurityInjector.smali       |   81 -
 .../interactor/PrimaryBouncerInteractor.smali |   72 +-
 .../systemui/power/PowerUI$Receiver.smali     |   17 +
 .../power/SecPowerNotificationWarnings.smali  |   42 +-
 .../NotificationPanelViewController.smali     |  182 +-
 ...ificationPanelViewController_Factory.smali |    4 +
 ...Controller$$ExternalSyntheticLambda4.smali |   65 +-
 ...cationController$SecKeyguardCallback.smali |   23 +-
 .../phone/BiometricUnlockController.smali     |  161 +-
 .../phone/CentralSurfacesImpl$21.smali        |   21 +-
 .../statusbar/phone/CentralSurfacesImpl.smali |   17 -
 .../phone/KeyguardSecBottomAreaView.smali     |   60 -
 .../KeyguardSecBottomAreaViewController.smali |   55 +-
 .../SecStatusBarKeyguardViewManager$1.smali   |   44 +-
 .../SecStatusBarKeyguardViewManager.smali     |   63 +-
 ...mponent$CentralSurfacesComponentImpl.smali |    4 +-
 .../android/systemui/util/DeviceState.smali   |  418 +----
 .../android/systemui/util/DeviceType.smali    |    2 +
 47 files changed, 1775 insertions(+), 3884 deletions(-)

diff --git a/smali/com/android/keyguard/DualDarInnerLockScreenController.smali b/smali/com/android/keyguard/DualDarInnerLockScreenController.smali
index 2d50d475..49fb7144 100644
--- a/smali/com/android/keyguard/DualDarInnerLockScreenController.smali
+++ b/smali/com/android/keyguard/DualDarInnerLockScreenController.smali
@@ -314,7 +314,7 @@
 
     if-eqz v1, :cond_6
 
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    const/4 v1, 0x0
 
     invoke-virtual {p1}, Landroid/view/ViewGroup;->getResources()Landroid/content/res/Resources;
 
@@ -403,7 +403,7 @@
 
     if-nez v1, :cond_7
 
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    const/4 v1, 0x0
 
     if-nez v1, :cond_7
 
@@ -424,7 +424,7 @@
     goto :goto_6
 
     :cond_7
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    const/4 v1, 0x0
 
     invoke-interface {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
 
diff --git a/smali/com/android/keyguard/KeyguardArrowViewController.smali b/smali/com/android/keyguard/KeyguardArrowViewController.smali
index dc67d672..eae3e496 100644
--- a/smali/com/android/keyguard/KeyguardArrowViewController.smali
+++ b/smali/com/android/keyguard/KeyguardArrowViewController.smali
@@ -681,7 +681,7 @@
 
     const/4 v6, 0x0
 
-    if-eqz v5, :cond_10
+    if-eqz v5, :cond_f
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
@@ -941,46 +941,15 @@
     :goto_5
     invoke-virtual {v8, v11}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v7
+    move-result v6
 
-    sub-int/2addr v10, v7
+    sub-int/2addr v10, v6
 
     :cond_b
-    iget-object v7, p0, Lcom/android/keyguard/KeyguardArrowViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_c
-
-    invoke-virtual {v8}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
-
-    move-result-object v7
-
-    iget-object v7, v7, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
-
-    invoke-virtual {v7}, Landroid/app/WindowConfiguration;->getRotation()I
-
-    move-result v7
-
-    if-nez v7, :cond_c
-
-    sget v7, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    const v9, 0x7f07049e
-
-    invoke-virtual {v8, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v8
-
-    add-int/2addr v8, v7
-
-    sub-int/2addr v8, v6
+    iget-object v6, p0, Lcom/android/keyguard/KeyguardArrowViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    add-int/2addr v10, v8
+    invoke-interface {v6}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :cond_c
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
     move-result-object v6
@@ -993,59 +962,55 @@
 
     move-result v8
 
-    if-eqz v8, :cond_e
+    if-eqz v8, :cond_d
 
-    if-eqz v7, :cond_d
+    if-eqz v7, :cond_c
 
-    const v7, 0x7f0704f7
+    const p0, 0x7f0704f7
 
-    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v6
+    move-result p0
 
     goto :goto_6
 
-    :cond_d
+    :cond_c
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v6
+    move-result-object p0
 
-    invoke-static {v6}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
 
-    move-result v6
+    move-result p0
 
     goto :goto_6
 
-    :cond_e
-    if-eqz v7, :cond_f
+    :cond_d
+    if-eqz v7, :cond_e
 
-    const v7, 0x7f0704f6
+    const p0, 0x7f0704f6
 
-    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v6
+    move-result p0
 
     goto :goto_6
 
-    :cond_f
+    :cond_e
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v6
+    move-result-object p0
 
-    invoke-static {v6}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
 
-    move-result v6
+    move-result p0
 
     :goto_6
     invoke-virtual {v0, v12}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    iget p0, p0, Lcom/android/keyguard/KeyguardArrowViewController;->mLastOrientation:I
-
-    const/4 v0, 0x2
+    iput p0, v2, Landroid/widget/FrameLayout$LayoutParams;->height:I
 
-    iput v6, v2, Landroid/widget/FrameLayout$LayoutParams;->height:I
-
-    iput v6, v4, Landroid/widget/FrameLayout$LayoutParams;->height:I
+    iput p0, v4, Landroid/widget/FrameLayout$LayoutParams;->height:I
 
     iput v5, v2, Landroid/widget/FrameLayout$LayoutParams;->leftMargin:I
 
@@ -1057,7 +1022,7 @@
 
     goto :goto_8
 
-    :cond_10
+    :cond_f
     :goto_7
     iput v6, v2, Landroid/widget/FrameLayout$LayoutParams;->leftMargin:I
 
diff --git a/smali/com/android/keyguard/KeyguardPasswordViewController.smali b/smali/com/android/keyguard/KeyguardPasswordViewController.smali
index 05f4de4b..2894fd9f 100644
--- a/smali/com/android/keyguard/KeyguardPasswordViewController.smali
+++ b/smali/com/android/keyguard/KeyguardPasswordViewController.smali
@@ -299,87 +299,53 @@
 .end method
 
 .method public final isHideKeyboardByDefault()Z
-    .locals 5
+    .locals 3
 
     invoke-static {}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getCurrentUser()I
 
     move-result v0
 
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const/4 v2, 0x0
-
-    const/4 v3, 0x1
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz v1, :cond_0
-
-    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    move v1, v3
-
-    goto :goto_0
-
-    :cond_0
-    move v1, v2
-
-    :goto_0
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserUnlockedWithBiometric(I)Z
 
     move-result v0
 
     invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
 
-    move-result v4
-
-    if-eqz v4, :cond_2
-
-    if-eqz v1, :cond_1
+    move-result v1
 
-    if-nez v0, :cond_1
+    const/4 v2, 0x0
 
-    move v2, v3
+    if-eqz v1, :cond_0
 
-    :cond_1
     return v2
 
-    :cond_2
-    if-eqz v1, :cond_3
-
-    invoke-virtual {p0, v3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v1
-
-    if-nez v1, :cond_4
-
-    :cond_3
-    if-nez v0, :cond_4
+    :cond_0
+    if-nez v0, :cond_1
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v0, :cond_5
+    if-eqz v0, :cond_2
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
 
     move-result v0
 
-    if-nez v0, :cond_4
+    if-nez v0, :cond_1
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result p0
 
-    if-eqz p0, :cond_5
+    if-eqz p0, :cond_2
 
-    :cond_4
-    move v2, v3
+    :cond_1
+    const/4 v2, 0x1
 
-    :cond_5
+    :cond_2
     return v2
 .end method
 
diff --git a/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali b/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali
index a46e8974..c56c8631 100644
--- a/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali
+++ b/smali/com/android/keyguard/KeyguardSecAbsKeyInputViewController.smali
@@ -1267,88 +1267,6 @@
     return-void
 .end method
 
-.method public final getInDisplayFpContainerBottomMargin(Z)I
-    .locals 3
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v0
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    if-eqz p1, :cond_0
-
-    const v2, 0x7f0704ec
-
-    goto :goto_0
-
-    :cond_0
-    const v2, 0x7f0704fe
-
-    :goto_0
-    invoke-virtual {v0, v2}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v2
-
-    add-int/2addr v2, v1
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaView:Landroid/view/View;
-
-    if-eqz p0, :cond_1
-
-    const v1, 0x7f0a0398
-
-    invoke-virtual {p0, v1}, Landroid/view/View;->findViewById(I)Landroid/view/View;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/view/View;->getVisibility()I
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const p0, 0x7f070404
-
-    invoke-virtual {v0, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    goto :goto_1
-
-    :cond_1
-    const/4 p0, 0x0
-
-    :goto_1
-    sub-int/2addr v2, p0
-
-    if-eqz p1, :cond_2
-
-    const p0, 0x7f0704ed
-
-    goto :goto_2
-
-    :cond_2
-    const p0, 0x7f070500
-
-    :goto_2
-    invoke-virtual {v0, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    sub-int/2addr v2, p0
-
-    const p0, 0x105024e
-
-    invoke-virtual {v0, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    sub-int/2addr v2, p0
-
-    return v2
-.end method
-
 .method public getSecurityViewId()I
     .locals 0
 
@@ -1717,26 +1635,21 @@
 
     add-int/2addr v2, v0
 
-    const/4 v0, 0x0
-
     if-eqz p0, :cond_1
 
-    sget p0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_1
+    sget-object p0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
 
     :cond_1
-    move p0, v0
+    const/4 p0, 0x0
 
-    :goto_1
     add-int/2addr v2, p0
 
     if-ge v1, v2, :cond_2
 
-    const/4 v0, 0x1
+    const/4 p0, 0x1
 
     :cond_2
-    return v0
+    return p0
 .end method
 
 .method public final isBiometricLockoutLandscape()Z
@@ -2642,45 +2555,18 @@
 
     if-eqz p2, :cond_0
 
-    move p2, v0
-
     goto :goto_0
 
     :cond_0
-    move p2, v1
+    move v0, v1
 
     :goto_0
-    invoke-virtual {p1, v1, v1, p2, v1}, Landroid/widget/LinearLayout;->setPadding(IIII)V
-
-    iget-object p2, p0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getCurrentRotation(Landroid/content/Context;)I
-
-    move-result p0
-
-    const/4 p2, 0x1
-
-    if-ne p0, p2, :cond_1
-
     invoke-virtual {p1, v1, v1, v0, v1}, Landroid/widget/LinearLayout;->setPadding(IIII)V
 
-    goto :goto_1
+    iget-object p0, p0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    :cond_1
-    invoke-virtual {p1, v0, v1, v1, v1}, Landroid/widget/LinearLayout;->setPadding(IIII)V
+    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :cond_2
-    :goto_1
     return-void
 .end method
 
@@ -3435,11 +3321,11 @@
 
     const/4 v10, -0x2
 
-    if-eqz v9, :cond_12
+    if-eqz v9, :cond_10
 
     iget-object v11, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mInputContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v11, :cond_12
+    if-eqz v11, :cond_10
 
     invoke-virtual {v9}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3499,7 +3385,7 @@
 
     iget-object v4, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v4, :cond_11
+    if-eqz v4, :cond_f
 
     invoke-virtual {v4}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3509,7 +3395,7 @@
 
     iget-object v15, v0, Lcom/android/keyguard/KeyguardAbsKeyInputViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz v2, :cond_a
+    if-eqz v2, :cond_9
 
     iput v8, v4, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
@@ -3542,38 +3428,7 @@
 
     iput v3, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
-    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_9
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_9
-
-    iget v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mSecondsRemaining:I
-
-    if-ne v3, v8, :cond_9
-
-    iget-boolean v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mIsImeShown:Z
-
-    if-nez v3, :cond_9
-
-    const/4 v14, 0x1
-
-    invoke-virtual {v0, v14}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->getInDisplayFpContainerBottomMargin(Z)I
-
-    move-result v3
-
-    iput v3, v4, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
-
-    goto/16 :goto_6
-
-    :cond_9
-    const/4 v14, 0x1
+    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
     const v3, 0x7f0704ec
 
@@ -3585,43 +3440,18 @@
 
     goto :goto_6
 
-    :cond_a
-    const/4 v14, 0x1
-
+    :cond_9
     iput v10, v4, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
     iput v10, v4, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
     iput v5, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
-    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v15
-
-    if-eqz v15, :cond_b
-
-    iget v15, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mSecondsRemaining:I
-
-    if-ne v15, v8, :cond_b
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
+    invoke-interface {v15}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    move-result v15
-
-    if-eqz v15, :cond_b
-
-    invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->getInDisplayFpContainerBottomMargin(Z)I
-
-    move-result v3
-
-    iput v3, v4, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
-
-    goto :goto_6
-
-    :cond_b
-    if-eqz v3, :cond_10
+    if-eqz v3, :cond_e
 
-    if-eqz v6, :cond_f
+    if-eqz v6, :cond_d
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isLandscapeDisplay()Z
 
@@ -3629,33 +3459,33 @@
 
     const v6, 0x7f0704ad
 
-    if-eqz v3, :cond_e
+    if-eqz v3, :cond_c
 
     invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v3
 
-    const v15, 0x7f0704ae
+    const v14, 0x7f0704ae
 
-    invoke-virtual {v1, v15}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v1, v14}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v14
+    move-result v15
 
-    if-ne v3, v14, :cond_c
+    if-ne v3, v15, :cond_a
 
     const/4 v3, 0x1
 
     goto :goto_4
 
-    :cond_c
+    :cond_a
     move v3, v5
 
     :goto_4
-    if-nez v3, :cond_d
+    if-nez v3, :cond_b
 
-    move v6, v15
+    move v6, v14
 
-    :cond_d
+    :cond_b
     invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v3
@@ -3664,7 +3494,7 @@
 
     goto :goto_5
 
-    :cond_e
+    :cond_c
     invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v3
@@ -3678,7 +3508,7 @@
 
     goto :goto_6
 
-    :cond_f
+    :cond_d
     const v3, 0x7f0704af
 
     invoke-virtual {v1, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
@@ -3689,7 +3519,7 @@
 
     goto :goto_6
 
-    :cond_10
+    :cond_e
     const v3, 0x7f0704fe
 
     invoke-virtual {v1, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
@@ -3703,23 +3533,23 @@
 
     invoke-virtual {v3, v4}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    :cond_11
+    :cond_f
     invoke-virtual {v9, v12}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     invoke-virtual {v11, v13}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     invoke-virtual {v11, v5}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    :cond_12
+    :cond_10
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mPasswordEntryBoxLayout:Landroid/view/ViewGroup;
 
-    if-eqz v3, :cond_13
+    if-eqz v3, :cond_11
 
     invoke-static/range {p1 .. p1}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isPINSecurityView(I)Z
 
     move-result v4
 
-    if-eqz v4, :cond_13
+    if-eqz v4, :cond_11
 
     invoke-virtual {v3}, Landroid/view/ViewGroup;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3737,10 +3567,10 @@
 
     invoke-virtual {v3, v4}, Landroid/view/ViewGroup;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    :cond_13
+    :cond_11
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaView:Landroid/view/View;
 
-    if-eqz v3, :cond_18
+    if-eqz v3, :cond_16
 
     invoke-virtual {v3}, Landroid/view/View;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
@@ -3752,7 +3582,7 @@
 
     iput v10, v3, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
-    if-eqz v2, :cond_14
+    if-eqz v2, :cond_12
 
     const v4, 0x7f0704ed
 
@@ -3760,28 +3590,28 @@
 
     goto :goto_8
 
-    :cond_14
+    :cond_12
     const v4, 0x7f0a050a
 
     move/from16 v6, p1
 
-    if-ne v6, v4, :cond_15
+    if-ne v6, v4, :cond_13
 
     const/4 v4, 0x1
 
     goto :goto_7
 
-    :cond_15
+    :cond_13
     move v4, v5
 
     :goto_7
-    if-eqz v4, :cond_16
+    if-eqz v4, :cond_14
 
     const v4, 0x7f0704a7
 
     goto :goto_8
 
-    :cond_16
+    :cond_14
     const v4, 0x7f070500
 
     :goto_8
@@ -3799,11 +3629,11 @@
 
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaFlexContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v3, :cond_17
+    if-eqz v3, :cond_15
 
     invoke-virtual {v3, v1}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    :cond_17
+    :cond_15
     iget-object v3, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mEcaView:Landroid/view/View;
 
     invoke-virtual {v3, v5}, Landroid/view/View;->setVisibility(I)V
@@ -3820,34 +3650,34 @@
 
     invoke-virtual {v4, v3}, Lcom/android/keyguard/EmergencyButtonController;->setEmergencyView(Landroid/view/View;)V
 
-    if-eqz v2, :cond_19
+    if-eqz v2, :cond_17
 
     iget-object v2, v0, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->mDummyEcaSpace:Landroid/widget/Space;
 
-    if-eqz v2, :cond_19
+    if-eqz v2, :cond_17
 
     invoke-virtual {v2, v1}, Landroid/widget/Space;->setVisibility(I)V
 
     goto :goto_9
 
-    :cond_18
+    :cond_16
     move/from16 v6, p1
 
-    :cond_19
+    :cond_17
     :goto_9
-    if-eqz v7, :cond_1a
+    if-eqz v7, :cond_18
 
     invoke-static/range {p1 .. p1}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isPINSecurityView(I)Z
 
     move-result v1
 
-    if-eqz v1, :cond_1a
+    if-eqz v1, :cond_18
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecAbsKeyInputViewController;->isAllowedToAdjustSecurityView()Z
 
     move-result v1
 
-    if-eqz v1, :cond_1a
+    if-eqz v1, :cond_18
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
@@ -3867,14 +3697,14 @@
 
     invoke-virtual {v2, v5, v1}, Landroid/widget/TextView;->setTextSize(IF)V
 
-    :cond_1a
+    :cond_18
     iget-object v0, v0, Lcom/android/keyguard/KeyguardInputViewController;->mSubMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
 
-    if-eqz v0, :cond_1b
+    if-eqz v0, :cond_19
 
     invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setVisibility(I)V
 
-    :cond_1b
+    :cond_19
     return-void
 .end method
 
diff --git a/smali/com/android/keyguard/KeyguardSecPatternViewController.smali b/smali/com/android/keyguard/KeyguardSecPatternViewController.smali
index 212fd35e..2ebc92ab 100644
--- a/smali/com/android/keyguard/KeyguardSecPatternViewController.smali
+++ b/smali/com/android/keyguard/KeyguardSecPatternViewController.smali
@@ -2149,7 +2149,7 @@
 .end method
 
 .method public final updatePortraitLayout()V
-    .locals 13
+    .locals 10
 
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
@@ -2178,302 +2178,236 @@
     invoke-virtual {v2, v3}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     :cond_0
-    const v2, 0x7f0a0398
-
-    const v3, 0x7f0704f4
-
-    iget-object v4, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    const/4 v5, 0x1
-
-    iget-object v6, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mLockPatternView:Lcom/android/internal/widget/LockPatternView;
-
-    iget-object v7, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEcaView:Landroid/view/View;
-
-    const/4 v8, 0x0
-
-    if-eqz v6, :cond_3
-
-    iget-object v9, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mSecurityView:Landroid/widget/LinearLayout;
-
-    if-eqz v9, :cond_3
-
-    invoke-virtual {v6}, Lcom/android/internal/widget/LockPatternView;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
-
-    move-result-object v10
-
-    check-cast v10, Landroid/widget/FrameLayout$LayoutParams;
-
-    const/16 v11, 0x51
-
-    invoke-virtual {v9, v11}, Landroid/widget/LinearLayout;->setGravity(I)V
-
-    invoke-virtual {v9, v5}, Landroid/widget/LinearLayout;->setOrientation(I)V
-
-    const v9, 0x7f0704fa
-
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v9
-
-    iput v9, v10, Landroid/widget/FrameLayout$LayoutParams;->width:I
-
-    const v9, 0x7f0704f6
-
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    move-result v9
+    const/4 v3, 0x1
 
-    iput v9, v10, Landroid/widget/FrameLayout$LayoutParams;->height:I
+    iget-object v4, p0, Lcom/android/keyguard/KeyguardPatternViewController;->mLockPatternView:Lcom/android/internal/widget/LockPatternView;
 
-    invoke-interface {v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    if-eqz v4, :cond_1
 
-    move-result v9
+    iget-object v5, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mSecurityView:Landroid/widget/LinearLayout;
 
-    const v11, 0x7f0704f8
+    if-eqz v5, :cond_1
 
-    if-eqz v9, :cond_2
+    invoke-virtual {v4}, Lcom/android/internal/widget/LockPatternView;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
+    move-result-object v6
 
-    move-result v9
+    check-cast v6, Landroid/widget/FrameLayout$LayoutParams;
 
-    if-eqz v9, :cond_2
+    const/16 v7, 0x51
 
-    iget v9, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mSecondsRemaining:I
+    invoke-virtual {v5, v7}, Landroid/widget/LinearLayout;->setGravity(I)V
 
-    if-ne v9, v1, :cond_2
+    invoke-virtual {v5, v3}, Landroid/widget/LinearLayout;->setOrientation(I)V
 
-    sget v9, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    const v5, 0x7f0704fa
 
-    invoke-virtual {v0, v11}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v11
+    move-result v5
 
-    add-int/2addr v11, v9
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->width:I
 
-    invoke-virtual {v0, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    const v5, 0x7f0704f6
 
-    move-result v9
+    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    sub-int/2addr v11, v9
+    move-result v5
 
-    const v9, 0x105024e
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->height:I
 
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    move-result v9
+    const v5, 0x7f0704f8
 
-    sub-int/2addr v11, v9
+    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    if-eqz v7, :cond_1
+    move-result v5
 
-    invoke-virtual {v7, v2}, Landroid/view/View;->findViewById(I)Landroid/view/View;
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->bottomMargin:I
 
-    move-result-object v9
+    invoke-virtual {v4, v6}, Lcom/android/internal/widget/LockPatternView;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v9}, Landroid/view/View;->getVisibility()I
+    :cond_1
+    iget-object v4, p0, Lcom/android/keyguard/KeyguardInputViewController;->mMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
 
-    move-result v9
+    if-eqz v4, :cond_2
 
-    if-nez v9, :cond_1
+    invoke-virtual {v4}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    const v9, 0x7f070404
+    move-result-object v5
 
-    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    check-cast v5, Landroid/view/ViewGroup$MarginLayoutParams;
 
-    move-result v9
+    const v6, 0x7f0704fc
 
-    goto :goto_0
+    invoke-virtual {v0, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :cond_1
-    move v9, v8
+    move-result v6
 
-    :goto_0
-    sub-int/2addr v11, v9
+    iput v6, v5, Landroid/view/ViewGroup$MarginLayoutParams;->bottomMargin:I
 
-    goto :goto_1
+    invoke-virtual {v4, v5}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     :cond_2
-    invoke-virtual {v0, v11}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v11
+    const/4 v4, 0x0
 
-    :goto_1
-    iput v11, v10, Landroid/widget/FrameLayout$LayoutParams;->bottomMargin:I
+    iget-object v5, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mMessageArea:Landroid/widget/LinearLayout;
 
-    invoke-virtual {v6, v10}, Lcom/android/internal/widget/LockPatternView;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    if-eqz v5, :cond_4
 
-    :cond_3
-    iget-object v6, p0, Lcom/android/keyguard/KeyguardInputViewController;->mMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
+    iget-object v6, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mContainer:Landroid/widget/LinearLayout;
 
     if-eqz v6, :cond_4
 
-    invoke-virtual {v6}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
-
-    move-result-object v9
-
-    check-cast v9, Landroid/view/ViewGroup$MarginLayoutParams;
-
-    const v10, 0x7f0704fc
-
-    invoke-virtual {v0, v10}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v10
-
-    iput v10, v9, Landroid/view/ViewGroup$MarginLayoutParams;->bottomMargin:I
-
-    invoke-virtual {v6, v9}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
-
-    :cond_4
-    iget-object v6, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mMessageArea:Landroid/widget/LinearLayout;
-
-    if-eqz v6, :cond_6
+    invoke-virtual {v5}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    iget-object v9, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mContainer:Landroid/widget/LinearLayout;
+    move-result-object v7
 
-    if-eqz v9, :cond_6
+    check-cast v7, Landroid/widget/LinearLayout$LayoutParams;
 
     invoke-virtual {v6}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    move-result-object v10
+    move-result-object v8
 
-    check-cast v10, Landroid/widget/LinearLayout$LayoutParams;
+    check-cast v8, Landroid/widget/LinearLayout$LayoutParams;
 
-    invoke-virtual {v9}, Landroid/widget/LinearLayout;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
+    sget-boolean v9, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    move-result-object v11
+    if-eqz v9, :cond_3
 
-    check-cast v11, Landroid/widget/LinearLayout$LayoutParams;
+    const-class v9, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    sget-boolean v12, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
+    invoke-static {v9}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    if-eqz v12, :cond_5
+    move-result-object v9
 
-    const-class v12, Lcom/android/systemui/keyguard/DisplayLifecycle;
+    check-cast v9, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    invoke-static {v12}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    iget-boolean v9, v9, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    move-result-object v12
+    if-eqz v9, :cond_3
 
-    check-cast v12, Lcom/android/systemui/keyguard/DisplayLifecycle;
+    move v9, v4
 
-    iget-boolean v12, v12, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
+    goto :goto_0
 
-    if-eqz v12, :cond_5
+    :cond_3
+    const v9, 0x7f0704e8
 
-    move v12, v8
+    invoke-virtual {v0, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    goto :goto_2
+    move-result v9
 
-    :cond_5
-    const v12, 0x7f0704e8
+    :goto_0
+    invoke-virtual {v5, v9, v4, v9, v4}, Landroid/widget/LinearLayout;->setPadding(IIII)V
 
-    invoke-virtual {v0, v12}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, v4, v4, v4, v4}, Landroid/widget/LinearLayout;->setPadding(IIII)V
 
-    move-result v12
+    iput v1, v7, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
-    :goto_2
-    invoke-virtual {v6, v12, v8, v12, v8}, Landroid/widget/LinearLayout;->setPadding(IIII)V
+    const/4 v9, -0x2
 
-    invoke-virtual {v9, v8, v8, v8, v8}, Landroid/widget/LinearLayout;->setPadding(IIII)V
+    iput v9, v7, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
-    iput v1, v10, Landroid/widget/LinearLayout$LayoutParams;->width:I
+    iput v4, v7, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
 
-    const/4 v12, -0x2
+    iput v1, v8, Landroid/widget/LinearLayout$LayoutParams;->width:I
 
-    iput v12, v10, Landroid/widget/LinearLayout$LayoutParams;->height:I
+    iput v9, v8, Landroid/widget/LinearLayout$LayoutParams;->height:I
 
-    iput v8, v10, Landroid/widget/LinearLayout$LayoutParams;->bottomMargin:I
+    invoke-virtual {v6, v4}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    iput v1, v11, Landroid/widget/LinearLayout$LayoutParams;->width:I
+    invoke-virtual {v5, v7}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    iput v12, v11, Landroid/widget/LinearLayout$LayoutParams;->height:I
+    invoke-virtual {v6, v8}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v9, v8}, Landroid/widget/LinearLayout;->setVisibility(I)V
+    :cond_4
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mBottomView:Landroid/widget/LinearLayout;
 
-    invoke-virtual {v6, v10}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    if-eqz v1, :cond_5
 
-    invoke-virtual {v9, v11}, Landroid/widget/LinearLayout;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    const/16 v5, 0x50
 
-    :cond_6
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mBottomView:Landroid/widget/LinearLayout;
+    invoke-virtual {v1, v5}, Landroid/widget/LinearLayout;->setGravity(I)V
 
-    if-eqz v1, :cond_7
+    invoke-virtual {v1, v3}, Landroid/widget/LinearLayout;->setOrientation(I)V
 
-    const/16 v6, 0x50
+    :cond_5
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEcaView:Landroid/view/View;
 
-    invoke-virtual {v1, v6}, Landroid/widget/LinearLayout;->setGravity(I)V
+    if-eqz v1, :cond_6
 
-    invoke-virtual {v1, v5}, Landroid/widget/LinearLayout;->setOrientation(I)V
+    invoke-virtual {v1}, Landroid/view/View;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
 
-    :cond_7
-    if-eqz v7, :cond_8
-
-    invoke-virtual {v7}, Landroid/view/View;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
+    move-result-object v3
 
-    move-result-object v1
+    check-cast v3, Landroid/view/ViewGroup$MarginLayoutParams;
 
-    check-cast v1, Landroid/view/ViewGroup$MarginLayoutParams;
+    iget v5, v3, Landroid/view/ViewGroup$MarginLayoutParams;->leftMargin:I
 
-    iget v5, v1, Landroid/view/ViewGroup$MarginLayoutParams;->leftMargin:I
+    iget v6, v3, Landroid/view/ViewGroup$MarginLayoutParams;->topMargin:I
 
-    iget v6, v1, Landroid/view/ViewGroup$MarginLayoutParams;->topMargin:I
+    iget v7, v3, Landroid/view/ViewGroup$MarginLayoutParams;->rightMargin:I
 
-    iget v9, v1, Landroid/view/ViewGroup$MarginLayoutParams;->rightMargin:I
+    const v8, 0x7f0704f4
 
-    invoke-virtual {v0, v3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v0, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v0
 
-    invoke-virtual {v1, v5, v6, v9, v0}, Landroid/view/ViewGroup$MarginLayoutParams;->setMargins(IIII)V
+    invoke-virtual {v3, v5, v6, v7, v0}, Landroid/view/ViewGroup$MarginLayoutParams;->setMargins(IIII)V
 
-    invoke-virtual {v7, v1}, Landroid/view/View;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
+    invoke-virtual {v1, v3}, Landroid/view/View;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
-    invoke-virtual {v7, v8}, Landroid/view/View;->setVisibility(I)V
+    invoke-virtual {v1, v4}, Landroid/view/View;->setVisibility(I)V
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEmergencyButtonController:Lcom/android/keyguard/EmergencyButtonController;
 
-    invoke-virtual {v7, v2}, Landroid/view/View;->findViewById(I)Landroid/view/View;
+    const v3, 0x7f0a0398
+
+    invoke-virtual {v1, v3}, Landroid/view/View;->findViewById(I)Landroid/view/View;
 
     move-result-object v1
 
     invoke-virtual {v0, v1}, Lcom/android/keyguard/EmergencyButtonController;->setEmergencyView(Landroid/view/View;)V
 
-    :cond_8
+    :cond_6
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mEcaFlexContainer:Landroid/widget/LinearLayout;
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_7
 
     const/16 v1, 0x8
 
     invoke-virtual {v0, v1}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
-    :cond_9
-    invoke-interface {v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
+    :cond_7
+    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
 
     move-result v0
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_8
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardInputViewController;->mSubMessageAreaController:Lcom/android/keyguard/KeyguardSecMessageAreaController;
 
-    if-eqz v0, :cond_a
+    if-eqz v0, :cond_8
 
-    invoke-virtual {v0, v8}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setVisibility(I)V
+    invoke-virtual {v0, v4}, Lcom/android/keyguard/KeyguardSecMessageAreaController;->setVisibility(I)V
 
-    :cond_a
+    :cond_8
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecPatternViewController;->isHintText()Z
 
     move-result v0
 
-    if-eqz v0, :cond_b
+    if-eqz v0, :cond_9
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecPatternViewController;->mHintText:Lcom/android/keyguard/KeyguardHintTextArea;
 
-    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardHintTextArea;->setVisibility(I)V
+    invoke-virtual {p0, v4}, Lcom/android/keyguard/KeyguardHintTextArea;->setVisibility(I)V
 
-    :cond_b
+    :cond_9
     return-void
 .end method
 
diff --git a/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali b/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali
index 043a1724..28762cb3 100644
--- a/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali
+++ b/smali/com/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode.smali
@@ -86,7 +86,7 @@
 .end method
 
 .method public final updateSecurityViewPosition(IZ)V
-    .locals 9
+    .locals 8
 
     if-eqz p2, :cond_0
 
@@ -169,45 +169,33 @@
 
     check-cast v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    sget v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_2
+    const/4 v2, 0x1
 
-    :cond_3
-    move v2, v3
+    const/4 v4, 0x2
 
-    :goto_2
-    const/4 v4, 0x1
+    if-eqz p1, :cond_4
 
-    const/4 v5, 0x2
+    if-eq p1, v4, :cond_3
 
-    if-eqz p1, :cond_5
+    goto :goto_3
 
-    if-eq p1, v5, :cond_4
+    :cond_3
+    if-ne v0, v2, :cond_5
 
-    goto :goto_4
+    goto :goto_2
 
     :cond_4
-    if-ne v0, v4, :cond_6
+    const/4 v5, 0x3
 
-    goto :goto_3
-
-    :cond_5
-    const/4 v6, 0x3
+    if-ne v0, v5, :cond_5
 
-    if-ne v0, v6, :cond_6
+    :goto_2
+    add-int/lit8 v1, v1, 0x0
 
+    :cond_5
     :goto_3
-    add-int/2addr v1, v2
-
-    :cond_6
-    :goto_4
     move v6, v1
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
@@ -218,7 +206,7 @@
 
     sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
-    if-eqz v1, :cond_7
+    if-eqz v1, :cond_6
 
     const v1, 0x105024e
 
@@ -226,23 +214,25 @@
 
     move-result v1
 
-    goto :goto_5
+    move v7, v1
 
-    :cond_7
-    move v1, v3
+    goto :goto_4
 
-    :goto_5
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
+    :cond_6
+    move v7, v3
 
-    invoke-virtual {v2}, Landroid/view/ViewGroup;->getContext()Landroid/content/Context;
+    :goto_4
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
 
-    move-result-object v2
+    invoke-virtual {v1}, Landroid/view/ViewGroup;->getContext()Landroid/content/Context;
 
-    invoke-static {v2}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
+    move-result-object v1
 
-    move-result v2
+    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
-    if-eqz v2, :cond_8
+    move-result v1
+
+    if-eqz v1, :cond_7
 
     invoke-virtual {v0}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
@@ -258,72 +248,23 @@
 
     move-result v0
 
-    goto :goto_6
+    goto :goto_5
 
-    :cond_8
+    :cond_7
     move v0, v3
 
-    :goto_6
-    const-class v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-static {v2}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_9
-
-    sget v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
-
-    move-result v7
-
-    if-eqz v7, :cond_a
-
-    iget-object v7, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mView:Landroidx/constraintlayout/widget/ConstraintLayout;
-
-    invoke-virtual {v7}, Landroid/view/ViewGroup;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v7
-
-    const v8, 0x7f07049e
-
-    invoke-virtual {v7, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v7
-
-    add-int/2addr v2, v7
-
-    goto :goto_7
-
-    :cond_9
-    move v2, v3
-
-    :cond_a
-    :goto_7
-    if-nez v0, :cond_c
-
-    if-nez v2, :cond_b
+    :goto_5
+    const-class v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    goto :goto_8
+    invoke-static {v1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    :cond_b
-    move v0, v2
+    move-result-object v1
 
-    goto :goto_9
+    check-cast v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    :cond_c
-    :goto_8
-    move v0, v1
+    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :goto_9
-    if-nez p1, :cond_d
+    if-nez p1, :cond_8
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
@@ -341,10 +282,10 @@
 
     invoke-virtual/range {v1 .. v6}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    goto :goto_a
+    goto :goto_6
 
-    :cond_d
-    if-ne p1, v5, :cond_e
+    :cond_8
+    if-ne p1, v4, :cond_9
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
@@ -362,16 +303,16 @@
 
     invoke-virtual/range {v1 .. v6}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    goto :goto_a
+    goto :goto_6
 
-    :cond_e
+    :cond_9
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
     invoke-virtual {p1}, Landroid/widget/ViewFlipper;->getId()I
 
     move-result p1
 
-    invoke-virtual {p2, p1, v4, v3, v4}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {p2, p1, v2, v3, v2}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
@@ -379,9 +320,9 @@
 
     move-result p1
 
-    invoke-virtual {p2, p1, v5, v3, v5}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {p2, p1, v4, v3, v4}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    :goto_a
+    :goto_6
     iget-object p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainer$ArrowViewMode;->mViewFlipper:Lcom/android/keyguard/KeyguardSecurityViewFlipper;
 
     invoke-virtual {p1}, Landroid/widget/ViewFlipper;->getId()I
@@ -396,7 +337,7 @@
 
     move-object v1, p2
 
-    move v6, v0
+    move v6, v7
 
     invoke-virtual/range {v1 .. v6}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
diff --git a/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali b/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali
index feaefd1a..208e3ff3 100644
--- a/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali
+++ b/smali/com/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener.smali
@@ -61,7 +61,7 @@
     move p1, v1
 
     :goto_0
-    if-eqz p1, :cond_9
+    if-eqz p1, :cond_8
 
     sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
@@ -97,7 +97,7 @@
 
     iget v4, v3, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
 
-    if-eq v4, v2, :cond_8
+    if-eq v4, v2, :cond_7
 
     iput v2, v3, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
 
@@ -168,66 +168,18 @@
     aput v4, v3, v0
 
     :cond_7
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_8
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
-
-    iget-object v3, v0, Lcom/android/keyguard/KeyguardSecurityContainerController;->mUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    iget-boolean v0, v0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
-
-    invoke-interface {v3, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->updateSIPShownState(Z)V
-
-    :cond_8
     invoke-static {p1, v2}, Ljava/lang/Integer;->max(II)I
 
     move-result p1
 
-    goto :goto_5
-
-    :cond_9
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_b
-
-    invoke-static {}, Landroid/view/WindowInsets$Type;->ime()I
-
-    move-result p1
-
-    invoke-virtual {p2, p1}, Landroid/view/WindowInsets;->getInsets(I)Landroid/graphics/Insets;
-
-    move-result-object p1
-
-    iget p1, p1, Landroid/graphics/Insets;->bottom:I
-
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
-
-    iget v3, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
-
-    if-eq v3, p1, :cond_b
-
-    iput p1, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mImeBottom:I
-
-    if-eqz p1, :cond_a
-
     goto :goto_4
 
-    :cond_a
-    move v0, v1
-
-    :goto_4
-    iput-boolean v0, v2, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
-
-    iget-object p1, v2, Lcom/android/keyguard/KeyguardSecurityContainerController;->mUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->updateSIPShownState(Z)V
+    :cond_8
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_b
     move p1, v1
 
-    :goto_5
+    :goto_4
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController$OnApplyWindowInsetsListener;->this$0:Lcom/android/keyguard/KeyguardSecSecurityContainerController;
 
     iget-object v0, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
diff --git a/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali b/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali
index b3d0311d..ba9e83af 100644
--- a/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali
+++ b/smali/com/android/keyguard/KeyguardSecSecurityContainerController.smali
@@ -2811,33 +2811,27 @@
 
     move-result v0
 
-    if-eqz v0, :cond_12
+    if-eqz v0, :cond_11
 
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    sget-object v0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
 
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v1
-
-    const v6, 0x7f07049e
-
-    invoke-virtual {v1, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v1
+    move-result-object v0
 
-    add-int/2addr v1, v0
+    const v1, 0x7f07049e
 
-    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    invoke-virtual {v0, v1}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v0
+    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    if-eq p1, v2, :cond_10
+    if-eq p1, v2, :cond_f
 
-    const/4 v2, 0x2
+    const/4 v0, 0x2
 
-    if-eq p1, v2, :cond_10
+    if-eq p1, v0, :cond_f
 
-    if-eq p1, v4, :cond_10
+    if-eq p1, v4, :cond_f
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
 
@@ -2850,38 +2844,33 @@
     goto :goto_8
 
     :cond_e
-    if-eqz v0, :cond_f
+    iget p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
     goto :goto_9
 
     :cond_f
-    iget v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
-
-    goto :goto_9
-
-    :cond_10
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
 
-    if-eqz p1, :cond_11
+    if-eqz p1, :cond_10
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
 
-    if-eqz p1, :cond_11
+    if-eqz p1, :cond_10
 
     :goto_8
-    move v1, v3
+    move p1, v3
 
     goto :goto_9
 
-    :cond_11
-    iget v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
+    :cond_10
+    iget p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
     :goto_9
-    invoke-virtual {p0, v3, v3, v1}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutParams(III)V
+    invoke-virtual {p0, v3, v3, p1}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutParams(III)V
 
     return-void
 
-    :cond_12
+    :cond_11
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
     move-result-object v0
@@ -2890,50 +2879,42 @@
 
     move-result v0
 
-    if-nez v0, :cond_13
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_13
+    if-nez v0, :cond_12
 
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNeedsInput:Z
 
-    if-eqz v0, :cond_13
+    if-eqz v0, :cond_12
 
     sget-object v0, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->KNOXGUARD:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    if-eq v1, v0, :cond_13
+    if-eq v1, v0, :cond_12
 
     move p1, v3
 
     move v0, p1
 
-    goto :goto_e
-
-    :cond_13
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    goto :goto_d
 
-    move-result v1
+    :cond_12
+    invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
     invoke-interface {v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
 
-    move-result v5
+    move-result v0
 
-    if-eqz v5, :cond_14
+    if-eqz v0, :cond_13
 
-    move v5, v3
+    move v0, v3
 
     goto :goto_a
 
-    :cond_14
-    iget v5, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
+    :cond_13
+    iget v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
     :goto_a
-    if-eq p1, v2, :cond_19
+    if-eq p1, v2, :cond_16
 
-    if-eq p1, v4, :cond_17
+    if-eq p1, v4, :cond_16
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
 
@@ -2941,66 +2922,40 @@
 
     xor-int/2addr p1, v2
 
-    and-int/2addr p1, v1
-
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
+    and-int/2addr p1, v3
 
-    if-eqz v1, :cond_15
-
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
-
-    if-eqz v1, :cond_15
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsPassword:Z
 
-    move v0, v3
+    if-eqz v0, :cond_14
 
-    goto :goto_b
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mIsImeShown:Z
 
-    :cond_15
-    if-eqz p1, :cond_16
+    if-eqz v0, :cond_14
 
     goto :goto_b
 
-    :cond_16
-    iget v0, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
+    :cond_14
+    if-eqz p1, :cond_15
 
     :goto_b
-    move p1, v0
-
-    move v0, v3
-
-    goto :goto_e
-
-    :cond_17
-    if-eqz v1, :cond_18
+    move p1, v3
 
     goto :goto_c
 
-    :cond_18
-    move v0, v5
+    :cond_15
+    iget p1, p0, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->mNavigationBarHeight:I
 
     :goto_c
-    move v7, v5
-
-    move v5, v0
-
-    move v0, v7
-
-    goto :goto_d
-
-    :cond_19
-    if-eqz v1, :cond_1a
+    move v0, v3
 
     goto :goto_d
 
-    :cond_1a
-    move v0, v5
-
-    :goto_d
+    :cond_16
     move p1, v3
 
-    move v3, v5
+    move v3, v0
 
-    :goto_e
+    :goto_d
     invoke-virtual {p0, v3, v0, p1}, Lcom/android/keyguard/KeyguardSecSecurityContainerController;->updateLayoutParams(III)V
 
     return-void
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali
index a898785b..c8313e1f 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitor.smali
@@ -574,12 +574,10 @@
     return p0
 .end method
 
-.method public isInDisplayFingerprintMarginAccepted()Z
+.method public isInDisplayFingerprintMarginAccepted()V
     .locals 0
 
-    const/4 p0, 0x0
-
-    return p0
+    return-void
 .end method
 
 .method public isKeyguardUnlocking()Z
@@ -900,6 +898,12 @@
     return-void
 .end method
 
+.method public setShowingKeepScreenOnPopup(Z)V
+    .locals 0
+
+    return-void
+.end method
+
 .method public setUnlockingKeyguard(Z)V
     .locals 0
 
@@ -948,12 +952,6 @@
     return-void
 .end method
 
-.method public updateSIPShownState(Z)V
-    .locals 0
-
-    return-void
-.end method
-
 .method public updateUserUnlockNotification(I)V
     .locals 0
 
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13.smali
index 7b8d92f4..68278ce9 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13.smali
@@ -28,12 +28,10 @@
 
 # virtual methods
 .method public final onChanged(Landroid/net/Uri;)V
-    .locals 1
+    .locals 0
 
     iget p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13;->$r8$classId:I
 
-    const/4 v0, 0x2
-
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     packed-switch p1, :pswitch_data_0
@@ -58,22 +56,21 @@
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchLockModeChanged()V
 
     :cond_0
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_1
     return-void
 
     :goto_0
-    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    const/4 p1, 0x2
+
+    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
     sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     return-void
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x0
         :pswitch_0
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda14.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda14.smali
index e33d047e..db27c393 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda14.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda14.smali
@@ -40,26 +40,15 @@
 
     const/4 v1, 0x1
 
-    if-ne p1, v1, :cond_2
+    if-ne p1, v1, :cond_1
 
     :cond_0
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
-
-    :cond_1
     sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_COCKTAIL_BAR_SHOWING_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
     invoke-virtual {p0, v0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_2
+    :cond_1
     return-void
 .end method
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali
index 48190a18..4303412c 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7.smali
@@ -32,20 +32,21 @@
 
     iget v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->$r8$classId:I
 
-    const/4 v1, 0x0
+    const/4 v1, 0x2
 
-    const/4 v2, 0x2
+    const/4 v2, 0x0
 
     packed-switch v0, :pswitch_data_0
 
+    :pswitch_0
     goto/16 :goto_0
 
-    :pswitch_0
+    :pswitch_1
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFastUnlockController:Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;
 
-    new-array v0, v1, [Ljava/lang/Object;
+    new-array v0, v2, [Ljava/lang/Object;
 
     const-string v1, "onFpAuthenticationSucceeded end"
 
@@ -53,7 +54,7 @@
 
     return-void
 
-    :pswitch_1
+    :pswitch_2
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
@@ -73,7 +74,7 @@
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFace(Lcom/android/keyguard/FaceAuthUiEvent;)V
 
     :cond_0
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
+    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFaceManager:Landroid/hardware/face/FaceManager;
 
@@ -92,12 +93,12 @@
     :cond_1
     return-void
 
-    :pswitch_2
+    :pswitch_3
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFastUnlockController:Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;
 
-    new-array v0, v1, [Ljava/lang/Object;
+    new-array v0, v2, [Ljava/lang/Object;
 
     const-string v1, "onFaceAuthenticationSucceeded end"
 
@@ -105,7 +106,7 @@
 
     return-void
 
-    :pswitch_3
+    :pswitch_4
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
@@ -154,7 +155,7 @@
     :cond_3
     return-void
 
-    :pswitch_4
+    :pswitch_5
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLooperSlowLogController:Lcom/android/systemui/uithreadmonitor/LooperSlowLogController;
@@ -175,7 +176,7 @@
 
     return-void
 
-    :pswitch_5
+    :pswitch_6
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mLooperSlowLogController:Lcom/android/systemui/uithreadmonitor/LooperSlowLogController;
@@ -196,52 +197,40 @@
 
     return-void
 
-    :pswitch_6
+    :pswitch_7
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string v0, "KeyguardFingerprint"
+    const-string p0, "KeyguardFingerprint"
 
-    const-string v1, "Waiting window focus change"
+    const-string v0, "Waiting window focus change"
 
-    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p0, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz v0, :cond_4
-
-    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
-
-    :cond_4
     return-void
 
-    :pswitch_7
+    :pswitch_8
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     sget-object v0, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_FULL_SCREEN_FACE_WIDGET:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    invoke-virtual {p0, v2, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+    invoke-virtual {p0, v1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateBiometricListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     return-void
 
-    :pswitch_8
+    :pswitch_9
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
     sget-object v0, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_WINDOW_FOCUS_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    invoke-virtual {p0, v2, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
-
-    return-void
-
-    :pswitch_9
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;->f$0:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;
-
-    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    invoke-virtual {p0, v1, v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     return-void
 
@@ -269,17 +258,16 @@
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v2
+    move-result-wide v0
 
-    invoke-virtual {p0, v2, v3, v1, v1}, Landroid/os/PowerManager;->userActivity(JII)V
+    invoke-virtual {p0, v0, v1, v2, v2}, Landroid/os/PowerManager;->userActivity(JII)V
 
     return-void
 
-    nop
-
     :pswitch_data_0
     .packed-switch 0x0
         :pswitch_a
+        :pswitch_0
         :pswitch_9
         :pswitch_8
         :pswitch_7
@@ -289,6 +277,5 @@
         :pswitch_3
         :pswitch_2
         :pswitch_1
-        :pswitch_0
     .end packed-switch
 .end method
diff --git a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali
index b818096c..d0e13580 100644
--- a/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali
+++ b/smali/com/android/keyguard/KeyguardSecUpdateMonitorImpl.smali
@@ -72,8 +72,6 @@
 
 .field public mForceStartFinger:Z
 
-.field public mFpInDisplayState:I
-
 .field public final mFpMessages:Ljava/util/concurrent/ConcurrentLinkedQueue;
 
 .field public final mFpMsgConsumer:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda10;
@@ -102,8 +100,6 @@
 
 .field public mIsEarlyWakeUp:Z
 
-.field public mIsFODStrictMode:Z
-
 .field public mIsFPCanceledByForegroundApp:Z
 
 .field public mIsFPCanceledByProximity:Z
@@ -122,8 +118,6 @@
 
 .field public mIsOwnerInfoEnabled:Z
 
-.field public mIsPanelExpandingStarted:Z
-
 .field public mIsQsFullyExpanded:Z
 
 .field public mIsRunningBlackMemo:Z
@@ -182,8 +176,6 @@
 
 .field public mRemoteLockSimulationInfo:Lcom/android/internal/widget/RemoteLockInfo;
 
-.field public mSIPShown:Z
-
 .field public final mSecureLockChangedCallback:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$2;
 
 .field public mSemFaceCancelSignal:Landroid/os/CancellationSignal;
@@ -214,8 +206,6 @@
 
 .field public final mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
 
-.field public final mWindowManagerService:Landroid/view/IWindowManager;
-
 
 # direct methods
 .method public constructor <init>(Lcom/android/internal/app/IBatteryStats;Landroid/app/NotificationManager;Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;Lcom/android/systemui/uithreadmonitor/BinderCallMonitor;Lcom/android/systemui/uithreadmonitor/LooperSlowLogController;Lcom/android/systemui/util/SettingsHelper;Landroid/app/AlarmManager;Landroid/os/PowerManager;Ldagger/Lazy;Ldagger/Lazy;Ldagger/Lazy;Ldagger/Lazy;Landroid/view/IWindowManager;Landroid/content/Context;Lcom/android/systemui/settings/UserTracker;Landroid/os/Looper;Lcom/android/systemui/broadcast/BroadcastDispatcher;Lcom/android/systemui/util/settings/SecureSettings;Lcom/android/systemui/dump/DumpManager;Ljava/util/concurrent/Executor;Ljava/util/concurrent/Executor;Lcom/android/systemui/plugins/statusbar/StatusBarStateController;Lcom/android/internal/widget/LockPatternUtils;Lcom/android/systemui/biometrics/AuthController;Lcom/android/systemui/telephony/TelephonyListenerManager;Lcom/android/internal/jank/InteractionJankMonitor;Lcom/android/internal/util/LatencyTracker;Lcom/android/keyguard/ActiveUnlockConfig;Lcom/android/keyguard/logging/KeyguardUpdateMonitorLogger;Lcom/android/internal/logging/UiEventLogger;Ljavax/inject/Provider;Landroid/app/trust/TrustManager;Landroid/telephony/SubscriptionManager;Landroid/os/UserManager;Landroid/service/dreams/IDreamManager;Landroid/app/admin/DevicePolicyManager;Landroid/hardware/SensorPrivacyManager;Landroid/telephony/TelephonyManager;Landroid/content/pm/PackageManager;Landroid/hardware/face/FaceManager;Landroid/hardware/fingerprint/FingerprintManager;Landroid/hardware/biometrics/BiometricManager;Lcom/android/keyguard/FaceWakeUpTriggersConfig;Lcom/android/systemui/statusbar/policy/DevicePostureController;Ljava/util/Optional;)V
@@ -483,12 +473,8 @@
 
     iput-object v1, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mESimRemoved:[Z
 
-    iput v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
     iput-boolean v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
-    iput-boolean v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
     iput v4, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mCocktailBarWindowType:I
 
     new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13;
@@ -897,15 +883,8 @@
 
     invoke-virtual {v5, v0, v1}, Lcom/android/systemui/broadcast/BroadcastDispatcher;->registerReceiver(Landroid/content/IntentFilter;Landroid/content/BroadcastReceiver;)V
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_3
-
-    move-object/from16 v1, p13
-
-    iput-object v1, v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWindowManagerService:Landroid/view/IWindowManager;
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_3
     return-void
 .end method
 
@@ -1019,9 +998,7 @@
 
     invoke-virtual {v1, v0}, Landroid/util/SparseIntArray;->delete(I)V
 
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_0
     const-class v1, Lcom/android/systemui/UiOffloadThread;
@@ -4698,25 +4675,8 @@
     sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :goto_0
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_1
-
-    iget v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mFingerprintRunningState:I
-
-    const/4 v1, 0x1
-
-    if-ne v0, v1, :cond_1
-
-    const-string v0, "KeyguardFingerprint"
-
-    const-string v1, "Face onAuthenticationSucceeded. FP will be stop!"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFingerprint()V
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_1
     new-instance v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda19;
 
     const/4 v1, 0x0
@@ -4739,11 +4699,11 @@
 
     sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    if-eqz p1, :cond_2
+    if-eqz p1, :cond_1
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
 
-    :cond_2
+    :cond_1
     return-void
 .end method
 
@@ -5350,17 +5310,17 @@
 
     iget-boolean v3, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
 
-    const-string v4, "KeyguardFingerprint"
+    const/4 v4, 0x0
 
-    const/4 v5, 0x0
+    const-string v5, "KeyguardFingerprint"
 
     if-eqz v3, :cond_0
 
-    iput-boolean v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+    iput-boolean v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
 
     const-string v0, "handleFingerprintHelp( skipped FP response )"
 
-    invoke-static {v4, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 
@@ -5379,7 +5339,7 @@
 
     const-string v1, "handleFingerprintHelp( unlock is not allowed. )"
 
-    invoke-static {v4, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFingerprint()V
 
@@ -5400,20 +5360,20 @@
 
     if-nez v7, :cond_2
 
-    if-eq v1, v8, :cond_11
+    if-eq v1, v8, :cond_12
 
     iget-object v2, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mPowerManager:Landroid/os/PowerManager;
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v6
+    move-result-wide v5
 
-    invoke-virtual {v2, v6, v7, v5, v5}, Landroid/os/PowerManager;->userActivity(JII)V
+    invoke-virtual {v2, v5, v6, v4, v4}, Landroid/os/PowerManager;->userActivity(JII)V
 
     goto/16 :goto_7
 
     :cond_2
-    if-eq v1, v8, :cond_13
+    if-eq v1, v8, :cond_14
 
     const/16 v7, 0x3ed
 
@@ -5436,7 +5396,7 @@
 
     move-result v2
 
-    invoke-virtual {v1, v2, v5}, Landroid/util/SparseIntArray;->get(II)I
+    invoke-virtual {v1, v2, v4}, Landroid/util/SparseIntArray;->get(II)I
 
     move-result v1
 
@@ -5464,7 +5424,7 @@
 
     const-string v6, " )"
 
-    invoke-static {v2, v6, v4}, Landroidx/exifinterface/media/ExifInterface$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {v2, v6, v5}, Landroidx/exifinterface/media/ExifInterface$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V
 
     const/16 v2, 0x32
 
@@ -5495,7 +5455,7 @@
     goto :goto_0
 
     :cond_4
-    move v3, v5
+    move v3, v4
 
     :goto_0
     if-eqz v3, :cond_5
@@ -5532,19 +5492,19 @@
 
     invoke-direct {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda24;-><init>()V
 
-    const v4, 0x7f130863
+    const v5, 0x7f130863
 
-    invoke-virtual {v2, v4, v3}, Lcom/android/systemui/statusbar/phone/SystemUIDialog;->setPositiveButton(ILandroid/content/DialogInterface$OnClickListener;)V
+    invoke-virtual {v2, v5, v3}, Lcom/android/systemui/statusbar/phone/SystemUIDialog;->setPositiveButton(ILandroid/content/DialogInterface$OnClickListener;)V
 
     new-instance v13, Landroid/widget/CheckBox;
 
     new-instance v3, Landroid/view/ContextThemeWrapper;
 
-    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mContext:Landroid/content/Context;
+    iget-object v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mContext:Landroid/content/Context;
 
     const v6, 0x7f140560
 
-    invoke-direct {v3, v4, v6}, Landroid/view/ContextThemeWrapper;-><init>(Landroid/content/Context;I)V
+    invoke-direct {v3, v5, v6}, Landroid/view/ContextThemeWrapper;-><init>(Landroid/content/Context;I)V
 
     invoke-direct {v13, v3}, Landroid/widget/CheckBox;-><init>(Landroid/content/Context;)V
 
@@ -5562,7 +5522,7 @@
 
     move-result v3
 
-    invoke-virtual {v13, v3, v5, v5, v5}, Landroid/widget/CheckBox;->setPadding(IIII)V
+    invoke-virtual {v13, v3, v4, v4, v4}, Landroid/widget/CheckBox;->setPadding(IIII)V
 
     new-instance v3, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda25;
 
@@ -5588,7 +5548,7 @@
 
     invoke-virtual/range {v12 .. v17}, Landroid/app/AlertDialog;->setView(Landroid/view/View;IIII)V
 
-    invoke-virtual {v2, v5}, Landroid/app/AlertDialog;->setCancelable(Z)V
+    invoke-virtual {v2, v4}, Landroid/app/AlertDialog;->setCancelable(Z)V
 
     invoke-virtual {v2}, Landroid/app/AlertDialog;->show()V
 
@@ -5597,12 +5557,12 @@
     :cond_5
     const-string v1, "Skip to show fingerprint sensor block popup"
 
-    invoke-static {v4, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :goto_1
     invoke-virtual {v0, v7}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
-    invoke-virtual {v0, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     goto :goto_2
 
@@ -5611,7 +5571,7 @@
 
     if-ne v1, v2, :cond_7
 
-    invoke-virtual {v0, v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_7
     :goto_2
@@ -5663,21 +5623,21 @@
 
     move-result-object v12
 
-    invoke-static {v4, v12}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v12}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getFailedBiometricUnlockAttempts(I)I
 
-    move-result v4
+    move-result v5
 
     const/4 v12, 0x3
 
-    if-ne v4, v12, :cond_a
+    if-ne v5, v12, :cond_a
 
-    iget-object v4, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardBatteryStatus:Lcom/android/systemui/statusbar/KeyguardBatteryStatus;
+    iget-object v5, v0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardBatteryStatus:Lcom/android/systemui/statusbar/KeyguardBatteryStatus;
 
-    invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    invoke-virtual {v5}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-object v4, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-object v5, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_a
     invoke-virtual {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getFailedBiometricUnlockAttempts(I)I
@@ -5693,11 +5653,11 @@
 
     if-nez v2, :cond_c
 
-    move v5, v3
+    move v4, v3
 
     :cond_c
     :goto_3
-    if-eqz v5, :cond_10
+    if-eqz v4, :cond_11
 
     new-instance v2, Lcom/samsung/android/aod/AODToast$Builder;
 
@@ -5739,15 +5699,17 @@
 
     move-result-object v6
 
-    if-eqz v8, :cond_d
+    if-eqz v8, :cond_e
 
-    sget-object v5, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v5, :cond_d
 
     invoke-static {v6}, Landroidx/constraintlayout/core/ArrayLinkedVariables$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v5
 
-    const v6, 0x7f130944
+    const v6, 0x7f130945
 
     invoke-virtual {v4, v6}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
@@ -5762,6 +5724,25 @@
     goto :goto_5
 
     :cond_d
+    invoke-static {v6}, Landroidx/constraintlayout/core/ArrayLinkedVariables$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    const v6, 0x7f130944
+
+    invoke-virtual {v4, v6}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    goto :goto_5
+
+    :cond_e
     sget-object v8, Lcom/android/keyguard/KeyguardTextBuilder$2;->$SwitchMap$com$android$keyguard$KeyguardSecurityModel$SecurityMode:[I
 
     invoke-virtual {v5}, Ljava/lang/Enum;->ordinal()I
@@ -5770,9 +5751,9 @@
 
     aget v5, v8, v5
 
-    if-eq v5, v3, :cond_f
+    if-eq v5, v3, :cond_10
 
-    if-eq v5, v7, :cond_e
+    if-eq v5, v7, :cond_f
 
     const v5, 0x7f130942
 
@@ -5782,7 +5763,7 @@
 
     goto :goto_4
 
-    :cond_e
+    :cond_f
     const v5, 0x7f130941
 
     invoke-virtual {v4, v5}, Landroid/content/Context;->getString(I)Ljava/lang/String;
@@ -5791,7 +5772,7 @@
 
     goto :goto_4
 
-    :cond_f
+    :cond_10
     const v5, 0x7f130943
 
     invoke-virtual {v4, v5}, Landroid/content/Context;->getString(I)Ljava/lang/String;
@@ -5808,11 +5789,11 @@
 
     goto :goto_6
 
-    :cond_10
+    :cond_11
     move-object v2, v9
 
     :goto_6
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_12
 
     const-wide/16 v10, 0x2710
 
@@ -5830,7 +5811,7 @@
 
     invoke-virtual {v4, v2}, Lcom/samsung/android/aod/AODManager;->requestAODToast(Lcom/samsung/android/aod/AODToast;)V
 
-    :cond_11
+    :cond_12
     :goto_7
     new-instance v2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda16;
 
@@ -5850,18 +5831,18 @@
 
     iget-object v0, v0, Lcom/android/systemui/doze/PluginAODManager;->mAODPlugin:Lcom/android/systemui/plugins/aod/PluginAOD;
 
-    if-eqz v0, :cond_12
+    if-eqz v0, :cond_13
 
     invoke-interface {v0, v10, v11}, Lcom/android/systemui/plugins/aod/PluginAOD;->hideChargingInfoByFinger(J)V
 
-    :cond_12
+    :cond_13
     return-void
 
-    :cond_13
+    :cond_14
     :goto_8
     const-string v0, "handleFingerprintHelp( skip TSP block/unblock )"
 
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 .end method
@@ -6190,32 +6171,21 @@
     invoke-virtual {p0, v3, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
     :cond_9
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_a
-
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz p1, :cond_a
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    invoke-virtual {p1, v0}, Landroid/hardware/fingerprint/FingerprintManager;->semShowBouncerScreen(I)I
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_a
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isKeyguardVisible()Z
 
     move-result p1
 
-    if-nez p1, :cond_b
+    if-nez p1, :cond_a
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-nez p1, :cond_b
+    if-nez p1, :cond_a
 
     invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setUnlockingKeyguard(Z)V
 
-    :cond_b
+    :cond_a
     invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setShortcutLaunchInProgress(Z)V
 
     sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_PRIMARY_BOUNCER_SHOWN:Lcom/android/keyguard/FaceAuthUiEvent;
@@ -6224,7 +6194,7 @@
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_b
 
     sget-object p1, Lcom/android/systemui/util/SystemUIAnalytics;->sCurrentScreenID:Ljava/lang/String;
 
@@ -6234,7 +6204,7 @@
 
     invoke-static {p1, p2, v0}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_c
+    :cond_b
     iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mPluginAODManagerLazy:Ldagger/Lazy;
 
     invoke-interface {p0}, Ldagger/Lazy;->get()Ljava/lang/Object;
@@ -6459,7 +6429,7 @@
     invoke-virtual {v0, v6, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
     :cond_3
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    const/4 v1, 0x0
 
     if-eqz v1, :cond_4
 
@@ -8201,7 +8171,7 @@
     goto/16 :goto_1b
 
     :cond_46
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    const/4 v1, 0x0
 
     if-eqz v1, :cond_47
 
@@ -9268,7 +9238,7 @@
     goto :goto_1b
 
     :cond_67
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    const/4 v1, 0x0
 
     if-eqz v1, :cond_68
 
@@ -9446,39 +9416,101 @@
 .end method
 
 .method public final handleStartedGoingToSleep(I)V
-    .locals 2
+    .locals 5
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
     const/4 v1, 0x0
 
-    if-eqz v0, :cond_0
+    if-eqz v0, :cond_2
 
-    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByForegroundApp:Z
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isEnabledWof()Z
+
+    move-result v0
+
+    if-eqz v0, :cond_2
+
+    sget v0, Lcom/android/systemui/util/DeviceType;->supportSideFingerprintExclusive:I
+
+    const/4 v2, -0x1
+
+    if-ne v0, v2, :cond_0
+
+    sput v1, Lcom/android/systemui/util/DeviceType;->supportSideFingerprintExclusive:I
 
     :cond_0
+    sget v0, Lcom/android/systemui/util/DeviceType;->supportSideFingerprintExclusive:I
+
+    const/4 v2, 0x1
+
+    if-ne v0, v2, :cond_1
+
+    move v0, v2
+
+    goto :goto_0
+
+    :cond_1
+    move v0, v1
+
+    :goto_0
+    if-nez v0, :cond_2
+
+    const/4 v0, 0x2
+
+    if-ne p1, v0, :cond_2
+
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
+
+    invoke-virtual {v0, v3}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
+
+    iput-boolean v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
+
+    const-wide/16 v3, 0x2bc
+
+    invoke-virtual {v0, v2, v3, v4}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+
+    const-string v0, "KeyguardFingerprint"
+
+    const-string v2, "ScreenOff by the powerKey. If it receives a response within 700ms, it will skip."
+
+    invoke-static {v0, v2}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    :cond_2
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
+
+    if-eqz v0, :cond_3
+
+    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByForegroundApp:Z
+
+    :cond_3
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceWidgetFullScreenMode:Z
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_4
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mForceStartFinger:Z
 
     iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
 
-    :cond_1
+    :cond_4
     invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_ESIM:Z
 
-    if-eqz v0, :cond_2
+    if-eqz v0, :cond_5
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->clearESimRemoved()V
 
-    :cond_2
+    :cond_5
     invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setUnlockingKeyguard(Z)V
 
     invoke-super {p0, p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleStartedGoingToSleep(I)V
@@ -9487,17 +9519,40 @@
 .end method
 
 .method public final handleStartedWakingUp(I)V
-    .locals 1
+    .locals 3
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    const/4 v1, 0x0
 
     if-eqz v0, :cond_0
 
-    const/4 v0, 0x0
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
 
-    iput-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
+    if-eqz v0, :cond_0
+
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
+
+    invoke-virtual {v0, v2}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
+
+    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    const-string/jumbo v0, "skip FP response canceled by handleStartedWakingUp : wakeup reason = "
+
+    const-string v2, "KeyguardFingerprint"
+
+    invoke-static {v0, p1, v2}, Landroidx/picker3/widget/SeslColorSpectrumView$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;)V
 
     :cond_0
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
+
+    if-eqz v0, :cond_1
+
+    iput-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
+
+    :cond_1
     invoke-super {p0, p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->handleStartedWakingUp(I)V
 
     return-void
@@ -10783,61 +10838,28 @@
     return v2
 .end method
 
-.method public final isInDisplayFingerprintMarginAccepted()Z
-    .locals 3
+.method public final isInDisplayFingerprintMarginAccepted()V
+    .locals 1
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
 
     move-result v0
 
-    const/4 v1, 0x1
-
     if-nez v0, :cond_0
 
-    invoke-super {p0, v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    :cond_0
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mCurrentSecurityMode:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
-
-    sget-object v2, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Swipe:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
-
-    if-eq v0, v2, :cond_1
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFullscreenBouncer()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mContext:Landroid/content/Context;
+    const/4 v0, 0x1
 
-    invoke-static {p0}, Lcom/android/systemui/util/DeviceState;->isSmartViewDisplayWithFitToAspectRatio(Landroid/content/Context;)Z
+    invoke-super {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Z)Z
 
     move-result p0
 
-    if-nez p0, :cond_1
+    if-eqz p0, :cond_1
 
-    goto :goto_0
+    :cond_0
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_1
-    const/4 v1, 0x0
-
-    :goto_0
-    return v1
+    return-void
 .end method
 
 .method public final isKeyguardUnlocking()Z
@@ -11609,17 +11631,13 @@
     invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFaceAuthenticated(Z)V
 
     :cond_1
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_3
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz p1, :cond_3
+    return-void
+.end method
 
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserFingerprintAuthenticated:Landroid/util/SparseArray;
+.method public final onLockIconPressed()V
+    .locals 3
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
 
@@ -11629,59 +11647,19 @@
 
     move-result v0
 
-    invoke-virtual {p1, v0}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserFaceAuthenticated:Landroid/util/SparseArray;
 
-    move-result-object p1
+    const/4 v2, 0x0
 
-    check-cast p1, Lcom/android/keyguard/KeyguardUpdateMonitor$BiometricAuthenticated;
+    invoke-virtual {v1, v0, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
 
-    const/4 v0, 0x1
+    sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_LOCK_ICON_PRESSED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    if-eqz p1, :cond_2
+    const/4 v2, 0x2
 
-    iget-boolean p1, p1, Lcom/android/keyguard/KeyguardUpdateMonitor$BiometricAuthenticated;->mIsStrongBiometric:Z
+    invoke-virtual {p0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    if-eqz p1, :cond_2
-
-    move v1, v0
-
-    :cond_2
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result p1
-
-    xor-int/2addr p1, v0
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setFodStrictMode(Z)V
-
-    :cond_3
-    return-void
-.end method
-
-.method public final onLockIconPressed()V
-    .locals 3
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
-
-    check-cast v0, Lcom/android/systemui/settings/UserTrackerImpl;
-
-    invoke-virtual {v0}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
-
-    move-result v0
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserFaceAuthenticated:Landroid/util/SparseArray;
-
-    const/4 v2, 0x0
-
-    invoke-virtual {v1, v0, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
-
-    sget-object v1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_LOCK_ICON_PRESSED:Lcom/android/keyguard/FaceAuthUiEvent;
-
-    const/4 v2, 0x2
-
-    invoke-virtual {p0, v2, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mStrongAuthTracker:Lcom/android/keyguard/KeyguardUpdateMonitor$StrongAuthTracker;
+    iget-object p0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mStrongAuthTracker:Lcom/android/keyguard/KeyguardUpdateMonitor$StrongAuthTracker;
 
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor$StrongAuthTracker;->onStrongAuthRequiredChanged(I)V
 
@@ -12250,11 +12228,26 @@
 .method public final sendFingerprintSALog(Ljava/lang/String;)V
     .locals 1
 
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v0, :cond_0
+
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    if-eqz v0, :cond_0
+
+    const-string p0, "KeyguardFingerprint"
+
+    const-string p1, "Skip FP response logging"
+
+    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
+    return-void
+
+    :cond_0
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
 
-    if-nez v0, :cond_0
+    if-nez v0, :cond_1
 
     const-string p0, "301"
 
@@ -12262,10 +12255,10 @@
 
     goto :goto_0
 
-    :cond_0
+    :cond_1
     iget-boolean p0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz p0, :cond_1
+    if-eqz p0, :cond_2
 
     const-string p0, "102"
 
@@ -12273,7 +12266,7 @@
 
     goto :goto_0
 
-    :cond_1
+    :cond_2
     const-string p0, "101"
 
     const-string v0, "1096"
@@ -12313,25 +12306,8 @@
 
     invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_0
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
-
-    if-nez v0, :cond_0
-
-    if-eqz p1, :cond_0
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    const-wide/16 v2, 0x1f4
-
-    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_0
     iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mBackgroundExecutor:Ljava/util/concurrent/Executor;
 
     new-instance v7, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda12;
@@ -12652,8 +12628,6 @@
 
     const-string v1, "KeyguardUpdateMonitor"
 
-    const/4 v2, 0x1
-
     if-eqz p2, :cond_2
 
     iget-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
@@ -12667,7 +12641,9 @@
     return-void
 
     :cond_0
-    iput-boolean v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
+    const/4 p2, 0x1
+
+    iput-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
 
     :cond_1
     iput p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFocusWindow:I
@@ -12677,7 +12653,7 @@
     :cond_2
     iget-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_6
 
     iget p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFocusWindow:I
 
@@ -12721,7 +12697,7 @@
 
     iget-boolean p1, p1, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     :cond_4
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isKeyguardVisible()Z
@@ -12732,33 +12708,14 @@
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-eqz p1, :cond_7
-
-    :cond_5
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_6
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
     if-eqz p1, :cond_6
 
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    new-instance p2, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    invoke-direct {p2, p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;I)V
-
-    invoke-virtual {p1, p2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :cond_6
+    :cond_5
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_6
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
@@ -12770,112 +12727,7 @@
 
     invoke-virtual {p1, p2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_7
-    return-void
-.end method
-
-.method public final setFodStrictMode(Z)V
-    .locals 4
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_2
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFODStrictMode:Z
-
-    if-eq v0, p1, :cond_2
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mStrongAuthTracker:Lcom/android/keyguard/KeyguardUpdateMonitor$StrongAuthTracker;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
-
-    check-cast v1, Lcom/android/systemui/settings/UserTrackerImpl;
-
-    invoke-virtual {v1}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
-
-    move-result v1
-
-    invoke-virtual {v0, v1}, Lcom/android/internal/widget/LockPatternUtils$StrongAuthTracker;->getStrongAuthForUser(I)I
-
-    move-result v0
-
-    if-eqz p1, :cond_0
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFingerPrintBadQualityCounts:Landroid/util/SparseIntArray;
-
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
-
-    check-cast v2, Lcom/android/systemui/settings/UserTrackerImpl;
-
-    invoke-virtual {v2}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    invoke-virtual {v1, v2, v3}, Landroid/util/SparseIntArray;->get(II)I
-
-    move-result v1
-
-    const/16 v2, 0x1e
-
-    if-ge v1, v2, :cond_0
-
-    if-eqz v0, :cond_1
-
-    :cond_0
-    const/4 v3, 0x1
-
-    :cond_1
-    if-eqz v3, :cond_2
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v2, "setFodStrictMode : "
-
-    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v2, " strongAuth : "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v0, " callStack : "
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const/16 v0, 0xf
-
-    invoke-static {v0}, Landroid/os/Debug;->getCallers(I)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    sget-object v1, Lcom/android/systemui/log/LogLevel;->DEBUG:Lcom/android/systemui/log/LogLevel;
-
-    const/4 v2, 0x0
-
-    const-string v3, "KeyguardFingerprint"
-
-    invoke-static {v3, v1, v0, v2}, Lcom/android/systemui/keyguard/KeyguardDumpLog;->log(Ljava/lang/String;Lcom/android/systemui/log/LogLevel;Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFODStrictMode:Z
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz p0, :cond_2
-
-    invoke-virtual {p0, p1}, Landroid/hardware/fingerprint/FingerprintManager;->semSetFodStrictMode(Z)V
-
-    :cond_2
+    :cond_6
     return-void
 .end method
 
@@ -13003,7 +12855,7 @@
 .end method
 
 .method public final setKeyguardShowing(ZZ)V
-    .locals 5
+    .locals 4
 
     iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
 
@@ -13038,23 +12890,8 @@
     return-void
 
     :cond_2
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_3
-
-    if-nez v3, :cond_3
-
-    if-eqz p1, :cond_3
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
-
-    const-wide/16 v3, 0x1f4
-
-    invoke-virtual {v0, v1, v3, v4}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_3
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isKeyguardVisible()Z
 
     move-result v0
@@ -13073,20 +12910,20 @@
 
     sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
 
-    if-eqz p1, :cond_4
+    if-eqz p1, :cond_3
 
-    if-nez p2, :cond_4
+    if-nez p2, :cond_3
 
     iput-boolean v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByForegroundApp:Z
 
-    :cond_4
-    if-eq v1, v0, :cond_6
+    :cond_3
+    if-eq v1, v0, :cond_5
 
-    if-eqz v1, :cond_5
+    if-eqz v1, :cond_4
 
     iput-boolean v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mSecureCameraLaunched:Z
 
-    :cond_5
+    :cond_4
     new-instance p1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda9;
 
     invoke-direct {p1, v1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda9;-><init>(ZI)V
@@ -13095,35 +12932,35 @@
 
     invoke-virtual {p0, p2, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->dispatchCallback(Ljava/lang/String;Ljava/util/function/Consumer;)V
 
-    :cond_6
-    if-nez v1, :cond_7
+    :cond_5
+    if-nez v1, :cond_6
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    if-nez p1, :cond_7
+    if-nez p1, :cond_6
 
     invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->setUnlockingKeyguard(Z)V
 
-    :cond_7
+    :cond_6
     const/4 p1, 0x2
 
     invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
 
     iget-boolean p2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardUnlocking:Z
 
-    if-nez p2, :cond_8
+    if-nez p2, :cond_7
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockCompleted()Z
 
     move-result p2
 
-    if-eqz p2, :cond_8
+    if-eqz p2, :cond_7
 
     sget-object p2, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_KEYGUARD_VISIBILITY_CHANGED:Lcom/android/keyguard/FaceAuthUiEvent;
 
     invoke-virtual {p0, p1, p2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    :cond_8
+    :cond_7
     return-void
 .end method
 
@@ -13240,97 +13077,75 @@
 .end method
 
 .method public final setPanelExpandingStarted(Z)V
-    .locals 5
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    .locals 1
 
-    if-eqz v0, :cond_0
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
 
     move-result v0
 
     if-eqz v0, :cond_0
 
-    move v0, p1
+    if-nez p1, :cond_0
 
-    goto :goto_0
+    sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_QS_FULLY_EXPANDED:Lcom/android/keyguard/FaceAuthUiEvent;
 
-    :cond_0
-    const/4 v0, 0x0
+    const/4 v0, 0x2
 
-    :goto_0
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFaceOptionEnabled()Z
+    invoke-virtual {p0, v0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
 
-    move-result v1
+    :cond_0
+    return-void
+.end method
 
-    const/4 v2, 0x2
+.method public final setShortcutLaunchInProgress(Z)V
+    .locals 4
 
-    if-eqz v1, :cond_1
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
-    if-nez p1, :cond_1
+    if-eq v0, p1, :cond_0
 
-    sget-object p1, Lcom/android/keyguard/FaceAuthUiEvent;->FACE_AUTH_UPDATED_QS_FULLY_EXPANDED:Lcom/android/keyguard/FaceAuthUiEvent;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    invoke-virtual {p0, v2, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFaceListeningState(ILcom/android/keyguard/FaceAuthUiEvent;)V
+    const-string/jumbo v1, "setShortcutLaunchInProgress() mIsShortcutLaunchInProgress = "
 
-    :cond_1
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
+    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    if-eq p1, v0, :cond_2
+    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "setPanelExpandingStarted() mIsPanelExpandingStarted = "
-
-    invoke-direct {p1, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
-    const-string v3, " -> "
+    const-string v2, " -> "
 
-    const-string v4, "KeyguardUpdateMonitor"
+    const-string v3, "KeyguardUpdateMonitor"
 
-    invoke-static {p1, v1, v3, v0, v4}, Lcom/android/keyguard/KeyguardCarrierViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v0, v1, v2, p1, v3}, Lcom/android/keyguard/KeyguardCarrierViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
-    iput-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
+    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
 
-    invoke-virtual {p0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_2
+    :cond_0
     return-void
 .end method
 
-.method public final setShortcutLaunchInProgress(Z)V
-    .locals 4
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
-
-    if-eq v0, p1, :cond_0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v1, "setShortcutLaunchInProgress() mIsShortcutLaunchInProgress = "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
+.method public final setShowingKeepScreenOnPopup(Z)V
+    .locals 3
 
-    const-string v2, " -> "
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
 
-    const-string v3, "KeyguardUpdateMonitor"
+    move-result v0
 
-    invoke-static {v0, v1, v2, p1, v3}, Lcom/android/keyguard/KeyguardCarrierViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    if-eqz v0, :cond_0
 
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
+    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    new-instance v1, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda11;
 
-    if-eqz p1, :cond_0
+    const/4 v2, 0x1
 
-    const/4 p1, 0x2
+    invoke-direct {v1, p0, p1, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda11;-><init>(Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;ZI)V
 
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
+    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
     :cond_0
     return-void
@@ -13447,38 +13262,17 @@
 
     invoke-virtual {v0, v1, v2}, Lcom/android/systemui/util/SettingsHelper;->registerCallback(Lcom/android/systemui/util/SettingsHelper$OnChangedCallback;[Landroid/net/Uri;)V
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    iget-object v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mOneHandModeSettingsCallback:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda13;
-
-    const-string v2, "any_screen_running"
-
-    invoke-static {v2}, Landroid/provider/Settings$System;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;
-
-    move-result-object v2
-
-    filled-new-array {v2}, [Landroid/net/Uri;
-
-    move-result-object v2
-
-    invoke-virtual {v0, v1, v2}, Lcom/android/systemui/util/SettingsHelper;->registerCallback(Lcom/android/systemui/util/SettingsHelper$OnChangedCallback;[Landroid/net/Uri;)V
-
-    :cond_0
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     const-class v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
     invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
@@ -13522,13 +13316,13 @@
 
     move-result-object v1
 
-    if-nez v1, :cond_2
+    if-nez v1, :cond_1
 
     const/4 v0, 0x0
 
     goto :goto_1
 
-    :cond_2
+    :cond_1
     new-instance v2, Landroid/content/ComponentName;
 
     iget-object v1, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
@@ -14139,7 +13933,7 @@
 .end method
 
 .method public final shouldListenForFingerprint(Z)Z
-    .locals 13
+    .locals 11
 
     iget-object p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
 
@@ -14161,7 +13955,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_29
+    if-eqz v2, :cond_16
 
     iget-boolean v2, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
 
@@ -14345,91 +14139,91 @@
 
     invoke-static {v7, v0, v9, v6, v10}, Lcom/android/keyguard/KeyguardKnoxGuardViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;ZLjava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v9, " , mPrimaryBouncerIsOrWillBeShowing = "
+    const-string v7, " , mPrimaryBouncerIsOrWillBeShowing = "
 
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-boolean v9, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerIsOrWillBeShowing:Z
+    iget-boolean v7, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerIsOrWillBeShowing:Z
 
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v9, " , mPrimaryBouncerFullyShown = "
+    const-string v7, " , mPrimaryBouncerFullyShown = "
 
-    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-boolean v9, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
+    iget-boolean v7, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
 
-    const-string v10, " , mGoingToSleep = "
+    const-string v9, " , mGoingToSleep = "
 
-    const-string v11, " , mSwitchingUser = "
+    const-string v10, " , mSwitchingUser = "
 
-    invoke-static {v7, v9, v10, v5, v11}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v6, v7, v9, v5, v10}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mIsDreamingForBiometrics = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mKeyguardUnlocking = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mKeyguardUnlocking:Z
 
-    const-string v9, " , mKeyguardGoingAway = "
+    const-string v5, " , mKeyguardGoingAway = "
 
-    const-string v10, " , mKeyguardShowing = "
+    const-string v7, " , mKeyguardShowing = "
 
-    invoke-static {v7, v3, v9, v4, v10}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v6, v3, v5, v4, v7}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mKeyguardOccluded = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mSystemReady = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSystemReady:Z
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
     const-string v3, " , mHasFocus = "
 
-    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
 
     const-string v4, "KeyguardFingerprint"
 
-    invoke-static {v7, v3, v4}, Landroidx/appcompat/widget/ActionBarContextView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;)V
+    invoke-static {v6, v3, v4}, Landroidx/appcompat/widget/ActionBarContextView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;)V
 
-    if-eqz v0, :cond_29
+    if-eqz v0, :cond_16
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getLockoutBiometricAttemptDeadline()J
 
-    move-result-wide v9
+    move-result-wide v5
 
-    const-wide/16 v11, 0x0
+    const-wide/16 v9, 0x0
 
-    cmp-long v0, v9, v11
+    cmp-long v0, v5, v9
 
     if-lez v0, :cond_7
 
@@ -14442,9 +14236,9 @@
     :cond_7
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getLockoutAttemptDeadline()J
 
-    move-result-wide v9
+    move-result-wide v5
 
-    cmp-long v0, v9, v11
+    cmp-long v0, v5, v9
 
     if-lez v0, :cond_8
 
@@ -14467,653 +14261,222 @@
 
     return v1
 
-    :cond_9
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isForcedLock()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_a
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because lock to force a lockscreen )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_a
-    sget-boolean v0, Lcom/android/systemui/LsRune;->COVER_SUPPORTED:Z
-
-    if-eqz v0, :cond_b
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isCoverClosed()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_b
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false as cover is closed. )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_b
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isEnabledWof()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_d
-
-    if-eqz v2, :cond_c
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
-
-    if-eqz v0, :cond_d
-
-    :cond_c
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintDisabledWithBadQuality()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_d
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( bad quality count is maximum. )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_d
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_e
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isAuthenticatedWithBiometric(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_e
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, authenticated with biometric)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_e
-    const-class v0, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v3}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDeviceDisabledForMaxFailedAttempt()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_f
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, device is locked by administrator )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_f
-    const-class v3, Lcom/android/systemui/statusbar/policy/SecurityController;
-
-    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    if-nez v3, :cond_10
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, dependency class destroy)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_10
-    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
-
-    if-eqz v3, :cond_11
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mForceStartFinger:Z
-
-    if-nez v3, :cond_11
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
-
-    if-nez v3, :cond_11
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
-
-    if-nez v3, :cond_11
-
-    const-class v3, Lcom/android/systemui/keyguard/DisplayLifecycle;
-
-    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/keyguard/DisplayLifecycle;
-
-    iget-boolean v3, v3, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
-
-    if-nez v3, :cond_11
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, folder is closed )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_11
-    iget-object v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-virtual {v3}, Lcom/android/systemui/util/SettingsHelper;->isScreenOffMemoEnabled()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_12
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsRunningBlackMemo:Z
-
-    if-eqz v3, :cond_12
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because Screen off Memo is running. )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_12
-    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v3
-
-    if-nez v3, :cond_13
-
-    if-eqz v2, :cond_13
-
-    iget-boolean v3, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
-
-    if-eqz v3, :cond_13
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, strong auth with occluded )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_13
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v3, p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDualDarDeviceOwner(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v3, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v3, p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDualDarInnerAuthRequired(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_14
-
-    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/systemui/knox/KnoxStateMonitor;
-
-    check-cast v0, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
-
-    invoke-virtual {v0}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->getDualDarInnerLockoutAttemptDeadline()J
-
-    move-result-wide v9
-
-    cmp-long v0, v9, v11
-
-    if-lez v0, :cond_14
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because of lockoutAttemptDeadline of dualdar do inner user )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_14
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByProximity:Z
-
-    if-eqz v0, :cond_15
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, screen off by proximity)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_15
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_28
-
-    sget-object v0, Lcom/android/systemui/noticenter/NotiCenterPlugin;->INSTANCE:Lcom/android/systemui/noticenter/NotiCenterPlugin;
-
-    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    invoke-static {}, Lcom/android/systemui/noticenter/NotiCenterPlugin;->isNotiCenterPluginConnected()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_16
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsNotiStarShown:Z
-
-    if-eqz v0, :cond_16
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    if-nez v0, :cond_16
-
-    if-eqz v2, :cond_16
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, NotiStar is shown )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_16
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    if-nez v0, :cond_17
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsQsFullyExpanded:Z
-
-    if-nez v0, :cond_18
-
-    :cond_17
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceWidgetFullScreenMode:Z
-
-    if-eqz v0, :cond_19
-
-    :cond_18
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    const-string/jumbo v0, "shouldListenForFingerprint ( return false, because mIsQsFullyExpanded = "
-
-    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsQsFullyExpanded:Z
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string v0, ", or mIsFaceWidgetFullScreen="
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-boolean p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFaceWidgetFullScreenMode:Z
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    const-string p0, " )"
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_19
-    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1a
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, strong auth with in-display fingerprint)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1a
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShortcutLaunchInProgress:Z
-
-    if-eqz v0, :cond_1b
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, shortcut preview is showing )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1b
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    if-nez v0, :cond_1c
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsPanelExpandingStarted:Z
-
-    if-eqz v0, :cond_1c
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, quick panel is showing )"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1c
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-virtual {v0}, Lcom/android/systemui/util/SettingsHelper;->isOneHandModeRunning()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1d
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, one hand mode is running)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1d
-    iget v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mCocktailBarWindowType:I
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_1e
-
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, the cocktail bar is expanded)"
-
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :cond_1e
-    if-eqz v2, :cond_1f
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
-
-    if-nez v0, :cond_1f
-
-    if-eqz v6, :cond_1f
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserHasTrust(I)Z
+    :cond_9
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isForcedLock()Z
 
     move-result v0
 
-    if-eqz v0, :cond_1f
+    if-eqz v0, :cond_a
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, getUserHasTrust() is true)"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because lock to force a lockscreen )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_1f
-    invoke-static {}, Landroid/os/Process;->myUserHandle()Landroid/os/UserHandle;
+    :cond_a
+    sget-boolean v0, Lcom/android/systemui/LsRune;->COVER_SUPPORTED:Z
 
-    move-result-object v0
+    if-eqz v0, :cond_b
 
-    invoke-virtual {v0}, Landroid/os/UserHandle;->getIdentifier()I
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isCoverClosed()Z
 
     move-result v0
 
-    if-eqz v0, :cond_20
+    if-eqz v0, :cond_b
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, this process is for the sub-user)"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false as cover is closed. )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_20
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
-
-    const-string v3, "KeyguardUpdateMonitor"
-
-    if-nez v0, :cond_21
+    :cond_b
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isEnabledWof()Z
 
-    iget-boolean v6, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDynamicLockViewMode:Z
+    move-result v0
 
-    if-eqz v6, :cond_21
+    if-eqz v0, :cond_d
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, DynamicLockViewMode"
+    if-eqz v2, :cond_c
 
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
 
-    return v1
+    if-eqz v0, :cond_d
 
-    :cond_21
-    if-eqz v0, :cond_22
+    :cond_c
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintDisabledWithBadQuality()Z
 
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSIPShown:Z
+    move-result v0
 
-    if-eqz v0, :cond_22
+    if-eqz v0, :cond_d
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, SIP is showing )"
+    const-string/jumbo p0, "shouldListenForFingerprint ( bad quality count is maximum. )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_22
-    if-eqz v2, :cond_23
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardShowing:Z
-
-    if-eqz v0, :cond_23
+    :cond_d
+    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->is2StepVerification()Z
 
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mHasFocus:Z
+    move-result v0
 
-    if-nez v0, :cond_23
+    if-eqz v0, :cond_e
 
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isAuthenticatedWithBiometric(I)Z
 
-    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWaitingFocusRunnable:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticLambda7;
+    move-result p1
 
-    invoke-virtual {v0, v2}, Landroid/os/Handler;->hasCallbacks(Ljava/lang/Runnable;)Z
+    if-eqz p1, :cond_e
 
-    move-result v0
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, authenticated with biometric)"
 
-    if-nez v0, :cond_23
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-nez v5, :cond_23
+    return v1
 
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mDesktopManagerLazy:Ldagger/Lazy;
+    :cond_e
+    const-class p1, Lcom/android/systemui/knox/KnoxStateMonitor;
 
-    invoke-interface {v0}, Ldagger/Lazy;->get()Ljava/lang/Object;
+    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object p1
 
-    check-cast v0, Lcom/android/systemui/util/DesktopManager;
+    check-cast p1, Lcom/android/systemui/knox/KnoxStateMonitor;
 
-    check-cast v0, Lcom/android/systemui/util/DesktopManagerImpl;
+    check-cast p1, Lcom/android/systemui/knox/KnoxStateMonitorImpl;
 
-    invoke-virtual {v0}, Lcom/android/systemui/util/DesktopManagerImpl;->isDualView()Z
+    invoke-virtual {p1}, Lcom/android/systemui/knox/KnoxStateMonitorImpl;->isDeviceDisabledForMaxFailedAttempt()Z
 
-    move-result v0
+    move-result p1
 
-    if-nez v0, :cond_23
+    if-eqz p1, :cond_f
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Not focus on NotificationShade )"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, device is locked by administrator )"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_23
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getFaceAuthenticated(I)Z
+    :cond_f
+    const-class p1, Lcom/android/systemui/statusbar/policy/SecurityController;
 
-    move-result p1
+    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    if-eqz p1, :cond_24
+    move-result-object p1
+
+    if-nez p1, :cond_10
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Face authenticated)"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, dependency class destroy)"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_24
-    iget-object p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mDesktopManagerLazy:Ldagger/Lazy;
-
-    invoke-interface {p1}, Ldagger/Lazy;->get()Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/systemui/util/DesktopManager;
-
-    check-cast p1, Lcom/android/systemui/util/DesktopManagerImpl;
+    :cond_10
+    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_COVER:Z
 
-    invoke-virtual {p1}, Lcom/android/systemui/util/DesktopManagerImpl;->isDualView()Z
+    if-eqz p1, :cond_11
 
-    move-result p1
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mForceStartFinger:Z
 
-    if-eqz p1, :cond_27
+    if-nez p1, :cond_11
 
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mPrimaryBouncerFullyShown:Z
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubBioAuth:Z
 
-    if-eqz p1, :cond_25
+    if-nez p1, :cond_11
 
-    goto :goto_5
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mNeedSubWofFpAuth:Z
 
-    :cond_25
-    :try_start_0
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mWindowManagerService:Landroid/view/IWindowManager;
+    if-nez p1, :cond_11
 
-    invoke-interface {p0}, Landroid/view/IWindowManager;->getVisibleWindowInfoList()Ljava/util/List;
+    const-class p1, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    move-result-object p0
+    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    invoke-interface {p0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
+    move-result-object p1
 
-    move-result-object p0
+    check-cast p1, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
-    :cond_26
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
+    iget-boolean p1, p1, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    move-result p1
+    if-nez p1, :cond_11
 
-    if-eqz p1, :cond_27
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, folder is closed )"
 
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result-object p1
+    return v1
 
-    check-cast p1, Lcom/samsung/android/view/SemWindowManager$VisibleWindowInfo;
+    :cond_11
+    iget-object p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSettingsHelper:Lcom/android/systemui/util/SettingsHelper;
 
-    iget v0, p1, Lcom/samsung/android/view/SemWindowManager$VisibleWindowInfo;->type:I
+    invoke-virtual {p1}, Lcom/android/systemui/util/SettingsHelper;->isScreenOffMemoEnabled()Z
 
-    const/16 v2, 0x7d9
+    move-result p1
 
-    if-ne v0, v2, :cond_26
+    if-eqz p1, :cond_12
 
-    new-instance p0, Ljava/lang/StringBuilder;
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsRunningBlackMemo:Z
 
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
+    if-eqz p1, :cond_12
 
-    const-string v0, "hasPopupOnDualView "
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because Screen off Memo is running. )"
 
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object p1, p1, Lcom/samsung/android/view/SemWindowManager$VisibleWindowInfo;->name:Ljava/lang/String;
+    return v1
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    :cond_12
+    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    const-string p1, " is showing"
+    if-eqz p1, :cond_13
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsShowingKeepScreenOnPopup:Z
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    if-eqz p1, :cond_13
 
-    move-result-object p0
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, because keep screen on popup is showing. )"
 
-    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1
-    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_0
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move p0, v8
+    return v1
 
-    goto :goto_6
+    :cond_13
+    invoke-virtual {p0, v8}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isUnlockingWithBiometricAllowed(Z)Z
 
-    :catch_0
-    move-exception p0
+    move-result p1
 
-    invoke-virtual {p0}, Ljava/lang/NullPointerException;->toString()Ljava/lang/String;
+    if-nez p1, :cond_14
 
-    move-result-object p0
+    if-eqz v2, :cond_14
 
-    invoke-static {v3, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mKeyguardOccluded:Z
 
-    goto :goto_5
+    if-eqz p1, :cond_14
 
-    :catch_1
-    move-exception p0
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, strong auth with occluded )"
 
-    const-string p1, "Fail to check windows by RemoteException"
+    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v3, p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    return v1
 
-    :cond_27
-    :goto_5
-    move p0, v1
+    :cond_14
+    iget-boolean p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsFPCanceledByProximity:Z
 
-    :goto_6
-    if-eqz p0, :cond_28
+    if-eqz p0, :cond_15
 
-    const-string/jumbo p0, "shouldListenForFingerprint ( return false, Popup showing on Dex dual view )"
+    const-string/jumbo p0, "shouldListenForFingerprint ( return false, screen off by proximity)"
 
     invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return v1
 
-    :cond_28
+    :cond_15
     return v8
 
-    :cond_29
+    :cond_16
     return v1
 .end method
 
@@ -15617,7 +14980,7 @@
 .end method
 
 .method public final stopListeningForFingerprint()V
-    .locals 2
+    .locals 3
 
     const-string v0, "KeyguardUpdateMonitor"
 
@@ -15640,8 +15003,29 @@
 
     invoke-virtual {p0, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->setFingerprintRunningState(I)V
 
-    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v1, :cond_1
+
+    iget-boolean v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    if-eqz v1, :cond_1
+
+    iget-object v1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
+
+    iget-object v2, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mTimeoutSkipFPResponse:Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$1;
+
+    invoke-virtual {v1, v2}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V
+
+    iput-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsSkipFPResponse:Z
+
+    const-string p0, "KeyguardFingerprint"
 
+    const-string/jumbo v0, "skip FP response canceled by stopListeningForFingerprint"
+
+    invoke-static {p0, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
+
+    :cond_1
     return-void
 .end method
 
@@ -16410,7 +15794,7 @@
 .end method
 
 .method public final updateFingerprintListeningState(I)V
-    .locals 6
+    .locals 5
 
     iget-object v0, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mHandler:Lcom/android/keyguard/KeyguardUpdateMonitor$15;
 
@@ -16435,67 +15819,59 @@
 
     const/4 v3, 0x1
 
-    if-eq v2, v3, :cond_2
+    if-eq v2, v3, :cond_1
 
     const/4 v4, 0x3
 
-    if-ne v2, v4, :cond_1
-
-    goto :goto_0
+    if-ne v2, v4, :cond_2
 
     :cond_1
-    move v2, v0
-
-    goto :goto_1
+    move v0, v3
 
     :cond_2
-    :goto_0
-    move v2, v3
-
-    :goto_1
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    const-string/jumbo v5, "updateFingerprintListeningState#mFingerprintRunningState="
+    const-string/jumbo v4, "updateFingerprintListeningState#mFingerprintRunningState="
 
-    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {v2, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    iget v5, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mFingerprintRunningState:I
+    iget v4, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mFingerprintRunningState:I
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v5, " shouldListenForFingerprint="
+    const-string v4, " shouldListenForFingerprint="
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
-    const-string v5, " isUdfpsEnrolled=false bioType : "
+    const-string v4, " isUdfpsEnrolled=false bioType : "
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v5, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
+    iget-object v4, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mUserTracker:Lcom/android/systemui/settings/UserTracker;
 
-    check-cast v5, Lcom/android/systemui/settings/UserTrackerImpl;
+    check-cast v4, Lcom/android/systemui/settings/UserTrackerImpl;
 
-    invoke-virtual {v5}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
+    invoke-virtual {v4}, Lcom/android/systemui/settings/UserTrackerImpl;->getUserId()I
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {p0, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getBiometricType(I)I
+    invoke-virtual {p0, v4}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->getBiometricType(I)I
 
-    move-result v5
+    move-result v4
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v4
+    move-result-object v2
 
-    const-string v5, "KeyguardFingerprint"
+    const-string v4, "KeyguardFingerprint"
 
-    invoke-static {v5, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v4, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v2, :cond_4
+    if-eqz v0, :cond_4
 
     if-nez v1, :cond_4
 
@@ -16512,10 +15888,10 @@
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->stopListeningForFingerprint()V
 
-    goto :goto_2
+    goto :goto_0
 
     :cond_4
-    if-nez v2, :cond_6
+    if-nez v0, :cond_6
 
     if-eqz v1, :cond_6
 
@@ -16528,71 +15904,19 @@
 
     invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->startListeningForFingerprint()V
 
-    goto :goto_2
+    goto :goto_0
 
     :cond_6
-    if-nez v2, :cond_7
+    if-nez v0, :cond_7
 
     if-nez v1, :cond_7
 
-    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_7
-    :goto_2
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_a
-
-    if-nez v1, :cond_8
-
-    goto :goto_3
-
-    :cond_8
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mDeviceInteractive:Z
-
-    if-eqz p1, :cond_9
-
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardUpdateMonitor;->mGoingToSleep:Z
-
-    if-nez p1, :cond_9
-
-    iget-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mIsDreamingForBiometrics:Z
-
-    if-nez p1, :cond_9
-
-    move v0, v3
-
-    :cond_9
-    xor-int/lit8 p1, v0, 0x1
-
-    iget v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
-    if-eq v0, p1, :cond_a
-
-    iget-object v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz v0, :cond_a
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    const-string v1, "mFpInDisplayState is changed : "
-
-    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
-
-    iget v1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
-    const-string v2, " -> "
-
-    invoke-static {v0, v1, v2, p1, v5}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;ILjava/lang/String;)V
-
-    iput p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpInDisplayState:I
-
-    iget-object p0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mFpm:Landroid/hardware/fingerprint/FingerprintManager;
-
-    invoke-virtual {p0, p1}, Landroid/hardware/fingerprint/FingerprintManager;->semSetScreenStatus(I)I
+    :goto_0
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_a
-    :goto_3
     return-void
 .end method
 
@@ -16913,35 +16237,6 @@
     return-void
 .end method
 
-.method public final updateSIPShownState(Z)V
-    .locals 2
-
-    iget-boolean v0, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSIPShown:Z
-
-    if-eq v0, p1, :cond_0
-
-    const-string/jumbo v0, "updateSIPShownState : "
-
-    const-string v1, "KeyguardUpdateMonitor"
-
-    invoke-static {v0, p1, v1}, Lcom/android/keyguard/KeyguardCarrierPasswordViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;)V
-
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->mSIPShown:Z
-
-    invoke-virtual {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->isFingerprintOptionEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const/4 p1, 0x2
-
-    invoke-virtual {p0, p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitorImpl;->updateFingerprintListeningState(I)V
-
-    :cond_0
-    return-void
-.end method
-
 .method public final updateSecureLockTimeout(I)Z
     .locals 7
 
diff --git a/smali/com/android/keyguard/KeyguardTextBuilder.smali b/smali/com/android/keyguard/KeyguardTextBuilder.smali
index e9322d54..6ea271df 100644
--- a/smali/com/android/keyguard/KeyguardTextBuilder.smali
+++ b/smali/com/android/keyguard/KeyguardTextBuilder.smali
@@ -519,7 +519,7 @@
 
     move-result-object p1
 
-    goto/16 :goto_6
+    goto :goto_6
 
     :cond_c
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->ShutDown:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
@@ -580,9 +580,7 @@
     goto :goto_8
 
     :cond_e
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez p1, :cond_f
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
@@ -1320,7 +1318,7 @@
     :goto_3
     iput-boolean v2, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-nez p1, :cond_d
+    if-nez p1, :cond_b
 
     if-eqz v6, :cond_4
 
@@ -1340,98 +1338,64 @@
     :goto_4
     iput-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v2, :cond_6
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz p1, :cond_5
-
-    invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_5
-
-    move p1, v4
-
-    goto :goto_5
-
-    :cond_5
-    move p1, v3
-
-    :goto_5
-    iput-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
-
-    :cond_6
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->is2StepVerification()Z
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_5
 
     invoke-virtual {v1, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserUnlockedWithBiometric(I)Z
 
     move-result p1
 
-    if-eqz p1, :cond_7
+    if-eqz p1, :cond_5
 
     iput-boolean v3, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
-    :cond_7
+    :cond_5
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isCameraDisabledByPolicy()Z
 
     move-result p1
 
-    if-nez p1, :cond_b
+    if-nez p1, :cond_9
 
     invoke-virtual {v1, v0}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDisabled(I)Z
 
     move-result p1
 
-    if-eqz p1, :cond_8
+    if-eqz p1, :cond_6
 
     goto :goto_6
 
-    :cond_8
+    :cond_6
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-nez p1, :cond_9
-
-    if-eqz v2, :cond_a
-
-    const-class p1, Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p1
+    if-nez p1, :cond_7
 
-    check-cast p1, Lcom/android/systemui/util/SettingsHelper;
-
-    invoke-virtual {p1}, Lcom/android/systemui/util/SettingsHelper;->isOneHandModeRunning()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_a
+    goto :goto_5
 
-    :cond_9
+    :cond_7
     invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFaceDetectionRunning()Z
 
     move-result p1
 
-    if-eqz p1, :cond_a
+    if-eqz p1, :cond_8
 
     move v3, v4
 
-    :cond_a
+    :cond_8
+    :goto_5
     iput-boolean v3, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
     goto :goto_7
 
-    :cond_b
+    :cond_9
     :goto_6
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_a
 
     invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->getFaceStrongBiometric()Z
 
@@ -1441,24 +1405,24 @@
 
     move-result p1
 
-    if-eqz p1, :cond_c
+    if-eqz p1, :cond_a
 
     move v3, v4
 
-    :cond_c
+    :cond_a
     iput-boolean v3, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    :cond_d
+    :cond_b
     :goto_7
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFingerprint:Z
 
     const-string v0, "none"
 
-    if-eqz p1, :cond_e
+    if-eqz p1, :cond_c
 
     iget-boolean v2, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-eqz v2, :cond_e
+    if-eqz v2, :cond_c
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$Biometric;->MultiBiometrics:Lcom/android/keyguard/KeyguardTextBuilder$Biometric;
 
@@ -1470,8 +1434,8 @@
 
     goto :goto_8
 
-    :cond_e
-    if-eqz p1, :cond_f
+    :cond_c
+    if-eqz p1, :cond_d
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$Biometric;->Fingerprint:Lcom/android/keyguard/KeyguardTextBuilder$Biometric;
 
@@ -1483,10 +1447,10 @@
 
     goto :goto_8
 
-    :cond_f
+    :cond_d
     iget-boolean p1, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mIsFace:Z
 
-    if-eqz p1, :cond_10
+    if-eqz p1, :cond_e
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$Biometric;->Face:Lcom/android/keyguard/KeyguardTextBuilder$Biometric;
 
@@ -1498,7 +1462,7 @@
 
     goto :goto_8
 
-    :cond_10
+    :cond_e
     iput-object v0, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mBiometricType:Ljava/lang/String;
 
     :goto_8
@@ -1506,7 +1470,7 @@
 
     move-result p1
 
-    if-eqz p1, :cond_14
+    if-eqz p1, :cond_12
 
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$2;->$SwitchMap$com$android$keyguard$KeyguardConstants$KeyguardDismissActionType:[I
 
@@ -1520,21 +1484,21 @@
 
     aget p1, p1, v1
 
-    if-eq p1, v4, :cond_13
+    if-eq p1, v4, :cond_11
 
     const/4 v1, 0x2
 
-    if-eq p1, v1, :cond_12
+    if-eq p1, v1, :cond_10
 
     const/4 v1, 0x3
 
-    if-eq p1, v1, :cond_11
+    if-eq p1, v1, :cond_f
 
     iput-object v0, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mDismissActionType:Ljava/lang/String;
 
     goto :goto_9
 
-    :cond_11
+    :cond_f
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->FingerPrintError:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
 
     invoke-virtual {p1}, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->getType()Ljava/lang/String;
@@ -1545,7 +1509,7 @@
 
     goto :goto_9
 
-    :cond_12
+    :cond_10
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->Reboot:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
 
     invoke-virtual {p1}, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->getType()Ljava/lang/String;
@@ -1556,7 +1520,7 @@
 
     goto :goto_9
 
-    :cond_13
+    :cond_11
     sget-object p1, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->ShutDown:Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;
 
     invoke-virtual {p1}, Lcom/android/keyguard/KeyguardTextBuilder$DismissActionType;->getType()Ljava/lang/String;
@@ -1567,7 +1531,7 @@
 
     goto :goto_9
 
-    :cond_14
+    :cond_12
     iput-object v0, p0, Lcom/android/keyguard/KeyguardTextBuilder;->mDismissActionType:Ljava/lang/String;
 
     :goto_9
diff --git a/smali/com/android/keyguard/SecLockIconViewController$3.smali b/smali/com/android/keyguard/SecLockIconViewController$3.smali
index 37653cfa..5ba46308 100644
--- a/smali/com/android/keyguard/SecLockIconViewController$3.smali
+++ b/smali/com/android/keyguard/SecLockIconViewController$3.smali
@@ -44,9 +44,7 @@
 .method public final onLockModeChanged()V
     .locals 1
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_0
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     iget-object p0, p0, Lcom/android/keyguard/SecLockIconViewController$3;->this$0:Lcom/android/keyguard/SecLockIconViewController;
 
diff --git a/smali/com/android/keyguard/SecurityUtils.smali b/smali/com/android/keyguard/SecurityUtils.smali
index f7e4b841..fcc64dac 100644
--- a/smali/com/android/keyguard/SecurityUtils.smali
+++ b/smali/com/android/keyguard/SecurityUtils.smali
@@ -41,7 +41,7 @@
 .end method
 
 .method public static calculateLandscapeViewWidth(ILandroid/content/Context;)I
-    .locals 2
+    .locals 1
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -53,36 +53,23 @@
 
     move-result p1
 
-    mul-int/lit8 v0, p1, 0x2
-
-    sub-int v0, p0, v0
-
-    div-int/lit8 v0, v0, 0x2
-
-    const-class v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-static {v1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    mul-int/lit8 p1, p1, 0x2
 
-    move-result-object v1
-
-    check-cast v1, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    sub-int/2addr p0, p1
 
-    move-result v1
+    div-int/lit8 p0, p0, 0x2
 
-    if-eqz v1, :cond_0
+    const-class p1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    sub-int/2addr p0, p1
+    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    sget p1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    move-result-object p1
 
-    sub-int/2addr p0, p1
+    check-cast p1, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    div-int/lit8 v0, p0, 0x2
+    invoke-interface {p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    :cond_0
-    return v0
+    return p0
 .end method
 
 .method public static checkFullscreenBouncer(Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;)Z
diff --git a/smali/com/android/keyguard/StrongAuthPopup.smali b/smali/com/android/keyguard/StrongAuthPopup.smali
index 3e36dd67..61187cff 100644
--- a/smali/com/android/keyguard/StrongAuthPopup.smali
+++ b/smali/com/android/keyguard/StrongAuthPopup.smali
@@ -297,34 +297,6 @@
     return-void
 .end method
 
-.method public final getNavigationBarSize()I
-    .locals 1
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object p0
-
-    const v0, 0x105024e
-
-    invoke-virtual {p0, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    return p0
-.end method
-
 .method public final onApplyWindowInsets(Landroid/view/View;Landroid/view/WindowInsets;)Landroid/view/WindowInsets;
     .locals 0
 
@@ -393,7 +365,7 @@
 
     if-eqz v1, :cond_0
 
-    goto/16 :goto_23
+    goto/16 :goto_1f
 
     :cond_0
     iput v0, p0, Lcom/android/keyguard/StrongAuthPopup;->mRotation:I
@@ -436,9 +408,9 @@
 
     const/4 v8, 0x3
 
-    const/4 v9, 0x0
+    const/4 v9, 0x1
 
-    const/4 v10, 0x1
+    const/4 v10, 0x0
 
     const/4 v11, 0x2
 
@@ -469,12 +441,12 @@
 
     if-ne v4, v6, :cond_2
 
-    move v4, v10
+    move v4, v9
 
     goto :goto_0
 
     :cond_2
-    move v4, v9
+    move v4, v10
 
     :goto_0
     invoke-static {v3, v4}, Lcom/android/keyguard/SecurityUtils;->getMainSecurityViewFlipperSize(Landroid/content/Context;Z)I
@@ -484,20 +456,20 @@
     goto :goto_3
 
     :cond_3
-    if-eq v0, v10, :cond_5
+    if-eq v0, v9, :cond_5
 
     if-ne v0, v8, :cond_4
 
     goto :goto_1
 
     :cond_4
-    move v3, v9
+    move v3, v10
 
     goto :goto_2
 
     :cond_5
     :goto_1
-    move v3, v10
+    move v3, v9
 
     :goto_2
     if-eqz v3, :cond_6
@@ -524,27 +496,29 @@
 
     iput v3, v2, Landroid/view/WindowManager$LayoutParams;->height:I
 
-    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->layoutInDisplayCutoutMode:I
+    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->layoutInDisplayCutoutMode:I
 
-    if-eq v0, v10, :cond_8
+    if-eq v0, v9, :cond_8
 
     if-ne v0, v8, :cond_7
 
     goto :goto_4
 
     :cond_7
-    move v3, v9
+    move v3, v10
 
     goto :goto_5
 
     :cond_8
     :goto_4
-    move v3, v10
+    move v3, v9
 
     :goto_5
-    sget-object v4, Lcom/android/keyguard/SecurityUtils;->sImeHeight:[I
+    const v4, 0x105024e
+
+    sget-object v6, Lcom/android/keyguard/SecurityUtils;->sImeHeight:[I
 
-    const/16 v6, 0x50
+    const/16 v12, 0x50
 
     if-eqz v3, :cond_11
 
@@ -564,12 +538,12 @@
 
     if-ne v3, v7, :cond_9
 
-    move v3, v10
+    move v3, v9
 
     goto :goto_6
 
     :cond_9
-    move v3, v9
+    move v3, v10
 
     :goto_6
     const/16 v7, 0x10
@@ -580,28 +554,28 @@
 
     if-eqz v3, :cond_c
 
-    if-eq v0, v10, :cond_b
+    if-eq v0, v9, :cond_b
 
     if-ne v0, v8, :cond_a
 
     goto :goto_7
 
     :cond_a
-    move v3, v9
+    move v3, v10
 
     goto :goto_8
 
     :cond_b
     :goto_7
-    move v3, v10
+    move v3, v9
 
     :goto_8
-    aget v3, v4, v3
+    aget v3, v6, v3
 
     goto :goto_9
 
     :cond_c
-    move v3, v9
+    move v3, v10
 
     :goto_9
     if-eqz v3, :cond_d
@@ -609,39 +583,39 @@
     goto :goto_a
 
     :cond_d
-    move v6, v7
+    move v12, v7
 
     :goto_a
-    iput v6, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
+    iput v12, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
     if-eqz v3, :cond_e
 
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    iget-object v6, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v4}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v4
+    move-result-object v6
 
-    invoke-virtual {v4, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v6, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v4
+    move-result v5
 
-    add-int/2addr v4, v3
+    add-int/2addr v5, v3
 
     goto :goto_b
 
     :cond_e
-    move v4, v9
+    move v5, v10
 
     :goto_b
-    iput v4, v2, Landroid/view/WindowManager$LayoutParams;->y:I
+    iput v5, v2, Landroid/view/WindowManager$LayoutParams;->y:I
 
     goto :goto_c
 
     :cond_f
     iput v7, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->y:I
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->y:I
 
     :goto_c
     iget v3, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
@@ -650,21 +624,33 @@
 
     iput v3, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
-    if-ne v0, v10, :cond_10
+    if-ne v0, v9, :cond_10
+
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
+
+    if-eqz v0, :cond_10
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    move-result v9
+    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+
+    move-result-object p0
+
+    invoke-virtual {p0, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+
+    move-result p0
+
+    move v10, p0
 
     :cond_10
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->x:I
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->x:I
 
-    goto/16 :goto_22
+    goto/16 :goto_1e
 
     :cond_11
-    iput v6, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
+    iput v12, v2, Landroid/view/WindowManager$LayoutParams;->gravity:I
 
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->x:I
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->x:I
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
@@ -676,27 +662,7 @@
 
     move-result-object v3
 
-    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v5, :cond_12
-
-    iget-object v5, p0, Lcom/android/keyguard/StrongAuthPopup;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-virtual {v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
-
-    move-result v5
-
-    if-eqz v5, :cond_12
-
-    sget v5, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_d
-
-    :cond_12
-    move v5, v9
-
-    :goto_d
-    sget-object v6, Lcom/android/keyguard/StrongAuthPopup$3;->$SwitchMap$com$android$keyguard$KeyguardSecurityModel$SecurityMode:[I
+    sget-object v5, Lcom/android/keyguard/StrongAuthPopup$3;->$SwitchMap$com$android$keyguard$KeyguardSecurityModel$SecurityMode:[I
 
     iget-object v7, p0, Lcom/android/keyguard/StrongAuthPopup;->mSecurityMode:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
@@ -704,230 +670,220 @@
 
     move-result v7
 
-    aget v6, v6, v7
+    aget v5, v5, v7
 
     const v7, 0x7f070405
 
     const v12, 0x7f070404
 
-    if-eq v6, v10, :cond_24
+    if-eq v5, v9, :cond_22
 
-    if-eq v6, v11, :cond_19
+    if-eq v5, v11, :cond_17
 
-    if-eq v6, v8, :cond_13
+    if-eq v5, v8, :cond_12
 
-    goto/16 :goto_21
+    goto/16 :goto_1d
+
+    :cond_12
+    if-eqz v0, :cond_13
+
+    const p0, 0x7f0704f7
+
+    goto :goto_d
 
     :cond_13
+    const p0, 0x7f0704f6
+
+    :goto_d
+    invoke-virtual {v3, p0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+
+    move-result p0
+
     if-eqz v0, :cond_14
 
-    const v4, 0x7f0704f7
+    const v4, 0x7f0704f9
 
     goto :goto_e
 
     :cond_14
-    const v4, 0x7f0704f6
+    const v4, 0x7f0704f8
 
     :goto_e
     invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v4
 
-    if-eqz v0, :cond_15
+    add-int/2addr v4, p0
 
-    const v6, 0x7f0704f9
+    if-eqz v0, :cond_15
 
     goto :goto_f
 
     :cond_15
-    const v6, 0x7f0704f8
+    move v7, v12
 
     :goto_f
-    invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v6
+    move-result p0
 
-    add-int/2addr v6, v4
+    if-eqz v0, :cond_16
 
-    if-eqz v5, :cond_16
+    const v0, 0x7f0704f5
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    goto :goto_10
 
-    move-result p0
+    :cond_16
+    const v0, 0x7f0704f4
 
-    goto/16 :goto_1c
+    :goto_10
+    invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :cond_16
-    if-eqz v0, :cond_17
+    move-result v0
 
-    goto :goto_10
+    goto/16 :goto_1c
 
     :cond_17
-    move v7, v12
+    iget-boolean v5, p0, Lcom/android/keyguard/StrongAuthPopup;->mIsSIPVisible:Z
 
-    :goto_10
-    invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    if-eqz v5, :cond_1a
 
-    move-result p0
+    iget v5, p0, Lcom/android/keyguard/StrongAuthPopup;->mRotation:I
 
-    if-eqz v0, :cond_18
+    if-eq v5, v9, :cond_19
 
-    const v0, 0x7f0704f5
+    if-ne v5, v8, :cond_18
 
     goto :goto_11
 
     :cond_18
-    const v0, 0x7f0704f4
-
-    :goto_11
-    invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v0
-
-    goto/16 :goto_1f
+    move v9, v10
 
     :cond_19
-    iget-boolean v6, p0, Lcom/android/keyguard/StrongAuthPopup;->mIsSIPVisible:Z
-
-    if-eqz v6, :cond_1c
-
-    iget v6, p0, Lcom/android/keyguard/StrongAuthPopup;->mRotation:I
-
-    if-eq v6, v10, :cond_1b
-
-    if-ne v6, v8, :cond_1a
+    :goto_11
+    aget v5, v6, v9
 
     goto :goto_12
 
     :cond_1a
-    move v10, v9
+    move v5, v10
 
-    :cond_1b
     :goto_12
-    aget v4, v4, v10
-
-    goto :goto_13
-
-    :cond_1c
-    move v4, v9
-
-    :goto_13
-    if-eqz v0, :cond_1d
+    if-eqz v0, :cond_1b
 
     const v6, 0x7f070520
 
-    goto :goto_14
+    goto :goto_13
 
-    :cond_1d
+    :cond_1b
     const v6, 0x7f07051f
 
-    :goto_14
+    :goto_13
     invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v6
 
-    if-eqz v0, :cond_1e
+    if-eqz v0, :cond_1c
 
     const v8, 0x7f07051d
 
-    goto :goto_15
+    goto :goto_14
 
-    :cond_1e
+    :cond_1c
     const v8, 0x7f07051c
 
-    :goto_15
+    :goto_14
     invoke-virtual {v3, v8}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v8
 
     add-int/2addr v8, v6
 
-    if-eqz v0, :cond_1f
+    if-eqz v0, :cond_1d
 
     const v6, 0x7f070527
 
-    goto :goto_16
+    goto :goto_15
 
-    :cond_1f
+    :cond_1d
     const v6, 0x7f0704ec
 
-    :goto_16
+    :goto_15
     invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v6
 
     add-int/2addr v6, v8
 
-    if-eqz v5, :cond_20
-
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
-
-    move-result v0
-
-    sub-int/2addr v5, v0
-
-    goto :goto_19
-
-    :cond_20
-    if-eqz v0, :cond_21
+    if-eqz v0, :cond_1e
 
-    goto :goto_17
+    goto :goto_16
 
-    :cond_21
+    :cond_1e
     move v7, v12
 
-    :goto_17
+    :goto_16
     invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v5
+    move-result v7
 
-    if-eqz v0, :cond_22
+    if-eqz v0, :cond_1f
 
     const v0, 0x7f0704ee
 
-    goto :goto_18
+    goto :goto_17
 
-    :cond_22
+    :cond_1f
     const v0, 0x7f0704ed
 
-    :goto_18
+    :goto_17
     invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v0
 
-    add-int/2addr v5, v0
+    add-int/2addr v0, v7
 
-    :goto_19
-    add-int/2addr v6, v5
+    add-int/2addr v0, v6
 
-    if-eqz v4, :cond_23
+    if-eqz v5, :cond_21
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_NAVBAR_ENABLED:Z
 
-    move-result p0
+    if-eqz v3, :cond_20
 
-    sub-int v9, v4, p0
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    :cond_23
-    add-int/2addr v9, v6
+    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    goto :goto_21
+    move-result-object p0
 
-    :cond_24
-    if-eqz v0, :cond_25
+    invoke-virtual {p0, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+
+    move-result v10
 
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    :cond_20
+    sub-int v10, v5, v10
 
-    invoke-static {v4}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
+    :cond_21
+    add-int/2addr v10, v0
 
-    move-result v4
+    goto :goto_1d
 
-    goto :goto_1a
+    :cond_22
+    if-eqz v0, :cond_23
 
-    :cond_25
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getTabletPINContainerHeight(Landroid/content/Context;)I
+
+    move-result p0
+
+    goto :goto_18
+
+    :cond_23
     sget-boolean v4, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v4, :cond_26
+    if-eqz v4, :cond_24
 
     const-class v4, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
@@ -939,90 +895,77 @@
 
     iget-boolean v4, v4, Lcom/android/systemui/keyguard/DisplayLifecycle;->mIsFolderOpened:Z
 
-    if-eqz v4, :cond_26
-
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    if-eqz v4, :cond_24
 
-    invoke-static {v4}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
-
-    move-result v4
-
-    goto :goto_1a
-
-    :cond_26
-    iget-object v4, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    invoke-static {v4}, Lcom/android/keyguard/SecurityUtils;->getPINContainerHeight(Landroid/content/Context;)I
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getFoldPINContainerHeight(Landroid/content/Context;)I
 
-    move-result v4
-
-    :goto_1a
-    if-eqz v0, :cond_27
+    move-result p0
 
-    const v6, 0x7f0704ff
+    goto :goto_18
 
-    goto :goto_1b
+    :cond_24
+    iget-object p0, p0, Lcom/android/keyguard/StrongAuthPopup;->mContext:Landroid/content/Context;
 
-    :cond_27
-    const v6, 0x7f0704fe
+    invoke-static {p0}, Lcom/android/keyguard/SecurityUtils;->getPINContainerHeight(Landroid/content/Context;)I
 
-    :goto_1b
-    invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    move-result p0
 
-    move-result v6
+    :goto_18
+    if-eqz v0, :cond_25
 
-    add-int/2addr v6, v4
+    const v4, 0x7f0704ff
 
-    if-eqz v5, :cond_28
+    goto :goto_19
 
-    invoke-virtual {p0}, Lcom/android/keyguard/StrongAuthPopup;->getNavigationBarSize()I
+    :cond_25
+    const v4, 0x7f0704fe
 
-    move-result p0
+    :goto_19
+    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    :goto_1c
-    sub-int/2addr v5, p0
+    move-result v4
 
-    goto :goto_20
+    add-int/2addr v4, p0
 
-    :cond_28
-    if-eqz v0, :cond_29
+    if-eqz v0, :cond_26
 
-    goto :goto_1d
+    goto :goto_1a
 
-    :cond_29
+    :cond_26
     move v7, v12
 
-    :goto_1d
+    :goto_1a
     invoke-virtual {v3, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result p0
 
-    if-eqz v0, :cond_2a
+    if-eqz v0, :cond_27
 
     const v0, 0x7f070501
 
-    goto :goto_1e
+    goto :goto_1b
 
-    :cond_2a
+    :cond_27
     const v0, 0x7f070500
 
-    :goto_1e
+    :goto_1b
     invoke-virtual {v3, v0}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v0
 
-    :goto_1f
-    add-int v5, v0, p0
+    :goto_1c
+    add-int/2addr v0, p0
 
-    :goto_20
-    add-int v9, v6, v5
+    add-int v10, v0, v4
 
-    :goto_21
-    iput v9, v2, Landroid/view/WindowManager$LayoutParams;->y:I
+    :goto_1d
+    iput v10, v2, Landroid/view/WindowManager$LayoutParams;->y:I
 
-    :goto_22
+    :goto_1e
     invoke-virtual {v1, v2}, Landroid/view/Window;->setAttributes(Landroid/view/WindowManager$LayoutParams;)V
 
-    :goto_23
+    :goto_1f
     return-void
 .end method
diff --git a/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali b/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali
index 6979d884..6aaf8cae 100644
--- a/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali
+++ b/smali/com/android/keyguard/biometrics/KeyguardBiometricViewController.smali
@@ -630,7 +630,7 @@
 .end method
 
 .method public final needsToChangeRetryButton()Z
-    .locals 3
+    .locals 2
 
     iget-object v0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->biometricRetryIcon:Lcom/android/systemui/widget/SystemUIImageView;
 
@@ -646,8 +646,6 @@
 
     move-result v0
 
-    const/4 v2, 0x1
-
     if-eqz v0, :cond_1
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
@@ -669,40 +667,15 @@
     if-eqz p0, :cond_2
 
     :cond_0
-    :goto_0
-    move v1, v2
+    const/4 v1, 0x1
 
-    goto :goto_1
+    goto :goto_0
 
     :cond_1
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_2
-
-    iget-object v0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
-
-    move-result-object p0
-
-    const v0, 0x7f050066
-
-    invoke-virtual {p0, v0}, Landroid/content/res/Resources;->getBoolean(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_2
-
-    goto :goto_0
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_2
-    :goto_1
+    :goto_0
     return v1
 .end method
 
@@ -1067,534 +1040,453 @@
 .end method
 
 .method public final updateBiometricViewLayout()V
-    .locals 16
-
-    move-object/from16 v0, p0
+    .locals 15
 
-    iget-object v1, v0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
+    iget-object v0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->getCurrentSecurityMode()Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
+    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->getCurrentSecurityMode()Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    move-result-object v2
+    move-result-object v1
 
-    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
+    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
 
-    if-eqz v3, :cond_0
+    if-eqz v2, :cond_0
 
-    sget-object v3, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Swipe:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
+    sget-object v2, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Swipe:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    if-ne v2, v3, :cond_0
+    if-ne v1, v2, :cond_0
 
-    iget-object v0, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object p0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast p0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    const/16 v1, 0x8
+    const/16 v0, 0x8
 
-    invoke-virtual {v0, v1}, Landroid/widget/FrameLayout;->setVisibility(I)V
+    invoke-virtual {p0, v0}, Landroid/widget/FrameLayout;->setVisibility(I)V
 
     return-void
 
     :cond_0
-    sget-object v3, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Password:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
+    sget-object v2, Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;->Password:Lcom/android/keyguard/KeyguardSecurityModel$SecurityMode;
 
-    const/4 v4, 0x0
+    const/4 v3, 0x0
 
-    const/4 v5, 0x1
+    const/4 v4, 0x1
 
-    if-ne v2, v3, :cond_1
+    if-ne v1, v2, :cond_1
 
-    move v2, v5
+    move v1, v4
 
     goto :goto_0
 
     :cond_1
-    move v2, v4
+    move v1, v3
 
     :goto_0
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v3
+    move-result-object v2
 
-    const v6, 0x7f0704e8
+    const v5, 0x7f0704e8
 
-    invoke-virtual {v3, v6}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {v2, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v3
+    move-result v2
 
-    new-instance v12, Landroidx/constraintlayout/widget/ConstraintSet;
+    new-instance v11, Landroidx/constraintlayout/widget/ConstraintSet;
 
-    invoke-direct {v12}, Landroidx/constraintlayout/widget/ConstraintSet;-><init>()V
+    invoke-direct {v11}, Landroidx/constraintlayout/widget/ConstraintSet;-><init>()V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v5, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v5, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v5}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v5
 
-    sget-boolean v13, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
+    sget-boolean v12, Lcom/android/systemui/LsRune;->SECURITY_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v13, :cond_3
+    if-eqz v12, :cond_3
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v7
+    move-result-object v6
 
-    iget v7, v7, Landroid/content/res/Configuration;->semDisplayDeviceType:I
+    iget v6, v6, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    if-nez v7, :cond_2
+    if-nez v6, :cond_2
 
-    move v7, v5
+    move v6, v4
 
     goto :goto_1
 
     :cond_2
-    move v7, v4
+    move v6, v3
 
     :goto_1
-    if-eqz v7, :cond_3
+    if-eqz v6, :cond_3
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
-    move-result v7
+    move-result v6
 
-    if-nez v7, :cond_3
+    if-nez v6, :cond_3
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-static {v7, v2}, Lcom/android/keyguard/SecurityUtils;->getMainSecurityViewFlipperSize(Landroid/content/Context;Z)I
+    invoke-static {v6, v1}, Lcom/android/keyguard/SecurityUtils;->getMainSecurityViewFlipperSize(Landroid/content/Context;Z)I
 
-    move-result v7
+    move-result v1
 
     goto :goto_2
 
     :cond_3
-    move v7, v4
+    move v1, v3
 
     :goto_2
-    invoke-virtual {v12, v6, v7}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
+    invoke-virtual {v11, v5, v1}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v1
 
-    const/4 v14, -0x2
+    const/4 v13, -0x2
 
-    invoke-virtual {v12, v6, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
+    invoke-virtual {v11, v1, v13}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v7
+    move-result v6
 
-    const/4 v8, 0x6
+    const/4 v7, 0x6
 
-    const/4 v9, 0x0
+    const/4 v8, 0x0
 
-    const/4 v10, 0x6
+    const/4 v9, 0x6
 
-    const/4 v11, 0x0
+    const/4 v10, 0x0
 
-    move-object v6, v12
+    move-object v5, v11
 
-    invoke-virtual/range {v6 .. v11}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
+    invoke-virtual/range {v5 .. v10}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v1
 
-    const/4 v15, 0x7
+    const/4 v14, 0x7
 
-    invoke-virtual {v12, v6, v15, v4, v15}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {v11, v1, v14, v3, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v6
+    move-result v1
 
-    const/4 v7, 0x3
+    const/4 v5, 0x3
 
-    invoke-virtual {v12, v6, v7, v4, v7}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {v11, v1, v5, v3, v5}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6, v4, v4, v4, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    invoke-virtual {v1, v3, v3, v3, v3}, Landroid/widget/FrameLayout;->setPadding(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v1, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    iget-object v6, v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;->defaultDisplay:Landroid/view/Display;
+    iget-object v1, v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;->defaultDisplay:Landroid/view/Display;
 
-    invoke-virtual {v6}, Landroid/view/Display;->getRotation()I
+    invoke-virtual {v1}, Landroid/view/Display;->getRotation()I
 
-    move-result v6
+    move-result v1
 
-    invoke-static {v6}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
+    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
 
-    move-result v6
+    move-result v1
 
-    invoke-static {v6}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
+    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
 
-    move-result v11
+    move-result v1
 
-    if-eq v11, v5, :cond_4
+    if-eq v1, v4, :cond_4
 
-    if-eq v11, v7, :cond_4
+    if-eq v1, v5, :cond_4
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v7
+    move-result v6
 
-    const/4 v8, 0x6
+    const/4 v7, 0x6
 
-    const/4 v9, 0x0
+    const/4 v8, 0x0
 
-    const/4 v10, 0x6
+    const/4 v9, 0x6
 
-    const/4 v11, 0x0
+    const/4 v10, 0x0
 
-    move-object v6, v12
+    move-object v5, v11
 
-    invoke-virtual/range {v6 .. v11}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
+    invoke-virtual/range {v5 .. v10}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    move-result v1
+    move-result v0
 
-    invoke-virtual {v12, v1, v15, v4, v15}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    invoke-virtual {v11, v0, v14, v3, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1, v4, v4, v4, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    invoke-virtual {v0, v3, v3, v3, v3}, Landroid/widget/FrameLayout;->setPadding(IIII)V
 
-    goto/16 :goto_7
+    goto/16 :goto_5
 
     :cond_4
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
+    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isHiddenInputContainer()Z
 
-    move-result v6
+    move-result v1
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
-    move-result v8
-
-    if-nez v8, :cond_f
+    move-result v5
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    if-nez v5, :cond_8
 
-    move-result-object v8
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    invoke-static {v8}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
+    move-result-object v5
 
-    move-result v8
+    invoke-static {v5}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
-    if-eqz v8, :cond_f
+    move-result v5
 
-    if-nez v6, :cond_f
+    if-eqz v5, :cond_8
 
-    if-eqz v13, :cond_6
+    if-nez v1, :cond_8
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    if-eqz v12, :cond_6
 
-    move-result-object v6
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    move-result-object v1
 
-    move-result-object v6
+    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    move-result-object v1
 
-    move-result-object v6
+    invoke-virtual {v1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    iget v6, v6, Landroid/content/res/Configuration;->semDisplayDeviceType:I
+    move-result-object v1
 
-    if-nez v6, :cond_5
+    iget v1, v1, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    move v6, v5
+    if-nez v1, :cond_5
 
     goto :goto_3
 
     :cond_5
-    move v6, v4
+    move v4, v3
 
     :goto_3
-    if-eqz v6, :cond_6
+    if-eqz v4, :cond_6
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
-    move-result v6
+    move-result v1
 
-    if-nez v6, :cond_6
+    if-nez v1, :cond_6
 
-    goto/16 :goto_8
+    goto/16 :goto_6
 
     :cond_6
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v6
+    move-result-object v1
 
-    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    invoke-virtual {v1}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    move-result-object v6
+    move-result-object v1
 
-    iget-object v6, v6, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
+    iget-object v1, v1, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
 
-    invoke-virtual {v6}, Landroid/app/WindowConfiguration;->getBounds()Landroid/graphics/Rect;
+    invoke-virtual {v1}, Landroid/app/WindowConfiguration;->getBounds()Landroid/graphics/Rect;
 
-    move-result-object v6
+    move-result-object v1
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    move-result-object v8
+    move-result-object v4
 
-    invoke-static {v8}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
+    invoke-static {v4}, Lcom/android/systemui/util/DeviceState;->shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
 
-    move-result v8
+    move-result v4
 
-    if-eqz v8, :cond_7
+    if-eqz v4, :cond_7
 
-    invoke-virtual {v6}, Landroid/graphics/Rect;->width()I
+    invoke-virtual {v1}, Landroid/graphics/Rect;->width()I
 
-    move-result v6
+    move-result v1
 
     goto :goto_4
 
     :cond_7
-    invoke-virtual {v6}, Landroid/graphics/Rect;->width()I
-
-    move-result v8
-
-    invoke-virtual {v6}, Landroid/graphics/Rect;->height()I
-
-    move-result v6
-
-    invoke-static {v8, v6}, Ljava/lang/Math;->min(II)I
+    invoke-virtual {v1}, Landroid/graphics/Rect;->width()I
 
-    move-result v6
+    move-result v4
 
-    :goto_4
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v8
-
-    const v9, 0x7f07093c
-
-    invoke-virtual {v8, v9}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v8
-
-    sget v9, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
+    invoke-virtual {v1}, Landroid/graphics/Rect;->height()I
 
     move-result v1
 
-    if-eqz v1, :cond_c
+    invoke-static {v4, v1}, Ljava/lang/Math;->min(II)I
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
+    move-result v1
 
-    move-result-object v10
+    :goto_4
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
-    invoke-virtual {v10}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    move-result-object v4
 
-    move-result-object v10
+    const v5, 0x7f07093c
 
-    invoke-virtual {v10}, Landroid/content/res/Configuration;->getLayoutDirection()I
+    invoke-virtual {v4, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
     move-result v10
 
-    if-ne v10, v5, :cond_8
-
-    move v10, v5
+    invoke-interface {v0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    goto :goto_5
-
-    :cond_8
-    move v10, v4
-
-    :goto_5
-    if-nez v10, :cond_9
-
-    if-eq v11, v7, :cond_a
-
-    :cond_9
-    if-eqz v10, :cond_b
-
-    if-ne v11, v5, :cond_b
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    :cond_a
-    sub-int/2addr v9, v8
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    goto :goto_6
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    :cond_b
-    move v9, v4
+    move-result v0
 
-    :goto_6
-    add-int/2addr v8, v9
+    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
 
-    :cond_c
-    move v13, v8
+    move-result-object v4
 
-    iget-object v7, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    invoke-static {v1, v4}, Lcom/android/keyguard/SecurityUtils;->calculateLandscapeViewWidth(ILandroid/content/Context;)I
 
-    check-cast v7, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    move-result v1
 
-    invoke-virtual {v7}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v11, v0, v1}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
 
-    move-result v7
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    move-result-object v8
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    invoke-static {v6, v8}, Lcom/android/keyguard/SecurityUtils;->calculateLandscapeViewWidth(ILandroid/content/Context;)I
+    move-result v0
 
-    move-result v6
+    invoke-virtual {v11, v0, v13}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
 
-    invoke-virtual {v12, v7, v6}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainWidth(II)V
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    move-result v0
 
-    move-result v6
+    const/4 v1, -0x1
 
-    invoke-virtual {v12, v6, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->constrainHeight(II)V
+    invoke-virtual {v11, v0, v14, v1, v14}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getId()I
 
     move-result v6
 
-    const/4 v7, -0x1
+    const/4 v7, 0x6
 
-    invoke-virtual {v12, v6, v15, v7, v15}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIII)V
+    const/4 v8, 0x0
 
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    const/4 v9, 0x6
 
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    move-object v5, v11
 
-    invoke-virtual {v6}, Landroid/widget/FrameLayout;->getId()I
+    invoke-virtual/range {v5 .. v10}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
 
-    move-result v7
-
-    const/4 v8, 0x6
-
-    const/4 v9, 0x0
-
-    const/4 v10, 0x6
-
-    move-object v6, v12
-
-    move v14, v11
-
-    move v11, v13
-
-    invoke-virtual/range {v6 .. v11}, Landroidx/constraintlayout/widget/ConstraintSet;->connect(IIIII)V
-
-    iget-object v6, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
-
-    check-cast v6, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
-
-    invoke-virtual {v6, v4, v4, v3, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
-
-    if-eqz v1, :cond_e
-
-    if-eqz v2, :cond_e
-
-    if-ne v14, v5, :cond_d
-
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
-
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
-
-    invoke-virtual {v1, v4, v4, v3, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
-
-    goto :goto_7
-
-    :cond_d
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1, v3, v4, v4, v4}, Landroid/widget/FrameLayout;->setPadding(IIII)V
+    invoke-virtual {v0, v3, v3, v2, v3}, Landroid/widget/FrameLayout;->setPadding(IIII)V
 
-    :cond_e
-    :goto_7
-    iget-object v1, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    :goto_5
+    iget-object v0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v1, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v1}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
+    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
 
-    move-result-object v1
+    move-result-object v0
 
-    check-cast v1, Landroidx/constraintlayout/widget/ConstraintLayout;
+    check-cast v0, Landroidx/constraintlayout/widget/ConstraintLayout;
 
-    invoke-virtual {v12, v1}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
+    invoke-virtual {v11, v0}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->updateLockContainerMargin()V
+    invoke-virtual {p0}, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->updateLockContainerMargin()V
 
     return-void
 
-    :cond_f
-    :goto_8
-    iget-object v0, v0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
+    :cond_8
+    :goto_6
+    iget-object p0, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
-    check-cast v0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
+    check-cast p0, Lcom/android/keyguard/biometrics/KeyguardBiometricView;
 
-    invoke-virtual {v0}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
+    invoke-virtual {p0}, Landroid/widget/FrameLayout;->getParent()Landroid/view/ViewParent;
 
-    move-result-object v0
+    move-result-object p0
 
-    check-cast v0, Landroidx/constraintlayout/widget/ConstraintLayout;
+    check-cast p0, Landroidx/constraintlayout/widget/ConstraintLayout;
 
-    invoke-virtual {v12, v0}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
+    invoke-virtual {v11, p0}, Landroidx/constraintlayout/widget/ConstraintSet;->applyTo(Landroidx/constraintlayout/widget/ConstraintLayout;)V
 
     return-void
 .end method
@@ -1695,7 +1587,7 @@
 
     sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_BIOMETRICS_TABLET:Z
 
-    if-eqz v5, :cond_5
+    if-eqz v5, :cond_4
 
     iget-object v5, p0, Lcom/android/systemui/util/ViewController;->mView:Landroid/view/View;
 
@@ -1715,11 +1607,11 @@
 
     move-result v5
 
-    if-eqz v5, :cond_4
+    if-eqz v5, :cond_3
 
     const/4 v1, 0x1
 
-    if-eq v5, v1, :cond_2
+    if-eq v5, v1, :cond_1
 
     const/4 v1, 0x2
 
@@ -1727,55 +1619,48 @@
 
     const/4 p0, 0x3
 
-    if-eq v5, p0, :cond_2
+    if-eq v5, p0, :cond_1
 
     goto :goto_0
 
     :cond_0
     iget-object p0, p0, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result p0
+    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()V
 
-    if-eqz p0, :cond_1
-
-    sget v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    :cond_1
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     goto :goto_0
 
-    :cond_2
-    if-eqz v2, :cond_3
+    :cond_1
+    if-eqz v2, :cond_2
 
     move v0, v2
 
-    :cond_3
+    :cond_2
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     goto :goto_0
 
-    :cond_4
+    :cond_3
     add-int/2addr v0, v1
 
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     goto :goto_0
 
-    :cond_5
+    :cond_4
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
 
     invoke-virtual {p0}, Lcom/android/keyguard/biometrics/KeyguardBiometricViewController;->isLandscape()Z
 
     move-result p0
 
-    if-eqz p0, :cond_6
+    if-eqz p0, :cond_5
 
     const/4 v1, 0x0
 
-    :cond_6
+    :cond_5
     add-int/2addr v0, v1
 
     iput v0, v4, Landroid/widget/LinearLayout$LayoutParams;->topMargin:I
diff --git a/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali b/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali
index e7d5f77c..d910ca7a 100644
--- a/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali
+++ b/smali/com/android/keyguard/biometrics/KeyguardFingerprintGuidePopup$keyguardUpdateMonitorCallback$1.smali
@@ -56,18 +56,18 @@
 
     move-result p3
 
-    const/4 v0, 0x0
+    const/4 v0, 0x2
 
-    const/4 v1, 0x2
+    const/4 v1, 0x0
 
-    if-ne p3, v1, :cond_0
+    if-ne p3, v0, :cond_0
 
     const/4 p3, 0x1
 
     goto :goto_0
 
     :cond_0
-    move p3, v0
+    move p3, v1
 
     :goto_0
     if-eqz p3, :cond_5
@@ -106,7 +106,7 @@
 
     invoke-virtual {p1, p2}, Landroid/widget/TextView;->setText(Ljava/lang/CharSequence;)V
 
-    invoke-virtual {p1, v0}, Lcom/android/systemui/widget/SystemUITextView;->setVisibility(I)V
+    invoke-virtual {p1, v1}, Lcom/android/systemui/widget/SystemUITextView;->setVisibility(I)V
 
     :cond_1
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getContext()Landroid/content/Context;
@@ -117,51 +117,45 @@
 
     move-result p1
 
-    sget p2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
-
-    add-int/2addr p1, p2
+    add-int/2addr p1, v1
 
-    div-int/2addr p1, v1
+    div-int/2addr p1, v0
 
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getResources()Landroid/content/res/Resources;
 
-    move-result-object p3
-
-    const v2, 0x7f07047f
+    move-result-object p2
 
-    invoke-virtual {p3, v2}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    const p3, 0x7f07047f
 
-    move-result p3
+    invoke-virtual {p2, p3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    add-int/2addr p3, p1
-
-    sget p1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    move-result p2
 
-    sub-int/2addr p1, p2
+    add-int/2addr p2, p1
 
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getResources()Landroid/content/res/Resources;
 
-    move-result-object p2
+    move-result-object p1
 
-    const v2, 0x7f070480
+    const p3, 0x7f070480
 
-    invoke-virtual {p2, v2}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
+    invoke-virtual {p1, p3}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result p2
+    move-result p1
 
-    add-int/2addr p2, p1
+    add-int/2addr p1, v1
 
-    iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->keyguardGuidePopup:Landroid/view/ViewGroup;
+    iget-object p3, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->keyguardGuidePopup:Landroid/view/ViewGroup;
 
-    if-eqz p1, :cond_2
+    if-eqz p3, :cond_2
 
-    int-to-float p3, p3
+    int-to-float p2, p2
 
-    invoke-virtual {p1, p3}, Landroid/view/ViewGroup;->setTranslationX(F)V
+    invoke-virtual {p3, p2}, Landroid/view/ViewGroup;->setTranslationX(F)V
 
-    int-to-float p2, p2
+    int-to-float p1, p1
 
-    invoke-virtual {p1, p2}, Landroid/view/ViewGroup;->setTranslationY(F)V
+    invoke-virtual {p3, p1}, Landroid/view/ViewGroup;->setTranslationY(F)V
 
     :cond_2
     iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->handler:Landroid/os/Handler;
@@ -200,7 +194,7 @@
     :cond_4
     iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->keyguardGuidePopup:Landroid/view/ViewGroup;
 
-    new-array p2, v1, [F
+    new-array p2, v0, [F
 
     fill-array-data p2, :array_0
 
@@ -237,7 +231,7 @@
     invoke-virtual {p2}, Landroid/animation/AnimatorSet;->start()V
 
     :goto_1
-    invoke-virtual {p0, v0}, Landroid/widget/FrameLayout;->setVisibility(I)V
+    invoke-virtual {p0, v1}, Landroid/widget/FrameLayout;->setVisibility(I)V
 
     iget-object p1, p0, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;->handler:Landroid/os/Handler;
 
@@ -256,6 +250,8 @@
     :cond_5
     return-void
 
+    nop
+
     :array_0
     .array-data 4
         0x0
diff --git a/smali/com/android/keyguard/dagger/KeyguardBouncerModule_ProvidesOptionalSidefpsControllerFactory.smali b/smali/com/android/keyguard/dagger/KeyguardBouncerModule_ProvidesOptionalSidefpsControllerFactory.smali
index b23784ad..9dab13ac 100644
--- a/smali/com/android/keyguard/dagger/KeyguardBouncerModule_ProvidesOptionalSidefpsControllerFactory.smali
+++ b/smali/com/android/keyguard/dagger/KeyguardBouncerModule_ProvidesOptionalSidefpsControllerFactory.smali
@@ -36,7 +36,9 @@
 .method public static providesOptionalSidefpsController(Landroid/hardware/fingerprint/FingerprintManager;Ljavax/inject/Provider;)Ljava/util/Optional;
     .locals 1
 
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-nez v0, :cond_3
 
     if-eqz p0, :cond_0
 
@@ -62,10 +64,6 @@
     :goto_1
     if-nez p0, :cond_2
 
-    invoke-static {}, Ljava/util/Optional;->empty()Ljava/util/Optional;
-
-    move-result-object p0
-
     goto :goto_2
 
     :cond_2
@@ -79,7 +77,15 @@
 
     move-result-object p0
 
+    goto :goto_3
+
+    :cond_3
     :goto_2
+    invoke-static {}, Ljava/util/Optional;->empty()Ljava/util/Optional;
+
+    move-result-object p0
+
+    :goto_3
     invoke-static {p0}, Ldagger/internal/Preconditions;->checkNotNullFromProvides(Ljava/lang/Object;)V
 
     return-object p0
diff --git a/smali/com/android/systemui/LsRune.smali b/smali/com/android/systemui/LsRune.smali
index 0f2dbf82..3ca862bd 100644
--- a/smali/com/android/systemui/LsRune.smali
+++ b/smali/com/android/systemui/LsRune.smali
@@ -118,9 +118,7 @@
 
 .field public static final SECURITY_FACTORY_RESET_WITHOUT_UI:Z
 
-.field public static final SECURITY_FINGERPRINT_GUIDE_POPUP:Z
-
-.field public static final SECURITY_FINGERPRINT_IN_DISPLAY:Z
+.field public static final SECURITY_FINGERPRINT_SIDE:Z
 
 .field public static final SECURITY_HAPTIC_FEEDBACK_ON_DC_MOTOR:Z
 
@@ -365,7 +363,7 @@
     :goto_0
     sput-boolean v8, Lcom/android/systemui/LsRune;->KEYGUARD_DELAY_NOTIFY_DRAWN_PREMIUM_WATCH:Z
 
-    const-string v8, "2"
+    const-string v8, "1"
 
     invoke-static {v8}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
 
@@ -750,9 +748,7 @@
 
     const/4 v3, 0x1
 
-    sput-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const/4 v3, 0x0
+    sput-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
     sput-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
 
@@ -978,8 +974,6 @@
 
     sget v3, Lcom/android/systemui/util/DeviceType;->supportTablet:I
 
-    sput-boolean v8, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_GUIDE_POPUP:Z
-
     if-eqz v6, :cond_14
 
     invoke-static {}, Lcom/samsung/android/feature/SemFloatingFeature;->getInstance()Lcom/samsung/android/feature/SemFloatingFeature;
diff --git a/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali b/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali
index a58c2c84..139839da 100644
--- a/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali
+++ b/smali/com/android/systemui/dagger/DaggerReferenceGlobalRootComponent$CentralSurfacesComponentImpl.smali
@@ -2020,7 +2020,9 @@
 
     invoke-static {p0}, Ldagger/internal/DoubleCheck;->lazy(Ljavax/inject/Provider;)Ldagger/Lazy;
 
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object p0
+
+    iput-object p0, p1, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
 
     return-object p1
 .end method
diff --git a/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali b/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali
index 2fea211c..4dabed8e 100644
--- a/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali
+++ b/smali/com/android/systemui/facewidget/plugin/PluginFaceWidgetManager.smali
@@ -374,7 +374,9 @@
 .method public final getInDisplayFingerprintHeight()I
     .locals 0
 
-    sget p0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    sget-object p0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
+
+    const/4 p0, 0x0
 
     return p0
 .end method
@@ -382,7 +384,9 @@
 .method public final getInDisplayFingerprintImageSize()I
     .locals 0
 
-    sget p0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
+    sget-object p0, Lcom/android/systemui/util/DeviceState;->sDisplaySize:Landroid/graphics/Point;
+
+    const/4 p0, 0x0
 
     return p0
 .end method
@@ -585,7 +589,7 @@
 
     const/4 v0, -0x1
 
-    const/4 v1, 0x1
+    const/4 v1, 0x0
 
     if-ne p0, v0, :cond_0
 
@@ -594,14 +598,13 @@
     :cond_0
     sget p0, Lcom/android/systemui/util/DeviceType;->supportInDisplayFingerprint:I
 
-    if-ne p0, v1, :cond_1
+    const/4 v0, 0x1
 
-    goto :goto_0
+    if-ne p0, v0, :cond_1
 
-    :cond_1
-    const/4 v1, 0x0
+    move v1, v0
 
-    :goto_0
+    :cond_1
     return v1
 .end method
 
diff --git a/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali b/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali
index f2f37bb8..b38ad1e2 100644
--- a/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali
+++ b/smali/com/android/systemui/globalactions/presentation/features/GlobalActionFeatures.smali
@@ -44,7 +44,7 @@
 
     sget-boolean v0, Lcom/android/systemui/BasicRune;->GLOBALACTIONS_BLUR:Z
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_0
     const-string v0, "CAPTURED_BLUR"
@@ -57,7 +57,7 @@
 
     sget-boolean v0, Lcom/android/systemui/BasicRune;->GLOBALACTIONS_CAPTURED_BLUR:Z
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_1
     const-string v0, "NAV_BAR"
@@ -80,7 +80,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_2
     const-string v0, "SAFETY_CARE"
@@ -101,7 +101,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_3
     const-string v0, "SCOVER"
@@ -116,7 +116,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_4
     const-string v0, "DATA_MODE"
@@ -137,7 +137,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_5
     const-string v0, "DEMO_MODE"
@@ -258,7 +258,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_b
     const-string v0, "FINGERPRINT_IN_DISPLAY"
@@ -269,7 +269,7 @@
 
     if-eqz v0, :cond_c
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     goto/16 :goto_4
 
@@ -292,7 +292,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_d
     const-string v0, "POWER_OFF_LOCK"
@@ -313,7 +313,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_e
     const-string v0, "FRONT_LARGE_COVER_DISPLAY"
@@ -332,7 +332,7 @@
 
     move-result v0
 
-    goto/16 :goto_4
+    goto/16 :goto_5
 
     :cond_f
     const-string v0, "FRONT_COVER_DISPLAY"
@@ -372,7 +372,7 @@
 
     if-eqz v0, :cond_11
 
-    goto :goto_3
+    goto :goto_4
 
     :cond_11
     const-string v0, "KNOX_SDK"
@@ -394,7 +394,7 @@
 
     if-eqz v0, :cond_13
 
-    goto :goto_3
+    goto :goto_4
 
     :cond_13
     const-string v0, "KNOX_DEVICE_MANAGER"
@@ -448,12 +448,13 @@
     :goto_3
     move v0, v1
 
-    goto :goto_4
+    goto :goto_5
 
     :cond_16
+    :goto_4
     move v0, v2
 
-    :goto_4
+    :goto_5
     iget-object p0, p0, Lcom/android/systemui/globalactions/presentation/features/GlobalActionFeatures;->mLogWrapper:Lcom/samsung/android/globalactions/util/LogWrapper;
 
     new-instance v1, Ljava/lang/StringBuilder;
diff --git a/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali b/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali
index 7e60944a..5e8ede38 100644
--- a/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali
+++ b/smali/com/android/systemui/keyguard/KeyguardViewMediator.smali
@@ -6754,7 +6754,7 @@
 
     invoke-virtual {v4}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
     if-nez v5, :cond_8
 
diff --git a/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali b/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali
index 7f08c5e5..b97bde72 100644
--- a/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali
+++ b/smali/com/android/systemui/keyguard/animator/ActionDownHandler.smali
@@ -476,7 +476,7 @@
 
     if-eqz v2, :cond_13
 
-    invoke-virtual {p0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea(Landroid/view/MotionEvent;)Z
+    invoke-virtual {p0}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea()Z
 
     move-result v2
 
@@ -577,7 +577,7 @@
     goto :goto_d
 
     :cond_16
-    invoke-virtual {p0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea(Landroid/view/MotionEvent;)Z
+    invoke-virtual {p0}, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->canLongPressArea()Z
 
     move-result p0
 
diff --git a/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali b/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali
index 8f32ba37..870ba417 100644
--- a/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali
+++ b/smali/com/android/systemui/keyguard/animator/FullScreenViewController.smali
@@ -425,9 +425,9 @@
 
     const-wide/16 v1, 0x3e8
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_10
+    if-gez p1, :cond_10
 
     const-string v5, "1"
 
@@ -436,9 +436,9 @@
     :cond_10
     const-wide/16 v1, 0x7d0
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_11
+    if-gez p1, :cond_11
 
     const-string v5, "2"
 
@@ -447,9 +447,9 @@
     :cond_11
     const-wide/16 v1, 0xfa0
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_12
+    if-gez p1, :cond_12
 
     const-string v5, "3"
 
@@ -458,9 +458,9 @@
     :cond_12
     const-wide/16 v1, 0x1b58
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_13
+    if-gez p1, :cond_13
 
     const-string v5, "4"
 
@@ -469,67 +469,34 @@
     :cond_13
     const-wide/16 v1, 0x2710
 
-    cmp-long v1, v6, v1
+    cmp-long p1, v6, v1
 
-    if-gez v1, :cond_14
+    if-gez p1, :cond_14
 
     const-string v5, "5"
 
     goto :goto_a
 
     :cond_14
-    if-ltz v1, :cond_15
+    if-ltz p1, :cond_15
 
     const-string v5, "6"
 
     :cond_15
     :goto_a
-    sget-object v1, Lcom/android/systemui/util/SystemUIAnalytics;->sCurrentScreenID:Ljava/lang/String;
+    sget-object p1, Lcom/android/systemui/util/SystemUIAnalytics;->sCurrentScreenID:Ljava/lang/String;
 
-    const-string v2, "1011"
+    const-string v1, "1011"
 
-    invoke-static {v1, v2, v5}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
+    invoke-static {p1, v1, v5}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
 
     :goto_b
-    iget-object v1, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
+    iget-object p1, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
 
-    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    const/4 v4, 0x2
-
-    if-eqz v2, :cond_17
-
-    iget-object v1, v1, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_17
-
-    const-string v2, "KeyguardFingerprint"
-
-    if-eqz p1, :cond_16
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    const-string p1, "onFullScreenModeChanged is true. FP will be stop!"
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    invoke-static {v2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->stopListeningForFingerprint()V
-
-    goto :goto_c
-
-    :cond_16
-    const-string p1, "onFullScreenModeChanged is false. FP will be start!"
-
-    invoke-static {v2, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {v1, v4}, Lcom/android/keyguard/KeyguardUpdateMonitor;->updateFingerprintListeningState(I)V
-
-    :cond_17
-    :goto_c
     invoke-virtual {p0}, Lcom/android/systemui/keyguard/animator/ViewAnimationController;->getParentView()Landroid/view/View;
 
     move-result-object p1
@@ -550,20 +517,20 @@
 
     move-result v0
 
-    if-nez v0, :cond_18
+    if-nez v0, :cond_16
 
-    goto :goto_e
+    goto :goto_d
 
-    :cond_18
+    :cond_16
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
     move-result v0
 
-    if-nez v0, :cond_1a
+    if-nez v0, :cond_18
 
     sget-boolean v0, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v0, :cond_19
+    if-eqz v0, :cond_17
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -575,21 +542,21 @@
 
     iget v0, v0, Landroid/content/res/Configuration;->semDisplayDeviceType:I
 
-    if-nez v0, :cond_19
+    if-nez v0, :cond_17
 
-    goto :goto_d
+    goto :goto_c
 
-    :cond_19
+    :cond_17
     move v9, v3
 
-    :cond_1a
-    :goto_d
-    if-eqz v9, :cond_1b
+    :cond_18
+    :goto_c
+    if-eqz v9, :cond_19
 
-    goto :goto_e
+    goto :goto_d
 
-    :cond_1b
-    if-eqz p0, :cond_1c
+    :cond_19
+    if-eqz p0, :cond_1a
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -601,7 +568,9 @@
 
     iget p0, p0, Landroid/content/res/Configuration;->orientation:I
 
-    if-ne p0, v4, :cond_1c
+    const/4 v0, 0x2
+
+    if-ne p0, v0, :cond_1a
 
     invoke-virtual {p1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -619,7 +588,7 @@
 
     invoke-virtual {p0}, Landroid/widget/Toast;->show()V
 
-    :cond_1c
-    :goto_e
+    :cond_1a
+    :goto_d
     return-void
 .end method
diff --git a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali
index b9bcd9be..4341b24a 100644
--- a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali
+++ b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator$2.smali
@@ -4,8 +4,6 @@
 
 
 # instance fields
-.field public final synthetic $keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
 .field public final synthetic $powerManager:Landroid/os/PowerManager;
 
 .field public final synthetic this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
@@ -17,8 +15,6 @@
 
     iput-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
-    iput-object p2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
     iput-object p3, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$powerManager:Landroid/os/PowerManager;
 
     invoke-direct {p0}, Landroid/view/GestureDetector$SimpleOnGestureListener;-><init>()V
@@ -47,7 +43,7 @@
 .end method
 
 .method public final onDoubleTapEvent(Landroid/view/MotionEvent;)Z
-    .locals 9
+    .locals 8
 
     invoke-virtual {p1}, Landroid/view/MotionEvent;->getAction()I
 
@@ -57,7 +53,7 @@
 
     const/4 v2, 0x1
 
-    if-ne v0, v2, :cond_a
+    if-ne v0, v2, :cond_9
 
     invoke-virtual {p1}, Landroid/view/MotionEvent;->getEventTime()J
 
@@ -93,19 +89,19 @@
 
     if-lez v0, :cond_1
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    new-instance p1, Ljava/lang/StringBuilder;
 
-    const-string v5, "isConsideredDoubleTap: time out deltaTime="
+    const-string v0, "isConsideredDoubleTap: time out deltaTime="
 
-    invoke-direct {v0, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
 
-    invoke-virtual {v0, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
+    invoke-virtual {p1, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object p1
 
-    invoke-static {v6, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v6, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     goto :goto_5
 
@@ -156,120 +152,109 @@
 
     invoke-virtual {p1}, Landroid/view/MotionEvent;->getY()F
 
-    move-result v4
+    move-result p1
 
-    float-to-int v4, v4
+    float-to-int p1, p1
 
-    sub-int/2addr v3, v4
+    sub-int/2addr v3, p1
 
-    iget-object v4, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
-    iget-object v4, v4, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->doubleTapDownEvent:Landroid/view/MotionEvent;
+    iget-object p1, p1, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->doubleTapDownEvent:Landroid/view/MotionEvent;
 
-    if-eqz v4, :cond_4
+    if-eqz p1, :cond_4
 
-    move-object v5, v4
+    move-object v5, p1
 
     :cond_4
     invoke-virtual {v5}, Landroid/view/MotionEvent;->getFlags()I
 
-    move-result v4
+    move-result p1
 
-    and-int/lit8 v4, v4, 0x8
+    and-int/lit8 p1, p1, 0x8
 
-    if-eqz v4, :cond_5
+    if-eqz p1, :cond_5
 
-    move v4, v2
+    move p1, v2
 
     goto :goto_3
 
     :cond_5
-    move v4, v1
+    move p1, v1
 
     :goto_3
-    if-eqz v4, :cond_6
+    if-eqz p1, :cond_6
 
-    move v4, v1
+    move p1, v1
 
     goto :goto_4
 
     :cond_6
-    iget-object v4, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
-    iget v4, v4, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->doubleTapSlop:I
+    iget p1, p1, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->doubleTapSlop:I
 
-    mul-int/2addr v4, v4
+    mul-int/2addr p1, p1
 
     :goto_4
-    mul-int v5, v0, v0
+    mul-int v4, v0, v0
 
-    mul-int v7, v3, v3
+    mul-int v5, v3, v3
 
-    add-int/2addr v7, v5
+    add-int/2addr v5, v4
 
-    if-lt v7, v4, :cond_7
+    if-lt v5, p1, :cond_7
 
-    const-string v4, "isConsideredDoubleTap: over slop="
+    const-string p1, "isConsideredDoubleTap: over slop="
 
-    const-string v5, ", deltaX="
+    const-string v4, ", deltaX="
 
-    const-string v8, ", deltaY="
+    const-string v7, ", deltaY="
 
-    invoke-static {v4, v7, v5, v0, v8}, Landroidx/recyclerview/widget/GridLayoutManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {p1, v5, v4, v0, v7}, Landroidx/recyclerview/widget/GridLayoutManager$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ILjava/lang/String;ILjava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v0
+    move-result-object p1
 
-    invoke-static {v0, v3, v6}, Landroidx/recyclerview/widget/RecyclerView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
+    invoke-static {p1, v3, v6}, Landroidx/recyclerview/widget/RecyclerView$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ILjava/lang/String;)V
 
     :goto_5
-    move v0, v1
+    move p1, v1
 
     goto :goto_6
 
     :cond_7
-    move v0, v2
+    move p1, v2
 
     :goto_6
-    if-eqz v0, :cond_8
-
-    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
-
-    iget-object v3, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->keyguardStateController:Lcom/android/systemui/statusbar/policy/KeyguardStateController;
+    if-eqz p1, :cond_8
 
-    check-cast v3, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
+    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->this$0:Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;
 
-    iget-boolean v3, v3, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mKeyguardGoingAway:Z
+    iget-object v0, p1, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->keyguardStateController:Lcom/android/systemui/statusbar/policy/KeyguardStateController;
 
-    if-nez v3, :cond_8
+    check-cast v0, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
 
-    iget-object v0, v0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
+    iget-boolean v0, v0, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mKeyguardGoingAway:Z
 
-    invoke-virtual {v0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->isFingerprintArea(Landroid/view/MotionEvent;)Z
+    if-nez v0, :cond_8
 
-    move-result p1
-
-    if-eqz p1, :cond_9
+    iget-object p1, p1, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
 
-    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
+    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-virtual {p1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
-
-    move-result p1
-
-    if-nez p1, :cond_8
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     goto :goto_7
 
     :cond_8
     move v2, v1
 
-    :cond_9
     :goto_7
     const-string p1, "onDoubleTapEvent executeDoubleTap="
 
     invoke-static {p1, v2, v6}, Lcom/android/keyguard/KeyguardCarrierPasswordViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;)V
 
-    if-eqz v2, :cond_a
+    if-eqz v2, :cond_9
 
     iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator$2;->$powerManager:Landroid/os/PowerManager;
 
@@ -291,6 +276,6 @@
 
     invoke-static {p0, p1}, Lcom/android/systemui/util/SystemUIAnalytics;->sendEventLog(Ljava/lang/String;Ljava/lang/String;)V
 
-    :cond_a
+    :cond_9
     return v1
 .end method
diff --git a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali
index b2df81a2..c265b1a8 100644
--- a/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali
+++ b/smali/com/android/systemui/keyguard/animator/KeyguardTouchAnimator.smali
@@ -281,40 +281,38 @@
 
 
 # virtual methods
-.method public final canLongPressArea(Landroid/view/MotionEvent;)Z
-    .locals 1
+.method public final canLongPressArea()Z
+    .locals 2
 
     iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->securityInjector:Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;
 
-    invoke-virtual {v0, p1}, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->isFingerprintArea(Landroid/view/MotionEvent;)Z
-
-    move-result p1
+    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    if-nez p1, :cond_0
+    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    iget-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->touchDownPos:Landroid/graphics/PointF;
+    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->touchDownPos:Landroid/graphics/PointF;
 
-    iget p1, p1, Landroid/graphics/PointF;->y:F
+    iget v0, v0, Landroid/graphics/PointF;->y:F
 
-    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->parentView$delegate:Lkotlin/Lazy;
+    iget-object v1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchAnimator;->parentView$delegate:Lkotlin/Lazy;
 
-    invoke-interface {v0}, Lkotlin/Lazy;->getValue()Ljava/lang/Object;
+    invoke-interface {v1}, Lkotlin/Lazy;->getValue()Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v1
 
-    check-cast v0, Landroid/view/View;
+    check-cast v1, Landroid/view/View;
 
-    invoke-virtual {v0}, Landroid/view/View;->getHeight()I
+    invoke-virtual {v1}, Landroid/view/View;->getHeight()I
 
-    move-result v0
+    move-result v1
 
     iget p0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchBase;->longPressAllowHeight:I
 
-    sub-int/2addr v0, p0
+    sub-int/2addr v1, p0
 
-    int-to-float p0, v0
+    int-to-float p0, v1
 
-    cmpg-float p0, p1, p0
+    cmpg-float p0, v0, p0
 
     if-gez p0, :cond_0
 
diff --git a/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali b/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali
index 2976a7bd..58611784 100644
--- a/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali
+++ b/smali/com/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector.smali
@@ -4,8 +4,6 @@
 
 
 # instance fields
-.field public final mFingerprintManager:Landroid/hardware/fingerprint/FingerprintManager;
-
 .field public final mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
 
@@ -17,84 +15,5 @@
 
     iput-object p1, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    if-eqz p2, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p2, 0x0
-
-    :goto_0
-    iput-object p2, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mFingerprintManager:Landroid/hardware/fingerprint/FingerprintManager;
-
     return-void
 .end method
-
-
-# virtual methods
-.method public final isFingerprintArea(Landroid/view/MotionEvent;)Z
-    .locals 2
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mFingerprintManager:Landroid/hardware/fingerprint/FingerprintManager;
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/systemui/keyguard/animator/KeyguardTouchSecurityInjector;->mKeyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p0}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    invoke-static {}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getCurrentUser()I
-
-    move-result v1
-
-    invoke-virtual {p0, v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->getUserCanSkipBouncer(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_0
-
-    invoke-virtual {v0}, Landroid/hardware/fingerprint/FingerprintManager;->semGetSensorAreaInDisplay()Landroid/graphics/Rect;
-
-    move-result-object p0
-
-    invoke-virtual {p1}, Landroid/view/MotionEvent;->getRawX()F
-
-    move-result v0
-
-    float-to-int v0, v0
-
-    invoke-virtual {p1}, Landroid/view/MotionEvent;->getRawY()F
-
-    move-result p1
-
-    float-to-int p1, p1
-
-    invoke-virtual {p0, v0, p1}, Landroid/graphics/Rect;->contains(II)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string p0, "KeyguardFingerPrintSwipe"
-
-    const-string p1, "mLongPressCallback canceled. Touch position is FP-InDisplay area!"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
diff --git a/smali/com/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor.smali b/smali/com/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor.smali
index 3ce107d2..d6dfc63a 100644
--- a/smali/com/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor.smali
+++ b/smali/com/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor.smali
@@ -1055,7 +1055,13 @@
 .method public final updateSideFpsVisibility()V
     .locals 9
 
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    const/4 v1, 0x1
+
+    const/4 v2, 0x0
+
+    if-nez v0, :cond_0
 
     iget-object v0, p0, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->context:Landroid/content/Context;
 
@@ -1063,53 +1069,61 @@
 
     move-result-object v0
 
-    const v1, 0x7f05003b
+    const v3, 0x7f05003b
 
-    invoke-virtual {v0, v1}, Landroid/content/res/Resources;->getBoolean(I)Z
+    invoke-virtual {v0, v3}, Landroid/content/res/Resources;->getBoolean(I)Z
 
     move-result v0
 
-    iget-object v1, p0, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
+    if-eqz v0, :cond_0
 
-    invoke-virtual {v1}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
+    move v0, v1
 
-    move-result v2
+    goto :goto_0
 
-    sget-object v3, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
+    :cond_0
+    move v0, v2
 
-    invoke-virtual {v1, v3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Landroid/hardware/biometrics/BiometricSourceType;)Z
+    :goto_0
+    iget-object v3, p0, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    move-result v1
+    invoke-virtual {v3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isFingerprintDetectionRunning()Z
 
-    invoke-virtual {p0}, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->isBouncerShowing()Z
+    move-result v4
+
+    sget-object v5, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
+
+    invoke-virtual {v3, v5}, Lcom/android/keyguard/KeyguardUpdateMonitor;->isUnlockingWithBiometricAllowed(Landroid/hardware/biometrics/BiometricSourceType;)Z
 
     move-result v3
 
-    if-eqz v3, :cond_0
+    invoke-virtual {p0}, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->isBouncerShowing()Z
+
+    move-result v5
 
-    if-eqz v0, :cond_0
+    if-eqz v5, :cond_1
 
-    if-eqz v2, :cond_0
+    if-eqz v0, :cond_1
 
-    if-eqz v1, :cond_0
+    if-eqz v4, :cond_1
 
-    invoke-virtual {p0}, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->isAnimatingAway()Z
+    if-eqz v3, :cond_1
 
-    move-result v3
+    invoke-virtual {p0}, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->isAnimatingAway()Z
 
-    if-nez v3, :cond_0
+    move-result v5
 
-    const/4 v3, 0x1
+    if-nez v5, :cond_1
 
-    goto :goto_0
+    goto :goto_1
 
-    :cond_0
-    const/4 v3, 0x0
+    :cond_1
+    move v1, v2
 
-    :goto_0
+    :goto_1
     invoke-virtual {p0}, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->isBouncerShowing()Z
 
-    move-result v4
+    move-result v2
 
     invoke-virtual {p0}, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->isAnimatingAway()Z
 
@@ -1121,21 +1135,21 @@
 
     const-string v8, "\nconfigEnabled="
 
-    invoke-static {v6, v3, v7, v4, v8}, Lcom/android/keyguard/KeyguardKnoxGuardViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;ZLjava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-static {v6, v1, v7, v2, v8}, Lcom/android/keyguard/KeyguardKnoxGuardViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;ZLjava/lang/String;ZLjava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v4
+    move-result-object v2
 
     const-string v6, "\nfpsDetectionRunning="
 
     const-string v7, "\nisUnlockingWithFpAllowed="
 
-    invoke-static {v4, v0, v6, v2, v7}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v2, v0, v6, v4, v7}, Lcom/android/keyguard/KeyguardFaceListenModel$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
     const-string v0, "\nisAnimatingAway="
 
-    const-string v2, "PrimaryBouncerInteractor"
+    const-string v4, "PrimaryBouncerInteractor"
 
-    invoke-static {v4, v1, v0, v5, v2}, Lcom/android/keyguard/KeyguardCarrierViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
+    invoke-static {v2, v3, v0, v5, v4}, Lcom/android/keyguard/KeyguardCarrierViewController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;ZLjava/lang/String;ZLjava/lang/String;)V
 
     iget-object p0, p0, Lcom/android/systemui/keyguard/domain/interactor/PrimaryBouncerInteractor;->repository:Lcom/android/systemui/keyguard/data/repository/KeyguardBouncerRepository;
 
@@ -1143,7 +1157,7 @@
 
     iget-object p0, p0, Lcom/android/systemui/keyguard/data/repository/KeyguardBouncerRepositoryImpl;->_sideFpsShowing:Lkotlinx/coroutines/flow/StateFlowImpl;
 
-    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    invoke-static {v1}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
     move-result-object v0
 
diff --git a/smali/com/android/systemui/power/PowerUI$Receiver.smali b/smali/com/android/systemui/power/PowerUI$Receiver.smali
index de355ae7..96c50bb6 100644
--- a/smali/com/android/systemui/power/PowerUI$Receiver.smali
+++ b/smali/com/android/systemui/power/PowerUI$Receiver.smali
@@ -1937,6 +1937,23 @@
     iput-object v1, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
     :cond_49
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v0, :cond_mesa
+
+    const-class v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
+
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
+
+    check-cast v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
+
+    const/4 v2, 0x1
+
+    invoke-interface {v0, v2}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->setShowingKeepScreenOnPopup(Z)V
+
+    :cond_mesa
     const/4 v0, 0x1
 
     iput-boolean v0, v1, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mIsUnintentionalPopupShowing:Z
diff --git a/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali b/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali
index 2868e8f2..25d006ee 100644
--- a/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali
+++ b/smali/com/android/systemui/power/SecPowerNotificationWarnings.smali
@@ -549,7 +549,7 @@
 .end method
 
 .method public final declared-synchronized dismissUnintentionalLcdOnWindow()V
-    .locals 3
+    .locals 4
 
     monitor-enter p0
 
@@ -568,39 +568,51 @@
 
     const/4 v1, 0x0
 
+    const/4 v2, 0x0
+
     if-eqz v0, :cond_1
 
-    iget-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
+    iget-object v3, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
 
-    invoke-interface {v2, v0}, Landroid/view/WindowManager;->removeView(Landroid/view/View;)V
+    invoke-interface {v3, v0}, Landroid/view/WindowManager;->removeView(Landroid/view/View;)V
 
     iget-object v0, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    const/16 v2, 0x8
+    const/16 v3, 0x8
 
-    invoke-virtual {v0, v2}, Landroid/widget/LinearLayout;->setVisibility(I)V
+    invoke-virtual {v0, v3}, Landroid/widget/LinearLayout;->setVisibility(I)V
 
     iget-object v0, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    iget-object v2, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
+    iget-object v3, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
-    if-ne v2, p0, :cond_0
+    if-ne v3, p0, :cond_0
 
-    iput-object v1, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
+    iput-object v2, v0, Lcom/android/systemui/power/UnintentionalLcdOnView;->mTouchListener:Lcom/android/systemui/power/SecPowerNotificationWarnings;
 
     :cond_0
-    iput-object v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
+    iput-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLcdOnWindow:Lcom/android/systemui/power/UnintentionalLcdOnView;
 
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mIsUnintentionalPopupShowing:Z
+    iput-boolean v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mIsUnintentionalPopupShowing:Z
 
     :cond_1
-    iput-object v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
+    iput-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mWindowManager:Landroid/view/WindowManager;
+
+    iput-object v2, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
+
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v0, :cond_2
+
+    const-class v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
+
+    invoke-static {v0}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+
+    move-result-object v0
 
-    iput-object v1, p0, Lcom/android/systemui/power/SecPowerNotificationWarnings;->mUnintentionalLCDOnWindowLp:Landroid/view/WindowManager$LayoutParams;
+    check-cast v0, Lcom/android/keyguard/KeyguardUpdateMonitor;
 
-    sget-object v0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    invoke-interface {v0, v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->setShowingKeepScreenOnPopup(Z)V
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
diff --git a/smali/com/android/systemui/shade/NotificationPanelViewController.smali b/smali/com/android/systemui/shade/NotificationPanelViewController.smali
index 958f7be0..13eaeb9a 100644
--- a/smali/com/android/systemui/shade/NotificationPanelViewController.smali
+++ b/smali/com/android/systemui/shade/NotificationPanelViewController.smali
@@ -51,6 +51,8 @@
 
 .field public mBarState:I
 
+.field public mBioUnlockControllerLazy:Ldagger/Lazy;
+
 .field public mBlockingExpansionForCurrentTouch:Z
 
 .field public mBottomAreaShadeAlpha:F
@@ -9887,33 +9889,6 @@
     invoke-virtual {v2}, Landroid/widget/FrameLayout;->bringToFront()V
 
     :cond_b
-    sget-boolean v2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_GUIDE_POPUP:Z
-
-    if-eqz v2, :cond_c
-
-    const v2, 0x7f0a0505
-
-    invoke-virtual {v1, v2}, Landroid/widget/FrameLayout;->findViewById(I)Landroid/view/View;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/view/ViewStub;
-
-    const v3, 0x7f0d013e
-
-    invoke-virtual {v2, v3}, Landroid/view/ViewStub;->setLayoutResource(I)V
-
-    invoke-virtual {v2}, Landroid/view/ViewStub;->inflate()Landroid/view/View;
-
-    move-result-object v2
-
-    check-cast v2, Lcom/android/keyguard/biometrics/KeyguardFingerprintGuidePopup;
-
-    if-eqz v2, :cond_c
-
-    invoke-virtual {v2}, Landroid/widget/FrameLayout;->bringToFront()V
-
-    :cond_c
     iget-object v2, v0, Lcom/android/systemui/shade/NotificationPanelViewController;->mWakeUpCoordinator:Lcom/android/systemui/statusbar/notification/NotificationWakeUpCoordinator;
 
     iput-object v5, v2, Lcom/android/systemui/statusbar/notification/NotificationWakeUpCoordinator;->mStackScrollerController:Lcom/android/systemui/statusbar/notification/stack/NotificationStackScrollLayoutController;
@@ -9958,7 +9933,7 @@
 
     sget-boolean v2, Lcom/android/systemui/LsRune;->KEYGUARD_DCM_LIVE_UX:Z
 
-    if-eqz v2, :cond_f
+    if-eqz v2, :cond_e
 
     new-instance v2, Lcom/android/systemui/shade/NotificationPanelViewController$7;
 
@@ -9998,11 +9973,11 @@
 
     iget-object v2, v3, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->injector:Lcom/android/systemui/shade/NotificationPanelViewController$7;
 
-    if-nez v2, :cond_d
+    if-nez v2, :cond_c
 
     const/4 v2, 0x0
 
-    :cond_d
+    :cond_c
     iget-object v2, v2, Lcom/android/systemui/shade/NotificationPanelViewController$7;->this$0:Lcom/android/systemui/shade/NotificationPanelViewController;
 
     iget-object v2, v2, Lcom/android/systemui/shade/NotificationPanelViewController;->mNotificationContainerParent:Lcom/android/systemui/shade/NotificationsQuickSettingsContainer;
@@ -10079,7 +10054,7 @@
 
     iget-boolean v2, v3, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->isBootCompleted:Z
 
-    if-eqz v2, :cond_e
+    if-eqz v2, :cond_d
 
     iget-object v2, v3, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->remoteViews:Landroid/widget/RemoteViews;
 
@@ -10087,7 +10062,7 @@
 
     goto :goto_3
 
-    :cond_e
+    :cond_d
     const/4 v2, 0x1
 
     iput-boolean v2, v3, Lcom/android/systemui/statusbar/phone/DcmMascotViewContainer;->isWaitingForBootComplete:Z
@@ -10107,14 +10082,14 @@
 
     invoke-virtual {v2, v3}, Lcom/android/keyguard/KeyguardUpdateMonitor;->registerCallback(Lcom/android/keyguard/KeyguardUpdateMonitorCallback;)V
 
-    :cond_f
+    :cond_e
     iget-boolean v2, v0, Lcom/android/systemui/shade/NotificationPanelViewController;->mSplitShadeEnabled:Z
 
-    if-eqz v2, :cond_10
+    if-eqz v2, :cond_f
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/systemui/shade/NotificationPanelViewController;->updateResources()V
 
-    :cond_10
+    :cond_f
     iget-object v2, v0, Lcom/android/systemui/shade/NotificationPanelViewController;->mTapAgainViewController:Lcom/android/systemui/statusbar/phone/TapAgainViewController;
 
     invoke-virtual {v2}, Lcom/android/systemui/util/ViewController;->init()V
@@ -10329,23 +10304,23 @@
 
     move-result v1
 
-    if-eqz v1, :cond_11
+    if-eqz v1, :cond_10
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
     move-result v1
 
-    if-nez v1, :cond_11
+    if-nez v1, :cond_10
 
     sget-boolean v1, Lcom/android/systemui/LsRune;->LOCKUI_SUB_DISPLAY_LOCK:Z
 
-    if-nez v1, :cond_11
+    if-nez v1, :cond_10
 
     move v9, v8
 
     goto :goto_4
 
-    :cond_11
+    :cond_10
     move v9, v4
 
     :goto_4
@@ -16232,7 +16207,7 @@
 .end method
 
 .method public final updateVisibility()V
-    .locals 7
+    .locals 8
 
     iget-boolean v0, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mHeadsUpAnimatingAway:Z
 
@@ -16264,7 +16239,9 @@
 
     iput v4, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
-    if-nez v0, :cond_8
+    const/4 v5, 0x4
+
+    if-nez v0, :cond_9
 
     iput v4, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
@@ -16279,36 +16256,36 @@
     :cond_2
     if-eqz v4, :cond_3
 
-    iget-boolean v5, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mBouncerShowing:Z
+    iget-boolean v6, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mBouncerShowing:Z
 
-    if-eqz v5, :cond_3
+    if-eqz v6, :cond_3
 
     iput v2, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
     move v4, v1
 
     :cond_3
-    sget-boolean v5, Lcom/android/systemui/LsRune;->KEYGUARD_SUB_DISPLAY_LOCK:Z
+    sget-boolean v6, Lcom/android/systemui/LsRune;->KEYGUARD_SUB_DISPLAY_LOCK:Z
 
-    if-eqz v5, :cond_4
+    if-eqz v6, :cond_4
 
     if-eqz v4, :cond_4
 
-    const-class v5, Lcom/android/systemui/keyguard/KeyguardFoldController;
+    const-class v6, Lcom/android/systemui/keyguard/KeyguardFoldController;
 
-    invoke-static {v5}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {v6}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v6
 
-    check-cast v5, Lcom/android/systemui/keyguard/KeyguardFoldController;
+    check-cast v6, Lcom/android/systemui/keyguard/KeyguardFoldController;
 
-    check-cast v5, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;
+    check-cast v6, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;
 
-    invoke-virtual {v5}, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;->isUnlockOnFoldOpened()Z
+    invoke-virtual {v6}, Lcom/android/systemui/keyguard/KeyguardFoldControllerImpl;->isUnlockOnFoldOpened()Z
 
-    move-result v5
+    move-result v6
 
-    if-eqz v5, :cond_4
+    if-eqz v6, :cond_4
 
     const/4 v4, 0x2
 
@@ -16317,43 +16294,43 @@
     move v4, v1
 
     :cond_4
-    sget-boolean v5, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
+    sget-boolean v6, Lcom/android/systemui/LsRune;->SECURITY_SWIPE_BOUNCER:Z
 
-    if-eqz v5, :cond_6
+    if-eqz v6, :cond_6
 
     if-eqz v4, :cond_6
 
-    const-class v5, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
+    const-class v6, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
 
-    invoke-static {v5}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {v6}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v6
 
-    check-cast v5, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
+    check-cast v6, Lcom/android/systemui/statusbar/policy/KeyguardStateController;
 
-    check-cast v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
+    check-cast v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;
 
-    iget-boolean v6, v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mIsSwipeBouncer:Z
+    iget-boolean v7, v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mIsSwipeBouncer:Z
 
-    if-eqz v6, :cond_5
+    if-eqz v7, :cond_5
 
-    iget-boolean v6, v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mCanDismissLockScreen:Z
+    iget-boolean v7, v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mCanDismissLockScreen:Z
 
-    if-eqz v6, :cond_5
+    if-eqz v7, :cond_5
 
-    iget-boolean v5, v5, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mShowing:Z
+    iget-boolean v6, v6, Lcom/android/systemui/statusbar/policy/KeyguardStateControllerImpl;->mShowing:Z
 
-    if-eqz v5, :cond_5
+    if-eqz v6, :cond_5
 
-    move v5, v2
+    move v6, v2
 
     goto :goto_2
 
     :cond_5
-    move v5, v1
+    move v6, v1
 
     :goto_2
-    if-eqz v5, :cond_6
+    if-eqz v6, :cond_6
 
     const/4 v4, 0x3
 
@@ -16362,43 +16339,78 @@
     move v4, v1
 
     :cond_6
-    if-eqz v4, :cond_7
+    sget-boolean v6, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    goto :goto_3
+    if-eqz v6, :cond_7
+
+    invoke-virtual {p0}, Lcom/android/systemui/shade/NotificationPanelViewController;->isKeyguardShowing()Z
+
+    move-result v6
+
+    if-eqz v6, :cond_7
+
+    invoke-static {}, Lcom/android/systemui/wallpaper/WallpaperUtils;->isLiveWallpaperEnabled()Z
+
+    move-result v6
+
+    if-eqz v6, :cond_7
+
+    iget-object v6, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
+
+    invoke-interface {v6}, Ldagger/Lazy;->get()Ljava/lang/Object;
+
+    move-result-object v6
+
+    check-cast v6, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;
+
+    invoke-virtual {v6}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isWakeAndUnlock()Z
+
+    move-result v6
+
+    if-eqz v6, :cond_7
+
+    iput v5, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
+
+    move v4, v1
 
     :cond_7
+    if-eqz v4, :cond_8
+
+    goto :goto_3
+
+    :cond_8
     move v4, v1
 
     goto :goto_4
 
-    :cond_8
+    :cond_9
     :goto_3
     move v4, v2
 
     :goto_4
-    iget v5, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
+    iget v6, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mPanelInVisibleReason:I
 
     iget-object p0, p0, Lcom/android/systemui/shade/NotificationPanelViewController;->mView:Lcom/android/systemui/shade/NotificationPanelView;
 
     invoke-virtual {p0}, Landroid/widget/FrameLayout;->getVisibility()I
 
-    move-result v6
+    move-result v7
 
-    if-nez v6, :cond_9
+    if-nez v7, :cond_a
 
     goto :goto_5
 
-    :cond_9
+    :cond_a
     move v2, v1
 
     :goto_5
-    if-ne v2, v4, :cond_a
+    if-ne v2, v4, :cond_b
 
-    if-nez v4, :cond_b
+    if-nez v4, :cond_c
 
-    if-eq v3, v5, :cond_b
+    if-eq v3, v6, :cond_c
 
-    :cond_a
+    :cond_b
     invoke-static {v4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
     move-result-object v2
@@ -16407,7 +16419,7 @@
 
     move-result-object v0
 
-    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v3
 
@@ -16421,13 +16433,13 @@
 
     invoke-static {v2, v3, v0}, Lcom/android/systemui/keyguard/Log;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_b
-    if-eqz v4, :cond_c
+    :cond_c
+    if-eqz v4, :cond_d
 
     goto :goto_6
 
-    :cond_c
-    const/4 v1, 0x4
+    :cond_d
+    move v1, v5
 
     :goto_6
     invoke-virtual {p0, v1}, Landroid/widget/FrameLayout;->setVisibility(I)V
diff --git a/smali/com/android/systemui/shade/NotificationPanelViewController_Factory.smali b/smali/com/android/systemui/shade/NotificationPanelViewController_Factory.smali
index 3e546948..2cd927fa 100644
--- a/smali/com/android/systemui/shade/NotificationPanelViewController_Factory.smali
+++ b/smali/com/android/systemui/shade/NotificationPanelViewController_Factory.smali
@@ -2022,5 +2022,9 @@
 
     invoke-static {v0}, Ldagger/internal/DoubleCheck;->lazy(Ljavax/inject/Provider;)Ldagger/Lazy;
 
+    move-result-object v0
+
+    iput-object v0, v1, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
+
     return-object v1
 .end method
diff --git a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda4.smali b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda4.smali
index 082e2474..9c2dcbe1 100644
--- a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda4.smali
+++ b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda4.smali
@@ -24,77 +24,36 @@
 
 # virtual methods
 .method public final run()V
-    .locals 3
+    .locals 2
 
     iget-object p0, p0, Lcom/android/systemui/statusbar/KeyguardSecIndicationController$$ExternalSyntheticLambda4;->f$0:Lcom/android/systemui/statusbar/KeyguardSecIndicationController;
 
     invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    iget-object v1, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mContext:Landroid/content/Context;
+    if-eqz v0, :cond_0
 
-    if-eqz v0, :cond_3
-
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
-
-    move-result-object v0
-
-    iget-object v0, v0, Landroid/content/res/Configuration;->windowConfiguration:Landroid/app/WindowConfiguration;
-
-    invoke-virtual {v0}, Landroid/app/WindowConfiguration;->getRotation()I
-
-    move-result v0
-
-    const/4 v2, 0x1
-
-    if-eq v0, v2, :cond_2
-
-    const/4 v2, 0x2
-
-    if-eq v0, v2, :cond_1
-
-    const/4 v2, 0x3
-
-    if-eq v0, v2, :cond_0
-
-    const v0, 0x7f130852
+    const v0, 0x7f13094a
 
     goto :goto_0
 
     :cond_0
-    const v0, 0x7f130854
-
-    goto :goto_0
-
-    :cond_1
-    const v0, 0x7f130853
-
-    goto :goto_0
-
-    :cond_2
-    const v0, 0x7f130855
-
-    goto :goto_0
-
-    :cond_3
     const/4 v0, 0x0
 
     :goto_0
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_1
+
+    iget-object v1, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mTopIndicationView:Lcom/android/systemui/statusbar/phone/KeyguardIndicationTextView;
 
-    iget-object p0, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mTopIndicationView:Lcom/android/systemui/statusbar/phone/KeyguardIndicationTextView;
+    iget-object p0, p0, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mContext:Landroid/content/Context;
 
-    invoke-virtual {v1, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
+    invoke-virtual {p0, v0}, Landroid/content/Context;->getString(I)Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object p0
 
-    invoke-virtual {p0, v0}, Landroid/widget/TextView;->announceForAccessibility(Ljava/lang/CharSequence;)V
+    invoke-virtual {v1, p0}, Landroid/widget/TextView;->announceForAccessibility(Ljava/lang/CharSequence;)V
 
-    :cond_4
+    :cond_1
     return-void
 .end method
diff --git a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali
index cf3d422b..7dce1107 100644
--- a/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali
+++ b/smali_classes2/com/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback.smali
@@ -378,7 +378,7 @@
 
     if-ne v0, v3, :cond_d
 
-    sput v5, Lcom/android/systemui/util/DeviceType;->supportSideFingerprint:I
+    sput v4, Lcom/android/systemui/util/DeviceType;->supportSideFingerprint:I
 
     :cond_d
     sget v0, Lcom/android/systemui/util/DeviceType;->supportSideFingerprint:I
@@ -561,11 +561,11 @@
 
     const/4 v4, 0x2
 
-    if-ne v2, v4, :cond_16
+    if-ne v2, v4, :cond_15
 
     iget-boolean p3, p3, Lcom/android/keyguard/KeyguardUpdateMonitor;->mGoingToSleep:Z
 
-    if-nez p3, :cond_16
+    if-nez p3, :cond_15
 
     iget-object p3, v1, Lcom/android/systemui/statusbar/KeyguardIndicationController;->mContext:Landroid/content/Context;
 
@@ -681,11 +681,7 @@
 
     if-eqz p3, :cond_d
 
-    sget-boolean p3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p3, :cond_d
-
-    if-eq p2, v4, :cond_15
+    sget-object p3, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_d
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
@@ -719,7 +715,7 @@
 
     if-ne p2, v8, :cond_f
 
-    sput v3, Lcom/android/systemui/util/DeviceType;->supportSideFingerprint:I
+    sput v0, Lcom/android/systemui/util/DeviceType;->supportSideFingerprint:I
 
     :cond_f
     sget p2, Lcom/android/systemui/util/DeviceType;->supportSideFingerprint:I
@@ -774,9 +770,8 @@
     :goto_5
     invoke-static {v1, p1, v5}, Lcom/android/systemui/statusbar/KeyguardSecIndicationController;->-$$Nest$mupdateBiometricErrorMessage(Lcom/android/systemui/statusbar/KeyguardSecIndicationController;ILjava/lang/CharSequence;)V
 
-    :cond_15
     :goto_6
-    if-ne p1, v8, :cond_16
+    if-ne p1, v8, :cond_15
 
     iget-object p1, v1, Lcom/android/systemui/statusbar/KeyguardSecIndicationController;->mAccessibilityManager:Landroid/view/accessibility/AccessibilityManager;
 
@@ -784,13 +779,13 @@
 
     move-result p1
 
-    if-eqz p1, :cond_16
+    if-eqz p1, :cond_15
 
     invoke-interface {v9}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isMaxFailedBiometricUnlockAttemptsShort()Z
 
     move-result p1
 
-    if-nez p1, :cond_16
+    if-nez p1, :cond_15
 
     sget-object p1, Lcom/android/systemui/statusbar/IndicationEventType;->UNLOCK_GUIDE:Lcom/android/systemui/statusbar/IndicationEventType;
 
@@ -814,7 +809,7 @@
 
     invoke-virtual {p1, p2}, Lio/reactivex/Completable;->subscribe(Lio/reactivex/functions/Action;)V
 
-    :cond_16
+    :cond_15
     :goto_7
     iput v8, p0, Lcom/android/systemui/statusbar/KeyguardSecIndicationController$SecKeyguardCallback;->mLastSuccessiveErrorMessage:I
 
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali b/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali
index 409b81d2..8fff31d9 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/BiometricUnlockController.smali
@@ -1528,43 +1528,51 @@
 .end method
 
 .method public final onBiometricHelp(ILjava/lang/String;Landroid/hardware/biometrics/BiometricSourceType;)V
-    .locals 0
+    .locals 2
 
-    sget-object p1, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
+    sget-object v0, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
 
-    invoke-virtual {p3, p1}, Landroid/hardware/biometrics/BiometricSourceType;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {p3, v0}, Landroid/hardware/biometrics/BiometricSourceType;->equals(Ljava/lang/Object;)Z
 
-    move-result p1
+    move-result v0
 
-    if-nez p1, :cond_0
+    if-nez v0, :cond_0
 
     return-void
 
     :cond_0
     invoke-static {p2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
 
-    move-result p1
+    move-result v0
 
-    if-eqz p1, :cond_1
+    if-eqz v0, :cond_1
 
     return-void
 
     :cond_1
-    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
 
-    const/4 p1, 0x0
+    const/4 v1, 0x0
+
+    if-eqz v0, :cond_2
 
-    invoke-virtual {p0, p3, p1}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->vibrate(Landroid/hardware/biometrics/BiometricSourceType;Z)V
+    const/4 v0, -0x1
 
-    sget-boolean p3, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
+    if-ne p1, v0, :cond_3
 
-    if-eqz p3, :cond_2
+    :cond_2
+    invoke-virtual {p0, p3, v1}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->vibrate(Landroid/hardware/biometrics/BiometricSourceType;Z)V
 
-    invoke-virtual {p0, p1}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
+    :cond_3
+    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_BACKGROUND_AUTHENTICATION:Z
+
+    if-eqz p1, :cond_4
+
+    invoke-virtual {p0, v1}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isUpdatePossible(Z)Z
 
     move-result p1
 
-    if-eqz p1, :cond_2
+    if-eqz p1, :cond_4
 
     iget-object p0, p0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mBiometricToastView:Lcom/android/keyguard/biometrics/KeyguardBiometricToastView;
 
@@ -1572,7 +1580,7 @@
 
     invoke-virtual {p0, p1, p2}, Lcom/android/keyguard/biometrics/KeyguardBiometricToastView;->update(Lcom/android/keyguard/biometrics/KeyguardBiometricToastView$ToastType;Ljava/lang/String;)V
 
-    :cond_2
+    :cond_4
     return-void
 .end method
 
@@ -1852,7 +1860,7 @@
 
     const/4 v10, 0x6
 
-    if-eqz v8, :cond_a
+    if-eqz v8, :cond_b
 
     iget v8, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
@@ -1934,9 +1942,9 @@
     goto :goto_1
 
     :cond_3
-    if-eqz v11, :cond_6
+    if-eqz v11, :cond_7
 
-    if-nez v12, :cond_6
+    if-nez v12, :cond_7
 
     if-eq v8, v6, :cond_5
 
@@ -1949,7 +1957,7 @@
     goto :goto_1
 
     :cond_4
-    if-nez v13, :cond_6
+    if-nez v13, :cond_7
 
     const/4 v14, 0x0
 
@@ -1962,8 +1970,19 @@
     goto :goto_1
 
     :cond_5
-    sget-object v14, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
+    sget-boolean v14, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_SIDE:Z
+
+    if-eqz v14, :cond_6
+
+    iget-object v14, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->settingsHelper:Lcom/android/systemui/util/SettingsHelper;
+
+    invoke-virtual {v14}, Lcom/android/systemui/util/SettingsHelper;->isEnabledWof()Z
+
+    move-result v14
+
+    if-eqz v14, :cond_7
 
+    :cond_6
     invoke-virtual {v7, v6}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->setWakeAndUnlock(Z)V
 
     iget-object v14, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->windowVisibilityController:Lcom/android/systemui/keyguard/WindowVisibilityController;
@@ -1974,11 +1993,11 @@
 
     iput-boolean v14, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->needsBlankScreen:Z
 
-    :cond_6
+    :cond_7
     :goto_1
     iget-object v14, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->curVisibilityController:Lcom/android/systemui/keyguard/VisibilityController;
 
-    if-eqz v14, :cond_7
+    if-eqz v14, :cond_8
 
     invoke-virtual {v14}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
@@ -1996,18 +2015,18 @@
 
     invoke-static {v14}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->logD(Ljava/lang/String;)V
 
-    :cond_7
+    :cond_8
     invoke-virtual {v7}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isFastWakeAndUnlockMode()Z
 
     move-result v14
 
-    if-nez v14, :cond_8
+    if-nez v14, :cond_9
 
     invoke-virtual {v7}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isFastUnlockMode()Z
 
     move-result v15
 
-    if-nez v15, :cond_8
+    if-nez v15, :cond_9
 
     const-string v14, "not supported mode="
 
@@ -2037,18 +2056,18 @@
 
     goto :goto_3
 
-    :cond_8
-    if-eqz v14, :cond_9
+    :cond_9
+    if-eqz v14, :cond_a
 
     iget-boolean v8, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->needsBlankScreen:Z
 
-    if-eqz v8, :cond_9
+    if-eqz v8, :cond_a
 
     move v8, v6
 
     goto :goto_2
 
-    :cond_9
+    :cond_a
     const/4 v8, 0x0
 
     :goto_2
@@ -2073,7 +2092,7 @@
     :goto_3
     iget-boolean v8, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isBrightnessChangedCallbackRegistered:Z
 
-    if-eqz v8, :cond_a
+    if-eqz v8, :cond_b
 
     const-string/jumbo v8, "unregisterBrightnessListener"
 
@@ -2091,10 +2110,10 @@
 
     iput-boolean v8, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->isBrightnessChangedCallbackRegistered:Z
 
-    :cond_a
+    :cond_b
     iget v8, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
-    if-ne v8, v10, :cond_b
+    if-ne v8, v10, :cond_c
 
     iget-object v8, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mPowerManager:Landroid/os/PowerManager;
 
@@ -2102,31 +2121,31 @@
 
     move-result v8
 
-    if-eqz v8, :cond_b
+    if-eqz v8, :cond_c
 
     move v8, v6
 
     goto :goto_4
 
-    :cond_b
+    :cond_c
     const/4 v8, 0x0
 
     :goto_4
     iget v9, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
-    if-eqz v9, :cond_e
+    if-eqz v9, :cond_f
 
-    if-nez v8, :cond_e
+    if-nez v8, :cond_f
 
-    if-eqz v3, :cond_c
+    if-eqz v3, :cond_d
 
-    if-ne v1, v10, :cond_d
+    if-ne v1, v10, :cond_e
 
     iget-boolean v1, v2, Lcom/android/keyguard/KeyguardUpdateMonitor;->mIsDreaming:Z
 
-    if-eqz v1, :cond_d
+    if-eqz v1, :cond_e
 
-    :cond_c
+    :cond_d
     const-string v19, "bio wakelock: Authenticated, waking up..."
 
     iget-object v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mLogger:Lcom/android/keyguard/logging/BiometricUnlockLogger;
@@ -2157,7 +2176,7 @@
 
     invoke-virtual {v7, v1, v3}, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->submit(Ljava/lang/Runnable;Ljava/lang/String;)V
 
-    :cond_d
+    :cond_e
     const-string/jumbo v1, "release wake-and-unlock"
 
     invoke-static {v1}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2166,30 +2185,30 @@
 
     invoke-static {}, Landroid/os/Trace;->endSection()V
 
-    :cond_e
+    :cond_f
     iget v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
-    if-eq v1, v6, :cond_14
+    if-eq v1, v6, :cond_15
 
-    if-eq v1, v5, :cond_14
+    if-eq v1, v5, :cond_15
 
     const/4 v3, 0x3
 
-    if-eq v1, v3, :cond_13
+    if-eq v1, v3, :cond_14
 
     const/4 v3, 0x5
 
-    if-eq v1, v3, :cond_10
+    if-eq v1, v3, :cond_11
 
-    if-eq v1, v10, :cond_14
+    if-eq v1, v10, :cond_15
 
     const/4 v2, 0x7
 
-    if-eq v1, v2, :cond_f
+    if-eq v1, v2, :cond_10
 
     goto/16 :goto_7
 
-    :cond_f
+    :cond_10
     const-string v1, "MODE_DISMISS_BOUNCER"
 
     invoke-static {v1}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2204,7 +2223,7 @@
 
     goto/16 :goto_7
 
-    :cond_10
+    :cond_11
     const-string v1, "MODE_UNLOCK_COLLAPSING"
 
     invoke-static {v1}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2213,17 +2232,17 @@
 
     move-result v1
 
-    if-eqz v1, :cond_12
+    if-eqz v1, :cond_13
 
     iget-boolean v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mBouncer:Z
 
-    if-nez v1, :cond_11
+    if-nez v1, :cond_12
 
     iget-object v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mAuthenticatedBioSourceType:Landroid/hardware/biometrics/BiometricSourceType;
 
     sget-object v2, Landroid/hardware/biometrics/BiometricSourceType;->FACE:Landroid/hardware/biometrics/BiometricSourceType;
 
-    if-ne v1, v2, :cond_11
+    if-ne v1, v2, :cond_12
 
     iget-object v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mKeyguardBypassController:Lcom/android/systemui/statusbar/phone/KeyguardBypassController;
 
@@ -2231,27 +2250,27 @@
 
     move-result v1
 
-    if-eqz v1, :cond_11
+    if-eqz v1, :cond_12
 
     invoke-static {}, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->isLargeCoverScreen()Z
 
     move-result v1
 
-    if-eqz v1, :cond_12
+    if-eqz v1, :cond_13
 
-    :cond_11
+    :cond_12
     iget-object v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mKeyguardViewController:Lcom/android/keyguard/KeyguardViewController;
 
     const/4 v2, 0x0
 
     invoke-interface {v1, v2}, Lcom/android/keyguard/KeyguardViewController;->notifyKeyguardAuthenticated(Z)V
 
-    :cond_12
+    :cond_13
     invoke-static {}, Landroid/os/Trace;->endSection()V
 
     goto :goto_7
 
-    :cond_13
+    :cond_14
     const-string v1, "MODE_SHOW_BOUNCER"
 
     invoke-static {v1}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2264,8 +2283,8 @@
 
     goto :goto_7
 
-    :cond_14
-    if-ne v1, v5, :cond_15
+    :cond_15
+    if-ne v1, v5, :cond_16
 
     const-string v1, "MODE_WAKE_AND_UNLOCK_PULSING"
 
@@ -2279,8 +2298,8 @@
 
     goto :goto_5
 
-    :cond_15
-    if-ne v1, v6, :cond_16
+    :cond_16
+    if-ne v1, v6, :cond_17
 
     const-string v1, "MODE_WAKE_AND_UNLOCK"
 
@@ -2288,7 +2307,7 @@
 
     goto :goto_5
 
-    :cond_16
+    :cond_17
     const-string v1, "MODE_WAKE_AND_UNLOCK_FROM_DREAM"
 
     invoke-static {v1}, Landroid/os/Trace;->beginSection(Ljava/lang/String;)V
@@ -2298,11 +2317,11 @@
 
     move-result v1
 
-    if-eqz v1, :cond_17
+    if-eqz v1, :cond_18
 
     iget-boolean v1, v7, Lcom/android/systemui/keyguard/KeyguardFastBioUnlockController;->needsBlankScreen:Z
 
-    if-nez v1, :cond_17
+    if-nez v1, :cond_18
 
     const/4 v1, 0x0
 
@@ -2310,7 +2329,7 @@
 
     goto :goto_6
 
-    :cond_17
+    :cond_18
     const/4 v1, 0x0
 
     :goto_6
@@ -2329,7 +2348,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_18
+    if-eqz v1, :cond_19
 
     iget v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
@@ -2345,13 +2364,13 @@
 
     move-result v1
 
-    if-nez v1, :cond_19
+    if-nez v1, :cond_1a
 
     invoke-interface {v0, v2}, Ljava/util/List;->add(Ljava/lang/Object;)Z
 
     goto :goto_9
 
-    :cond_18
+    :cond_19
     iget v1, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mMode:I
 
     iget-object v0, v0, Lcom/android/systemui/statusbar/phone/BiometricUnlockController;->mBiometricUnlockEventsListeners:Ljava/util/Set;
@@ -2367,7 +2386,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_19
+    if-eqz v2, :cond_1a
 
     invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -2379,7 +2398,7 @@
 
     goto :goto_8
 
-    :cond_19
+    :cond_1a
     :goto_9
     const-string/jumbo v0, "startWakeAndUnlock end"
 
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali
index 99004355..4de6f8fa 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl$21.smali
@@ -32,27 +32,12 @@
 
     invoke-virtual {p0}, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->updateDisplaySize()V
 
-    iget-object p1, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mScreenPinningRequest:Lcom/android/systemui/recents/ScreenPinningRequest;
+    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mScreenPinningRequest:Lcom/android/systemui/recents/ScreenPinningRequest;
 
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    sget-boolean p1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p1, :cond_0
-
-    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/content/res/Resources;->getDisplayMetrics()Landroid/util/DisplayMetrics;
-
-    move-result-object p0
+    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
 
-    invoke-static {p0}, Lcom/android/systemui/util/DeviceState;->setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    :cond_0
     return-void
 .end method
 
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali
index a46bad35..67cf5421 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/CentralSurfacesImpl.smali
@@ -9009,23 +9009,6 @@
     sput v3, Lcom/android/systemui/util/DeviceState;->ROTATION_270:I
 
     :cond_1
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v0, :cond_2
-
-    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/CentralSurfacesImpl;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/content/res/Resources;->getDisplayMetrics()Landroid/util/DisplayMetrics;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/systemui/util/DeviceState;->setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-
-    :cond_2
     invoke-static {}, Landroid/os/Trace;->endSection()V
 
     return-void
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali
index 028aed99..e057d5b3 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaView.smali
@@ -988,8 +988,6 @@
 
     if-nez v5, :cond_8
 
-    sget v5, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
     iput v5, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->upperFPIndicationBottomMargin:I
 
     iget-object v5, p0, Lcom/android/systemui/statusbar/phone/KeyguardSecBottomAreaView;->upperFPIndication$delegate:Lkotlin/Lazy;
@@ -1317,64 +1315,6 @@
     iput v3, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->indicationAreaSideMargin:I
 
     :cond_18
-    sget-boolean v3, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v3, :cond_1a
-
-    const-class v3, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-static {v3}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v3}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_1a
-
-    invoke-virtual {p0}, Landroid/widget/FrameLayout;->getDisplay()Landroid/view/Display;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Landroid/view/Display;->getRotation()I
-
-    move-result v3
-
-    if-eqz v3, :cond_19
-
-    invoke-virtual {p0}, Landroid/widget/FrameLayout;->getDisplay()Landroid/view/Display;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Landroid/view/Display;->getRotation()I
-
-    move-result v3
-
-    if-ne v3, v8, :cond_1a
-
-    :cond_19
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isInDisplayFpSensorPositionHigh()Z
-
-    move-result v3
-
-    if-nez v3, :cond_1a
-
-    sget v3, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    const v5, 0x7f070438
-
-    invoke-virtual {v1, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result v5
-
-    add-int/2addr v5, v3
-
-    iput v5, p1, Lcom/android/systemui/keyguard/ui/binder/KeyguardSecBottomAreaViewBinder$ConfigurationBasedDimensions;->indicationAreaBottomMargin:I
-
-    :cond_1a
     iget-object v3, p0, Lcom/android/systemui/statusbar/phone/KeyguardBottomAreaView;->pluginLockData:Lcom/android/systemui/pluginlock/PluginLockData;
 
     if-eqz v3, :cond_1d
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali
index 6bcb5926..01513c2f 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController.smali
@@ -1291,53 +1291,8 @@
 
     invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
 
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+    sget-object v1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz v1, :cond_8
-
-    invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getContext()Landroid/content/Context;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/content/res/Resources;->getDisplayMetrics()Landroid/util/DisplayMetrics;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/systemui/util/DeviceState;->setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    const-string v3, "finger_print_height"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
-
-    const-string v3, "finger_print_image_size"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintMarginBottom:I
-
-    const-string v3, "finger_print_margin"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
-
-    iget-object v1, p0, Lcom/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController;->keyguardUpdateMonitor:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {v1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isFingerprintOptionEnabled()Z
-
-    move-result v1
-
-    const-string v3, "finger_print_enabled"
-
-    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    :cond_8
     sget-object v1, Lcom/android/systemui/statusbar/phone/KeyguardSecBottomAreaViewController;->KEY_HELP_TEXT_VISIBILITY:Ljava/lang/String;
 
     invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V
@@ -1362,18 +1317,18 @@
 
     move-result-object v1
 
-    if-nez v1, :cond_9
+    if-nez v1, :cond_8
 
     const/4 p0, -0x1
 
     goto :goto_6
 
-    :cond_9
+    :cond_8
     invoke-virtual {p0}, Lcom/android/systemui/util/ViewController;->getResources()Landroid/content/res/Resources;
 
     move-result-object p0
 
-    if-eqz p1, :cond_a
+    if-eqz p1, :cond_9
 
     const p1, 0x7f070421
 
@@ -1383,7 +1338,7 @@
 
     goto :goto_6
 
-    :cond_a
+    :cond_9
     const p1, 0x7f070420
 
     invoke-virtual {p0, p1}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali
index 710db32f..8f052f60 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1.smali
@@ -25,49 +25,11 @@
 
     invoke-static {}, Lcom/android/systemui/util/DeviceType;->isTablet()Z
 
-    move-result p2
+    move-result p0
 
-    if-eqz p2, :cond_0
+    if-eqz p0, :cond_0
 
-    sget-boolean p2, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz p2, :cond_0
-
-    sget-object p2, Landroid/hardware/biometrics/BiometricSourceType;->FINGERPRINT:Landroid/hardware/biometrics/BiometricSourceType;
-
-    invoke-virtual {p1, p2}, Landroid/hardware/biometrics/BiometricSourceType;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    iget-object p0, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager$1;->this$0:Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
-
-    const-class p1, Lcom/android/systemui/keyguard/DisplayLifecycle;
-
-    invoke-static {p1}, Lcom/android/systemui/Dependency;->get(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Lcom/android/systemui/keyguard/DisplayLifecycle;
-
-    const/4 p2, 0x0
-
-    invoke-virtual {p1, p2}, Lcom/android/systemui/keyguard/DisplayLifecycle;->getDisplay(I)Landroid/view/Display;
-
-    move-result-object p1
-
-    invoke-virtual {p1}, Landroid/view/Display;->getRotation()I
-
-    move-result p1
-
-    invoke-static {p1}, Lcom/android/systemui/util/DeviceState;->getRotation(I)I
-
-    move-result p1
-
-    invoke-virtual {p0, p1}, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->updateLockContainerMargin(I)V
+    sget-object p0, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
     :cond_0
     return-void
diff --git a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali
index dfd31e9d..af060720 100644
--- a/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali
+++ b/smali_classes2/com/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager.smali
@@ -2690,7 +2690,7 @@
 
     iget-object v6, p0, Lcom/android/systemui/statusbar/phone/StatusBarKeyguardViewManager;->mContext:Landroid/content/Context;
 
-    if-eqz v0, :cond_7
+    if-eqz v0, :cond_5
 
     invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
@@ -2720,16 +2720,16 @@
 
     invoke-virtual {v0, v7}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v1
+    move-result p1
 
-    iput v1, v6, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
+    iput p1, v6, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
 
     goto :goto_2
 
     :cond_1
     invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
 
-    move-result v7
+    move-result v5
 
     if-eq p1, v2, :cond_3
 
@@ -2752,47 +2752,20 @@
     move-result v3
 
     :goto_1
-    add-int/2addr v7, v3
+    add-int/2addr v5, v3
 
-    iput v7, v6, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
+    iput v5, v6, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
 
     :goto_2
-    sget-boolean v1, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-eqz v1, :cond_6
-
-    const/4 v1, 0x2
-
-    if-ne p1, v1, :cond_6
-
-    iget-object p1, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->mKeyguardUpdateManager:Lcom/android/keyguard/KeyguardUpdateMonitor;
-
-    invoke-interface {p1}, Lcom/android/keyguard/KeyguardSecUpdateMonitor;->isInDisplayFingerprintMarginAccepted()Z
-
-    move-result p1
+    sget-object p1, Lcom/android/systemui/LsRune;->VALUE_CONFIG_CARRIER_TEXT_POLICY:Ljava/lang/String;
 
-    if-eqz p1, :cond_5
-
-    sget p1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    goto :goto_3
-
-    :cond_5
-    invoke-virtual {v0, v5}, Landroid/content/res/Resources;->getDimensionPixelSize(I)I
-
-    move-result p1
-
-    :goto_3
-    iput p1, v6, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
-
-    :cond_6
     iget-object p0, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->mLockIconContainer:Landroid/view/ViewGroup;
 
     invoke-virtual {p0, v6}, Landroid/view/ViewGroup;->setLayoutParams(Landroid/view/ViewGroup$LayoutParams;)V
 
     return-void
 
-    :cond_7
+    :cond_5
     iget-object v0, p0, Lcom/android/systemui/statusbar/phone/SecStatusBarKeyguardViewManager;->mLockIconContainer:Landroid/view/ViewGroup;
 
     invoke-virtual {v0}, Landroid/view/ViewGroup;->getLayoutParams()Landroid/view/ViewGroup$LayoutParams;
@@ -2809,22 +2782,22 @@
 
     move-result v5
 
-    if-eq p1, v2, :cond_9
+    if-eq p1, v2, :cond_7
 
-    if-ne p1, v1, :cond_8
+    if-ne p1, v1, :cond_6
 
-    goto :goto_4
+    goto :goto_3
 
-    :cond_8
+    :cond_6
     move v2, v3
 
-    :cond_9
-    :goto_4
-    if-eqz v2, :cond_a
+    :cond_7
+    :goto_3
+    if-eqz v2, :cond_8
 
-    goto :goto_5
+    goto :goto_4
 
-    :cond_a
+    :cond_8
     invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
     move-result-object p1
@@ -2833,7 +2806,7 @@
 
     move-result v3
 
-    :goto_5
+    :goto_4
     add-int/2addr v5, v3
 
     iput v5, v0, Landroid/widget/FrameLayout$LayoutParams;->topMargin:I
diff --git a/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali b/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali
index b9e617f3..6e781cdf 100644
--- a/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali
+++ b/smali_classes2/com/android/systemui/tv/DaggerTvGlobalRootComponent$CentralSurfacesComponentImpl.smali
@@ -2030,7 +2030,9 @@
 
     invoke-static {p0}, Ldagger/internal/DoubleCheck;->lazy(Ljavax/inject/Provider;)Ldagger/Lazy;
 
-    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;
+    move-result-object p0
+
+    iput-object p0, p1, Lcom/android/systemui/shade/NotificationPanelViewController;->mBioUnlockControllerLazy:Ldagger/Lazy;
 
     return-object p1
 .end method
diff --git a/smali_classes2/com/android/systemui/util/DeviceState.smali b/smali_classes2/com/android/systemui/util/DeviceState.smali
index 862238f6..8d4d7bcb 100644
--- a/smali_classes2/com/android/systemui/util/DeviceState.smali
+++ b/smali_classes2/com/android/systemui/util/DeviceState.smali
@@ -22,26 +22,12 @@
 
 .field public static sDisplaySize:Landroid/graphics/Point; = null
 
-.field public static sInDisplayFingerprintHeight:I = 0x0
-
-.field public static sInDisplayFingerprintImageSize:I = 0x0
-
-.field public static sInDisplayFingerprintMarginBottom:I = 0x0
-
-.field public static sLoadedSensorValue:Z = false
-
 .field public static sOldScreenLayout:I = 0x0
 
 .field public static sOldScreenWidthDp:I = 0x0
 
 .field public static final sPhoneCount:I
 
-.field public static sSemSensorAreaHeight:Ljava/lang/String; = "4"
-
-.field public static sSemSensorImageSize:Ljava/lang/String; = "10.80"
-
-.field public static sSemSensorMarginBottom:Ljava/lang/String; = "13.77"
-
 .field public static final sSizePoint:Landroid/graphics/Point;
 
 
@@ -913,7 +899,7 @@
 .end method
 
 .method public static isInDisplayFpSensorPositionHigh()Z
-    .locals 2
+    .locals 3
 
     const-class v0, Lcom/android/systemui/keyguard/DisplayLifecycle;
 
@@ -937,27 +923,22 @@
 
     int-to-float v0, v0
 
-    sget v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
+    const/4 v1, 0x0
 
-    int-to-float v1, v1
+    int-to-float v2, v1
 
-    div-float/2addr v1, v0
+    div-float/2addr v2, v0
 
     const v0, 0x3e6147ae    # 0.22f
 
-    cmpl-float v0, v1, v0
+    cmpl-float v0, v2, v0
 
     if-lez v0, :cond_0
 
-    const/4 v0, 0x1
-
-    goto :goto_0
+    const/4 v1, 0x1
 
     :cond_0
-    const/4 v0, 0x0
-
-    :goto_0
-    return v0
+    return v1
 .end method
 
 .method public static isMediaQuickControlBarAvailable(Landroid/content/Context;)Z
@@ -1120,166 +1101,13 @@
 .end method
 
 .method public static isSmartViewDisplayWithFitToAspectRatio(Landroid/content/Context;)Z
-    .locals 6
-
-    sget-boolean v0, Lcom/android/systemui/LsRune;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
-
-    if-nez v0, :cond_0
+    .locals 0
 
     invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
 
     move-result p0
 
     return p0
-
-    :cond_0
-    const-string v0, "display"
-
-    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/hardware/display/DisplayManager;
-
-    invoke-virtual {v0}, Landroid/hardware/display/DisplayManager;->semGetWifiDisplayStatus()Landroid/hardware/display/SemWifiDisplayStatus;
-
-    move-result-object v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_1
-
-    invoke-virtual {v0}, Landroid/hardware/display/SemWifiDisplayStatus;->getActiveDisplayState()I
-
-    move-result v0
-
-    const/4 v3, 0x2
-
-    if-ne v0, v3, :cond_1
-
-    move v0, v1
-
-    goto :goto_0
-
-    :cond_1
-    move v0, v2
-
-    :goto_0
-    const-string v3, "media_router"
-
-    invoke-virtual {p0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Landroid/media/MediaRouter;
-
-    const/4 v4, 0x4
-
-    invoke-virtual {v3, v4}, Landroid/media/MediaRouter;->getSelectedRoute(I)Landroid/media/MediaRouter$RouteInfo;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getSupportedTypes()I
-
-    move-result v5
-
-    and-int/2addr v4, v5
-
-    if-eqz v4, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->semGetDeviceAddress()Ljava/lang/String;
-
-    move-result-object v4
-
-    if-nez v4, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->semGetStatusCode()I
-
-    move-result v4
-
-    const/4 v5, 0x6
-
-    if-ne v4, v5, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getPresentationDisplay()Landroid/view/Display;
-
-    move-result-object v4
-
-    if-nez v4, :cond_2
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getDescription()Ljava/lang/CharSequence;
-
-    move-result-object v4
-
-    if-eqz v4, :cond_3
-
-    invoke-virtual {v3}, Landroid/media/MediaRouter$RouteInfo;->getDescription()Ljava/lang/CharSequence;
-
-    move-result-object v3
-
-    invoke-interface {v3}, Ljava/lang/CharSequence;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    const-string v4, "Audio"
-
-    invoke-virtual {v3, v4}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_3
-
-    :cond_2
-    move v3, v1
-
-    goto :goto_1
-
-    :cond_3
-    move v3, v2
-
-    :goto_1
-    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object p0
-
-    const-string v4, "lelink_cast_on"
-
-    invoke-static {p0, v4, v2}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
-
-    move-result p0
-
-    if-ne p0, v1, :cond_4
-
-    move p0, v1
-
-    goto :goto_2
-
-    :cond_4
-    move p0, v2
-
-    :goto_2
-    if-nez v0, :cond_5
-
-    if-nez v3, :cond_5
-
-    if-eqz p0, :cond_6
-
-    :cond_5
-    invoke-static {}, Lcom/android/systemui/util/DeviceState;->isSmartViewFitToActiveDisplay()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_6
-
-    goto :goto_3
-
-    :cond_6
-    move v1, v2
-
-    :goto_3
-    return v1
 .end method
 
 .method public static isSmartViewFitToActiveDisplay()Z
@@ -1424,236 +1252,6 @@
     return p0
 .end method
 
-.method public static setInDisplayFingerprintSensorPosition(Landroid/util/DisplayMetrics;)V
-    .locals 7
-
-    const-string/jumbo v0, "readFingerprintSensor : failed to close file"
-
-    sget-boolean v1, Lcom/android/systemui/util/DeviceState;->sLoadedSensorValue:Z
-
-    if-nez v1, :cond_3
-
-    new-instance v1, Ljava/io/File;
-
-    const-string v2, "/sys/class/fingerprint/fingerprint/position"
-
-    invoke-direct {v1, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v1}, Ljava/io/File;->exists()Z
-
-    move-result v2
-
-    const-string v3, "DeviceState"
-
-    if-eqz v2, :cond_2
-
-    const/4 v2, 0x0
-
-    :try_start_0
-    new-instance v4, Ljava/io/FileInputStream;
-
-    invoke-direct {v4, v1}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    :try_start_1
-    invoke-virtual {v1}, Ljava/io/File;->length()J
-
-    move-result-wide v5
-
-    long-to-int v1, v5
-
-    new-array v1, v1, [B
-
-    invoke-virtual {v4, v1}, Ljava/io/FileInputStream;->read([B)I
-
-    move-result v5
-
-    if-lez v5, :cond_0
-
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    new-instance v4, Ljava/lang/String;
-
-    sget-object v5, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;
-
-    invoke-direct {v4, v1, v5}, Ljava/lang/String;-><init>([BLjava/nio/charset/Charset;)V
-
-    const-string v1, ","
-
-    invoke-virtual {v4, v1}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v4, 0x0
-
-    aget-object v4, v1, v4
-
-    sput-object v4, Lcom/android/systemui/util/DeviceState;->sSemSensorMarginBottom:Ljava/lang/String;
-
-    const/4 v4, 0x3
-
-    aget-object v4, v1, v4
-
-    sput-object v4, Lcom/android/systemui/util/DeviceState;->sSemSensorAreaHeight:Ljava/lang/String;
-
-    const/4 v4, 0x7
-
-    aget-object v1, v1, v4
-
-    sput-object v1, Lcom/android/systemui/util/DeviceState;->sSemSensorImageSize:Ljava/lang/String;
-
-    const/4 v1, 0x1
-
-    sput-boolean v1, Lcom/android/systemui/util/DeviceState;->sLoadedSensorValue:Z
-    :try_end_2
-    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_0
-
-    :cond_0
-    move-object v2, v4
-
-    :goto_0
-    if-eqz v2, :cond_3
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_4
-
-    :catch_0
-    move-exception v1
-
-    move-object v2, v4
-
-    goto :goto_1
-
-    :catchall_1
-    move-exception p0
-
-    goto :goto_3
-
-    :catch_1
-    move-exception v1
-
-    :goto_1
-    :try_start_3
-    const-string/jumbo v4, "readFingerprintSensor : failure to read sensor info : "
-
-    invoke-static {v3, v4, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    if-eqz v2, :cond_3
-
-    :goto_2
-    :try_start_4
-    invoke-virtual {v2}, Ljava/io/FileInputStream;->close()V
-    :try_end_4
-    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_2
-
-    goto :goto_6
-
-    :catch_2
-    move-exception v1
-
-    invoke-static {v3, v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    goto :goto_6
-
-    :goto_3
-    move-object v4, v2
-
-    :goto_4
-    if-eqz v4, :cond_1
-
-    :try_start_5
-    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
-    :try_end_5
-    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_3
-
-    goto :goto_5
-
-    :catch_3
-    move-exception v1
-
-    invoke-static {v3, v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
-
-    :cond_1
-    :goto_5
-    throw p0
-
-    :cond_2
-    const-string/jumbo v0, "readFingerprintSensor : No file for sensor pos"
-
-    invoke-static {v3, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_3
-    :goto_6
-    sget-object v0, Lcom/android/systemui/util/DeviceState;->sSemSensorImageSize:Ljava/lang/String;
-
-    invoke-static {v0}, Ljava/lang/Float;->parseFloat(Ljava/lang/String;)F
-
-    move-result v0
-
-    const/4 v1, 0x5
-
-    invoke-static {v1, v0, p0}, Landroid/util/TypedValue;->applyDimension(IFLandroid/util/DisplayMetrics;)F
-
-    move-result v0
-
-    sget-object v2, Lcom/android/systemui/util/DeviceState;->sSemSensorMarginBottom:Ljava/lang/String;
-
-    invoke-static {v2}, Ljava/lang/Float;->parseFloat(Ljava/lang/String;)F
-
-    move-result v2
-
-    invoke-static {v1, v2, p0}, Landroid/util/TypedValue;->applyDimension(IFLandroid/util/DisplayMetrics;)F
-
-    move-result v2
-
-    sget-object v3, Lcom/android/systemui/util/DeviceState;->sSemSensorAreaHeight:Ljava/lang/String;
-
-    invoke-static {v3}, Ljava/lang/Float;->parseFloat(Ljava/lang/String;)F
-
-    move-result v3
-
-    invoke-static {v1, v3, p0}, Landroid/util/TypedValue;->applyDimension(IFLandroid/util/DisplayMetrics;)F
-
-    move-result p0
-
-    float-to-int v1, v2
-
-    float-to-int p0, p0
-
-    div-int/lit8 p0, p0, 0x2
-
-    add-int/2addr p0, v1
-
-    float-to-int v0, v0
-
-    div-int/lit8 v2, v0, 0x2
-
-    add-int/2addr v2, p0
-
-    sput v2, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintHeight:I
-
-    sput v0, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintImageSize:I
-
-    sput v1, Lcom/android/systemui/util/DeviceState;->sInDisplayFingerprintMarginBottom:I
-
-    return-void
-.end method
-
 .method public static shouldEnableKeyguardScreenRotation(Landroid/content/Context;)Z
     .locals 5
 
diff --git a/smali_classes2/com/android/systemui/util/DeviceType.smali b/smali_classes2/com/android/systemui/util/DeviceType.smali
index 5de81352..02d9a33a 100644
--- a/smali_classes2/com/android/systemui/util/DeviceType.smali
+++ b/smali_classes2/com/android/systemui/util/DeviceType.smali
@@ -38,6 +38,8 @@
 
 .field public static supportSideFingerprint:I = -0x1
 
+.field public static supportSideFingerprintExclusive:I = -0x1
+
 .field public static supportTablet:I = -0x1
 
 .field public static supportVibrator:I = -0x1
-- 
2.43.0

